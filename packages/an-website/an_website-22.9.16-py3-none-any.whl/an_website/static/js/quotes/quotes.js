"use strict";// @license magnet:?xt=urn:btih:0b31508aeb0634b347b8270c7bee4d411b5d4109&dn=agpl-3.0.txt GNU-AGPL-3.0-or-later
function startQuotes(){const i=elById("next"),r=elById("upvote"),a=elById("downvote"),h=elById("report"),m=[elById("top").getAttribute("quote-id")],d=[i.getAttribute("quote-id")],o=window.location.search,s=(()=>{const e=new URLSearchParams(o).get("keys");return e&&e.length?e.length===4?e.toUpperCase():(alert("Invalid keys given, using default."),"WASD"):"WASD"})();elById("wasd").innerText=`${s[0]} (Witzig), ${s[2]} (Nicht Witzig), ${s[1]} (Vorheriges) und ${s[3]} (Nächstes)`,document.onkeydown=e=>{switch(e.code){case`Key${s[0]}`:r.click();break;case`Key${s[1]}`:window.history.back();break;case`Key${s[2]}`:a.click();break;case`Key${s[3]}`:i.click()}};const p=elById("share"),y=elById("download"),f=elById("author"),u=elById("quote"),l=elById("real-author-name"),T=elById("rating-text"),g=elById("rating-img-container");i.removeAttribute("href");function B(e){p.href=`/zitate/share/${e}${o}`,y.href=`/zitate/${e}.gif${o}`;const[t,n]=e.split("-",2);u.href=`/zitate/info/z/${t}${o}`,f.href=`/zitate/info/a/${n}${o}`,m[0]=e}function v(e){if(e=e.toString(),T.innerText=e,["---","???","0"].includes(e)){g.innerHTML="";return}const t=Number.parseInt(e),n=document.createElement("div");n.className="rating-img"+(t>0?" witzig":" nicht-witzig"),g.innerHTML=(n.outerHTML+" ").repeat(Math.min(4,Math.abs(t))).trim()}function L(e){function t(n,b,$){n.disabled=!1,e===b?(n.setAttribute("voted",$),n.value="0"):(n.removeAttribute("voted"),n.value=$)}t(r,1,"1"),t(a,-1,"-1")}function c(e){if(e.status)console.error(e),e.status in[429,420]&&alert(e.reason);else if(e&&e.id){if(B(e.id),d[0]=e.next,u.innerText=`»${e.quote}«`,f.innerText=`- ${e.author}`,l.innerText=e.real_author,l.href=`/zitate/info/a/${e.real_author_id}${o}`,h){const t=new URLSearchParams(o);t.set("subject",`Das falsche Zitat ${e.id} hat ein Problem`),t.set("message",`${u.innerText} ${l.innerText}`),h.href=`/kontakt?${t}`}return v(e.rating),L(Number.parseInt(e.vote)),!0}}PopStateHandlers.quotes=e=>e.state&&c(e.state),i.onclick=()=>get(`/api/zitate/${d[0]}`,o,e=>{!c(e)||(e.stateType="quotes",e.url=`/zitate/${e.id}${o}`,window.history.pushState(e,"Falsche Zitate",e.url),setLastLocation(e.url))});const I=e=>post(`/api/zitate/${m[0]}`,{vote:e},t=>c(t));for(const e of[r,a])e.type="button",e.onclick=()=>{r.disabled=!0,a.disabled=!0,I(e.value),r.disabled=!1,a.disabled=!1}}for(const i of document.getElementsByClassName("auto-submit-element"))i.onchange=()=>i.form.submit();startQuotes();// @license-end
//# sourceMappingURL=quotes.js.map
