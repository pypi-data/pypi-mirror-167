"use strict";(self.webpackChunkjupyterlabs_sql_codemirror=self.webpackChunkjupyterlabs_sql_codemirror||[]).push([[568],{568:(t,e,r)=>{r.r(e),r.d(e,{default:()=>a});var i=r(253),o=r(931),s=r(854),c=r(87),l=r(588),d=r(471);class n{constructor(t,e,r,i,o,s){this.app=t,this.tracker=e,this.editor_tracker=r,this.setting_registry=i,this.code_mirror=o,this.palette=s,this.ignored_tokens=new Set,this.tracker.activeCellChanged.connect((()=>{this.tracker.activeCell&&this.setup_cell_editor(this.tracker.activeCell)})),this.editor_tracker.widgetAdded.connect(((t,e)=>this.setup_file_editor(e.content,!0))),this.editor_tracker.currentChanged.connect(((t,e)=>{null!==e&&this.setup_file_editor(e.content,!1)}))}refresh_state(){null!==this.tracker.activeCell&&this.setup_cell_editor(this.tracker.activeCell),null!==this.editor_tracker.currentWidget&&this.setup_file_editor(this.editor_tracker.currentWidget.content)}setup_file_editor(t,e=!1){e&&t.model.mimeTypeChanged.connect(((e,r)=>{setTimeout((()=>this.setup_file_editor(t)),0)}))}setup_cell_editor(t){if(null!==t&&"code"===t.model.type){const e=t.editor,r=d.debounce((()=>{var t;const r=null===(t=e.getLine(e.firstLine()))||void 0===t?void 0:t.trim();(null==r?void 0:r.startsWith("%%sql"))?e.editor.setOption("mode","text/x-sql"):e.editor.setOption("mode","text/x-ipython")}),300);e.editor.on("change",r),r()}}extract_editor(t){return t.editor.editor}}const a={id:"@composable/jupyterlabs-sql-codemirror",autoStart:!0,requires:[o.INotebookTracker,i.IEditorTracker,c.ISettingRegistry,l.ICodeMirror],optional:[s.ICommandPalette],activate:function(t,e,r,i,o,s){new n(t,e,r,i,o,s),console.log("SQLCodeMirror loaded.")}}}}]);