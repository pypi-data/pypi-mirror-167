"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_gridEditable_sortLink_tsx-app_views_eventsV2_table_cellAction_tsx"],{"./app/components/gridEditable/sortLink.tsx":(e,t,n)=>{n.d(t,{Z:()=>p});var o=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=(n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/react-router/es/index.js")),s=n("../node_modules/lodash/omit.js"),i=n.n(s),l=n("./app/components/links/link.tsx"),a=n("./app/icons/index.tsx"),d=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function c(e){let{align:t,title:n,canSort:o,generateSortLink:s,onClick:i,direction:l,replace:a}=e;const c=s();if(!c||!o)return(0,d.tZ)(h,{align:t,children:n});const p=l?(0,d.tZ)(m,{size:"xs",direction:"desc"===l?"down":"up"}):null;return(0,d.BX)(u,{align:t,to:c,onClick:e=>{a&&(e.preventDefault(),r.browserHistory.replace(c)),null==i||i(e)},children:[n," ",p]})}c.displayName="SortLink";const u=(0,o.Z)((e=>{const t=i()(e,["align","css"]);return(0,d.tZ)(l.Z,{...t})}),{target:"e1xb2te62"})("display:block;width:100%;white-space:nowrap;color:inherit;&:hover,&:active,&:focus,&:visited{color:inherit;}",(e=>e.align?`text-align: ${e.align};`:""),";"),h=(0,o.Z)("div",{target:"e1xb2te61"})("display:block;width:100%;white-space:nowrap;",(e=>e.align?`text-align: ${e.align};`:""),";"),m=(0,o.Z)(a.CC,{target:"e1xb2te60"})({name:"40f4ru",styles:"vertical-align:top"}),p=c},"./app/views/eventsV2/table/cellAction.tsx":(e,t,n)=>{n.d(t,{ZP:()=>v,eX:()=>x,rh:()=>_});var o=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),s=(n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.error.cause.js"),n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/react/index.js")),i=n("../node_modules/react-dom/profiling.js"),l=n("../node_modules/react-popper/lib/esm/Popper.js"),a=n("../node_modules/react-popper/lib/esm/Manager.js"),d=n("../node_modules/react-popper/lib/esm/Reference.js"),c=n("../node_modules/color/index.js"),u=n.n(c),h=n("./app/icons/index.tsx"),m=n("./app/locale.tsx"),p=n("./app/styles/space.tsx"),g=n("./app/utils.tsx"),b=n("./app/utils/discover/fields.tsx"),f=n("./app/utils/formatters.tsx"),E=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");let x;function _(e,t,n,o){const r=n.name;switch("duration"===n.type&&"number"==typeof o&&(o=(0,f.g9)(o/1e3,2,!0)),Array.isArray(o)&&1===(o=[...new Set(o)]).length&&(o=o[0]),t){case x.ADD:if(null==o)e.removeFilterValue("has",r),e.addFilterValues("!has",[r]);else{if(e.removeFilter(`!${r}`),Array.isArray(o)){const t=e.getFilterValues(r);o=[...new Set([...t,...o])]}else o=[String(o)];e.setFilterValues(r,o)}break;case x.EXCLUDE:if(null==o)e.removeFilterValue("!has",r),e.addFilterValues("has",[r]);else{e.removeFilter(r);const t=`!${r}`;o=Array.isArray(o)?o:[String(o)];const n=e.getFilterValues(t);o=[...new Set([...n,...o])],e.setFilterValues(t,o)}break;case x.SHOW_GREATER_THAN:e.setFilterValues(r,[`>${o}`]);break;case x.SHOW_LESS_THAN:e.setFilterValues(r,[`<${o}`]);break;case x.TRANSACTION:case x.RELEASE:case x.DRILLDOWN:break;default:throw new Error(`Unknown action type. ${t}`)}}!function(e){e.ADD="add",e.EXCLUDE="exclude",e.SHOW_GREATER_THAN="show_greater_than",e.SHOW_LESS_THAN="show_less_than",e.TRANSACTION="transaction",e.RELEASE="release",e.DRILLDOWN="drilldown",e.EDIT_THRESHOLD="edit_threshold"}(x||(x={}));class k extends s.Component{constructor(e){super(e),(0,o.Z)(this,"state",{isHovering:!1,isOpen:!1}),(0,o.Z)(this,"portalEl",void 0),(0,o.Z)(this,"menuEl",void 0),(0,o.Z)(this,"handleClickOutside",(e=>{this.menuEl&&e.target instanceof Element&&(this.menuEl.contains(e.target)||this.setState({isOpen:!1,isHovering:!1}))})),(0,o.Z)(this,"handleMouseEnter",(()=>{this.setState({isHovering:!0})})),(0,o.Z)(this,"handleMouseLeave",(()=>{this.setState((e=>e.isOpen?e:{...e,isHovering:!1}))})),(0,o.Z)(this,"handleMenuToggle",(e=>{e.preventDefault(),this.setState({isOpen:!this.state.isOpen})}));let t=document.getElementById("cell-action-portal");t||(t=document.createElement("div"),t.setAttribute("id","cell-action-portal"),document.body.appendChild(t)),this.portalEl=t,this.menuEl=null}componentDidUpdate(e,t){this.state.isOpen&&!1===t.isOpen&&document.addEventListener("click",this.handleClickOutside,!0),!1===this.state.isOpen&&t.isOpen&&document.removeEventListener("click",this.handleClickOutside,!0)}componentWillUnmount(){document.removeEventListener("click",this.handleClickOutside,!0)}renderMenu(){const{isOpen:e}=this.state,t=function(e){let{dataRow:t,column:n,handleCellAction:o,allowActions:r}=e;if((0,b.sU)(n.name))return null;if((0,b.uI)(n.name))return null;let s=t[n.name];Array.isArray(s)&&null===s[0]&&"field"===n.column.kind&&"error.handled"===n.column.field&&(s=1);const i=[];function l(e,t){(Array.isArray(r)&&r.includes(e)||!r)&&i.push(t)}return(!["duration","number","percentage"].includes(n.type)||null===s&&"field"===n.column.kind)&&(l(x.ADD,(0,E.tZ)(L,{"data-test-id":"add-to-filter",onClick:()=>o(x.ADD,s),children:(0,m.t)("Add to filter")},"add-to-filter")),"date"!==n.type&&l(x.EXCLUDE,(0,E.tZ)(L,{"data-test-id":"exclude-from-filter",onClick:()=>o(x.EXCLUDE,s),children:(0,m.t)("Exclude from filter")},"exclude-from-filter"))),["date","duration","integer","number","percentage"].includes(n.type)&&null!==s&&(l(x.SHOW_GREATER_THAN,(0,E.tZ)(L,{"data-test-id":"show-values-greater-than",onClick:()=>o(x.SHOW_GREATER_THAN,s),children:(0,m.t)("Show values greater than")},"show-values-greater-than")),l(x.SHOW_LESS_THAN,(0,E.tZ)(L,{"data-test-id":"show-values-less-than",onClick:()=>o(x.SHOW_LESS_THAN,s),children:(0,m.t)("Show values less than")},"show-values-less-than"))),"field"===n.column.kind&&"transaction"===n.column.field&&l(x.TRANSACTION,(0,E.tZ)(L,{"data-test-id":"transaction-summary",onClick:()=>o(x.TRANSACTION,s),children:(0,m.t)("Go to summary")},"transaction-summary")),"field"===n.column.kind&&"release"===n.column.field&&s&&l(x.RELEASE,(0,E.tZ)(L,{"data-test-id":"release",onClick:()=>o(x.RELEASE,s),children:(0,m.t)("Go to release")},"release")),"function"===n.column.kind&&"count_unique"===n.column.function[0]&&l(x.DRILLDOWN,(0,E.tZ)(L,{"data-test-id":"per-cell-drilldown",onClick:()=>o(x.DRILLDOWN,s),children:(0,m.t)("View Stacks")},"drilldown")),"function"===n.column.kind&&"user_misery"===n.column.function[0]&&(0,g.ri)(t.project_threshold_config)&&l(x.EDIT_THRESHOLD,(0,E.tZ)(L,{"data-test-id":"edit-threshold",onClick:()=>o(x.EDIT_THRESHOLD,s),children:(0,m._N)("Edit threshold ([threshold]ms)",{threshold:t.project_threshold_config[1]})},"edit_threshold")),0===i.length?null:i}(this.props);if(null===t)return null;const n=[{name:"hide",enabled:!1},{name:"preventOverflow",enabled:!0,options:{padding:10,altAxis:!0}},{name:"offset",options:{offset:[0,Z/2]}},{name:"computeStyles",options:{gpuAcceleration:!1}}],o=e?(0,i.createPortal)((0,E.tZ)(l.r,{placement:"top",modifiers:n,children:e=>{let{ref:n,style:o,placement:r,arrowProps:s}=e;return(0,E.BX)(A,{ref:e=>{n(e),this.menuEl=e},style:o,children:[(0,E.tZ)(O,{ref:s.ref,"data-placement":r,style:s.style}),(0,E.tZ)(S,{onClick:e=>e.stopPropagation(),children:t})]})}}),this.portalEl):null;return(0,E.tZ)(w,{children:(0,E.BX)(a.dK,{children:[(0,E.tZ)(d.s,{children:e=>{let{ref:t}=e;return(0,E.tZ)(C,{ref:t,onClick:this.handleMenuToggle,children:(0,E.tZ)(h.YR,{size:"sm","data-test-id":"cell-action",color:"blue300"})})}}),o]})})}render(){const{children:e}=this.props,{isHovering:t}=this.state;return(0,E.BX)(y,{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[e,t&&this.renderMenu()]})}}k.displayName="CellAction";const v=k,y=(0,r.Z)("div",{target:"e18g1e9m6"})({name:"nwytwd",styles:"position:relative;width:100%;height:100%;display:flex;flex-direction:column;justify-content:center"}),w=(0,r.Z)("div",{target:"e18g1e9m5"})({name:"1lby940",styles:"position:absolute;top:0;right:0"}),A=(0,r.Z)("div",{target:"e18g1e9m4"})("z-index:",(e=>e.theme.zIndex.tooltip),";"),S=(0,r.Z)("div",{target:"e18g1e9m3"})("background:",(e=>e.theme.background),";border:1px solid ",(e=>e.theme.border),";border-radius:",(e=>e.theme.borderRadius),";box-shadow:",(e=>e.theme.dropShadowHeavy),";overflow:hidden;"),Z=12,O=(0,r.Z)("span",{target:"e18g1e9m2"})("pointer-events:none;position:absolute;width:",Z,"px;height:",Z,"px;&::before,&::after{content:'';display:block;position:absolute;height:",Z,"px;width:",Z,"px;border:solid 6px transparent;}&[data-placement|='bottom']{top:-",Z,"px;&::before{bottom:1px;border-bottom-color:",(e=>e.theme.translucentBorder),";}&::after{border-bottom-color:",(e=>e.theme.backgroundElevated),";}}&[data-placement|='top']{bottom:-",Z,"px;&::before{top:1px;border-top-color:",(e=>e.theme.translucentBorder),";}&::after{border-top-color:",(e=>e.theme.backgroundElevated),";}}&[data-placement|='right']{left:-",Z,"px;&::before{right:1px;border-right-color:",(e=>e.theme.translucentBorder),";}&::after{border-right-color:",(e=>e.theme.backgroundElevated),";}}&[data-placement|='left']{right:-",Z,"px;&::before{left:1px;border-left-color:",(e=>e.theme.translucentBorder),";}&::after{border-left-color:",(e=>e.theme.backgroundElevated),";}}"),L=(0,r.Z)("button",{target:"e18g1e9m1"})("display:block;width:100%;padding:",(0,p.Z)(1)," ",(0,p.Z)(2),";background:transparent;outline:none;border:0;border-bottom:1px solid ",(e=>e.theme.innerBorder),";font-size:",(e=>e.theme.fontSizeMedium),";text-align:left;line-height:1.2;&:hover{background:",(e=>e.theme.backgroundSecondary),";}&:last-child{border-bottom:0;}"),C=(0,r.Z)("button",{target:"e18g1e9m0"})("display:flex;width:24px;height:24px;padding:0;justify-content:center;align-items:center;background:",(e=>u()(e.theme.background).alpha(.85).string()),";border-radius:",(e=>e.theme.borderRadius),";border:1px solid ",(e=>e.theme.border),";cursor:pointer;outline:none;")}}]);
//# sourceMappingURL=../sourcemaps/app_components_gridEditable_sortLink_tsx-app_views_eventsV2_table_cellAction_tsx.d310d89c9272fcb583a0b5430eaa43f7.js.map