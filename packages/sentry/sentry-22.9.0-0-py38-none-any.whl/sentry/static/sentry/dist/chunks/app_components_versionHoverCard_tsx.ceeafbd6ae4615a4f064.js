"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_versionHoverCard_tsx"],{"./app/actionCreators/release.tsx":(e,t,s)=>{s.d(t,{VE:()=>p,aQ:()=>c,dF:()=>d,o7:()=>l});var o=s("../node_modules/@sentry/hub/esm/exports.js"),r=s("./app/actionCreators/indicator.tsx"),i=s("./app/locale.tsx"),a=s("./app/stores/releaseStore.tsx"),n=s("./app/types/index.tsx");function l(e,t){const{orgSlug:s,projectSlug:r,releaseVersion:i}=t,n=`/projects/${s}/${r}/releases/${encodeURIComponent(i)}/`;return a.Z.state.releaseLoading[(0,a.p)(r,i)]=!0,a.Z.loadRelease(s,r,i),e.requestPromise(n,{method:"GET"}).then((e=>{a.Z.loadReleaseSuccess(r,i,e)})).catch((e=>{404!==e.status?(a.Z.loadReleaseError(r,i,e),o.$e((t=>{t.setLevel("warning"),t.setFingerprint(["getRelease-action-creator"]),o.Tb(e)}))):a.Z.loadReleaseSuccess(r,i,null)}))}function d(e,t){const{orgSlug:s,projectSlug:r,releaseVersion:i}=t,n=`/organizations/${s}/releases/${encodeURIComponent(i)}/deploys/`;return a.Z.state.deploysLoading[(0,a.p)(r,i)]=!0,a.Z.loadDeploys(s,r,i),e.requestPromise(n,{method:"GET"}).then((e=>{a.Z.loadDeploysSuccess(r,i,e)})).catch((e=>{404!==e.status?(a.Z.loadDeploysError(r,i,e),o.$e((t=>{t.setLevel("warning"),t.setFingerprint(["getReleaseDeploys-action-creator"]),o.Tb(e)}))):a.Z.loadDeploysSuccess(r,i,null)}))}function p(e,t){const{orgSlug:s,projectSlug:o,releaseVersion:l}=t;return a.Z.loadRelease(s,o,l),(0,r.E3)((0,i.t)("Archiving Release…")),e.requestPromise(`/organizations/${s}/releases/`,{method:"POST",data:{status:n.dE.Archived,projects:[],version:l}}).then((e=>{a.Z.loadReleaseSuccess(o,l,e),(0,r.S9)((0,i.t)("Release was successfully archived."))})).catch((e=>{var t,s;throw a.Z.loadReleaseError(o,l,e),(0,r.Iw)(null!==(t=null===(s=e.responseJSON)||void 0===s?void 0:s.detail)&&void 0!==t?t:(0,i.t)("Release could not be be archived.")),e}))}function c(e,t){const{orgSlug:s,projectSlug:o,releaseVersion:l}=t;return a.Z.loadRelease(s,o,l),(0,r.E3)((0,i.t)("Restoring Release…")),e.requestPromise(`/organizations/${s}/releases/`,{method:"POST",data:{status:n.dE.Active,projects:[],version:l}}).then((e=>{a.Z.loadReleaseSuccess(o,l,e),(0,r.S9)((0,i.t)("Release was successfully restored."))})).catch((e=>{var t,s;throw a.Z.loadReleaseError(o,l,e),(0,r.Iw)(null!==(t=null===(s=e.responseJSON)||void 0===s?void 0:s.detail)&&void 0!==t?t:(0,i.t)("Release could not be be restored.")),e}))}},"./app/components/avatar/avatarList.tsx":(e,t,s)=>{s.d(t,{Z:()=>d});var o=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=s("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),i=s("./app/components/avatar/userAvatar.tsx"),a=s("./app/components/tooltip.tsx"),n=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function l(e){let{avatarSize:t=28,maxVisibleAvatars:s=5,typeMembers:o="users",tooltipOptions:r={},className:i,users:l,renderTooltip:d}=e;const c=l.slice(0,s),m=l.length-c.length;return r.position||(r.position="top"),(0,n.BX)(p,{className:i,children:[!!m&&(0,n.tZ)(a.Z,{title:`${m} other ${o}`,children:(0,n.BX)(g,{size:t,"data-test-id":"avatarList-collapsedusers",children:[m<99&&(0,n.tZ)(u,{children:"+"}),m]})}),c.map((e=>(0,n.tZ)(h,{user:e,size:t,renderTooltip:d,tooltipOptions:r,hasTooltip:!0},`${e.id}-${e.email}`)))]})}l.displayName="AvatarList";const d=l,p=(0,o.Z)("div",{target:"e7y2scs3"})({name:"4hray5",styles:"display:flex;flex-direction:row-reverse"}),c=e=>(0,r.iv)("border-radius:50%;border:2px solid ",e.theme.background,";margin-left:-8px;cursor:default;&:hover{z-index:1;}",""),h=(0,o.Z)(i.Z,{target:"e7y2scs2"})("overflow:hidden;",c,";"),g=(0,o.Z)("div",{target:"e7y2scs1"})("display:flex;align-items:center;justify-content:center;position:relative;text-align:center;font-weight:600;background-color:",(e=>e.theme.gray200),";color:",(e=>e.theme.gray300),";font-size:",(e=>Math.floor(e.size/2.3)),"px;width:",(e=>e.size),"px;height:",(e=>e.size),"px;",c,";"),u=(0,o.Z)("span",{target:"e7y2scs0"})({name:"1enq4bv",styles:"font-size:10px;margin-left:1px;margin-right:-1px"})},"./app/components/versionHoverCard.tsx":(e,t,s)=>{s.d(t,{Z:()=>B});var o=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),a=s("./app/components/avatar/avatarList.tsx"),n=s("./app/components/button.tsx"),l=s("./app/components/clipboard.tsx"),d=s("./app/components/hovercard.tsx"),p=s("./app/components/avatar/userAvatar.tsx"),c=s("./app/components/timeSince.tsx"),h=s("./app/locale.tsx"),g=s("./app/styles/space.tsx"),u=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const m={id:"",name:"",username:"??",email:"",avatarUrl:"",avatar:{avatarUuid:"",avatarType:"letter_avatar"},ip_address:""};function v(e){let{commit:t,className:s}=e;const o=null==t?void 0:t.author;return(0,u.BX)("div",{className:s,children:[(0,u.tZ)("h6",{children:"Last commit"}),(0,u.BX)(Z,{children:[(0,u.tZ)(p.Z,{user:o||m}),(0,u.BX)("div",{children:[(0,u.tZ)(x,{children:function(e){if(!e)return(0,h.t)("No message provided");const t=e.split(/\n/)[0];if(t.length>100){let e=t.substr(0,90);const s=e.split(/ /);return s.length>1&&(s.pop(),e=s.join(" ")),`${e}…`}return t}(t.message)}),(0,u.BX)(b,{children:[(0,u.tZ)("strong",{children:(null==o?void 0:o.name)||(0,h.t)("Unknown Author")})," ",(0,u.tZ)(c.Z,{date:t.dateCreated})]})]})]})]})}v.displayName="LastCommit";const y=v,Z=(0,r.Z)("div",{target:"e1dtiphv2"})("display:grid;grid-template-columns:max-content minmax(0, 1fr);gap:",(0,g.Z)(1),";margin-top:",(0,g.Z)(1),";"),x=(0,r.Z)("div",{target:"e1dtiphv1"})((e=>e.theme.overflowEllipsis)," margin-bottom:",(0,g.Z)(.5),";"),b=(0,r.Z)("div",{target:"e1dtiphv0"})("font-size:",(e=>e.theme.fontSizeSmall),";color:",(e=>e.theme.subText),";");var S=s("./app/components/loadingError.tsx"),f=s("./app/components/loadingIndicator.tsx");const j=(0,r.Z)("span",{target:"eut5h770"})("font-weight:700;color:",(e=>e.theme.white),";text-align:center;white-space:nowrap;border-radius:0.25em;",(e=>e.theme.overflowEllipsis),";display:inline-block;vertical-align:text-bottom;line-height:1;background:",(e=>e.theme.gray200),";padding:3px;max-width:86px;font-size:",(e=>e.theme.fontSizeSmall),";");var w=s("./app/components/version.tsx"),E=s("./app/icons/index.tsx"),L=s("./app/utils.tsx"),R=s("./app/utils/withApi.tsx"),z=s("./app/actionCreators/release.tsx"),C=s("./app/stores/releaseStore.tsx"),$=s("./app/utils/getDisplayName.tsx");var _=s("./app/utils/withRepositories.tsx");class N extends i.Component{constructor(){super(...arguments),(0,o.Z)(this,"state",{visible:!1})}toggleHovercard(){this.setState({visible:!0})}getRepoLink(){const{organization:e}=this.props,t=e.slug;return{header:null,body:(0,u.BX)(M,{children:[(0,u.tZ)("h5",{children:(0,h.t)("Releases are better with commit data!")}),(0,u.tZ)("p",{children:(0,h.t)("Connect a repository to see commit info, files changed, and authors involved in future releases.")}),(0,u.tZ)(n.ZP,{href:`/organizations/${t}/repos/`,priority:"primary",children:(0,h.t)("Connect a repository")})]})}}getBody(){const{releaseVersion:e,release:t,deploys:s}=this.props;if(void 0===t||!(0,L.ri)(s))return{header:null,body:null};const{lastCommit:o}=t,r=s.reduce((function(e,t){const{dateFinished:s,environment:o}=t;return e.hasOwnProperty(o)||(e[o]=s),e}),{});let i=Object.keys(r);return Object.keys(r).length>3&&(i=Object.keys(r).slice(0,3)),{header:(0,u.BX)(k,{children:[(0,h.t)("Release"),(0,u.BX)(D,{children:[(0,u.tZ)(V,{version:e,truncate:!0,anchor:!1}),(0,u.tZ)(l.Z,{value:e,children:(0,u.tZ)(O,{children:(0,u.tZ)(E.vU,{size:"xs"})})})]})]}),body:(0,u.BX)("div",{children:[(0,u.BX)("div",{className:"row",children:[(0,u.BX)("div",{className:"col-xs-4",children:[(0,u.tZ)("h6",{children:(0,h.t)("New Issues")}),(0,u.tZ)(U,{children:t.newGroups})]}),(0,u.BX)("div",{className:"col-xs-8",children:[(0,u.BX)("h6",{style:{textAlign:"right"},children:[t.commitCount," ",1!==t.commitCount?(0,h.t)("commits "):(0,h.t)("commit ")," ",(0,h.t)("by ")," ",t.authors.length," ",1!==t.authors.length?(0,h.t)("authors"):(0,h.t)("author")," "]}),(0,u.tZ)(a.Z,{users:t.authors,avatarSize:25,tooltipOptions:{container:"body"},typeMembers:"authors"})]})]}),o&&(0,u.tZ)(A,{commit:o}),s.length>0&&(0,u.BX)("div",{children:[(0,u.tZ)(d.iz,{children:(0,u.tZ)("h6",{children:(0,h.t)("Deploys")})}),i.map(((e,t)=>{const s=r[e];return(0,u.BX)(P,{children:[(0,u.tZ)(T,{children:e}),s&&(0,u.tZ)(X,{date:s})]},t)}))]})]})}}render(){var e;const{deploysLoading:t,deploysError:s,release:o,releaseLoading:r,releaseError:i,repositories:a,repositoriesLoading:n,repositoriesError:l}=this.props;let p=null,c=null;const h=!!(t||r||n),g=null!==(e=null!=s?s:i)&&void 0!==e?e:l,m=a&&a.length>0;if(h)c=(0,u.tZ)(f.Z,{mini:!0});else if(g)c=(0,u.tZ)(S.Z,{});else{const e=m&&o?this.getBody():this.getRepoLink();p=e.header,c=e.body}return(0,u.tZ)(d.uI,{...this.props,header:p,body:c,children:this.props.children})}}N.displayName="VersionHoverCard";const B=(0,R.Z)(function(e){class t extends i.Component{constructor(e,t){super(e,t),(0,o.Z)(this,"unsubscribe",C.Z.listen((()=>this.onStoreUpdate()),void 0));const{projectSlug:s,releaseVersion:r}=this.props,i=C.Z.get(s,r);this.state={...i}}componentDidMount(){this.fetchRelease(),this.fetchDeploys()}componentWillUnmount(){this.unsubscribe()}fetchRelease(){const{api:e,organization:t,projectSlug:s,releaseVersion:o}=this.props,r=C.Z.get(s,o),i=t.slug;(!r.release&&!r.releaseLoading||r.releaseError)&&(0,z.o7)(e,{orgSlug:i,projectSlug:s,releaseVersion:o})}fetchDeploys(){const{api:e,organization:t,projectSlug:s,releaseVersion:o}=this.props,r=C.Z.get(s,o),i=t.slug;(!r.deploys&&!r.deploysLoading||r.deploysError)&&(0,z.dF)(e,{orgSlug:i,projectSlug:s,releaseVersion:o})}onStoreUpdate(){const{projectSlug:e,releaseVersion:t}=this.props,s=C.Z.get(e,t);this.setState({...s})}render(){return(0,u.tZ)(e,{...this.props,...this.state})}}return t.displayName="WithRelease",(0,o.Z)(t,"displayName",`withRelease(${(0,$.Z)(e)})`),t}((0,_.Z)(N))),M=(0,r.Z)("div",{target:"ejgji4u9"})("padding:",(0,g.Z)(2),";text-align:center;"),T=(0,r.Z)(j,{target:"ejgji4u8"})({name:"1uxsuq0",styles:"width:86px"}),X=(0,r.Z)(c.Z,{target:"ejgji4u7"})("color:",(e=>e.theme.gray300),";font-size:",(e=>e.theme.fontSizeSmall),";"),k=(0,r.Z)("div",{target:"ejgji4u6"})({name:"bcffy2",styles:"display:flex;align-items:center;justify-content:space-between"}),D=(0,r.Z)("div",{target:"ejgji4u5"})({name:"8nnmo9",styles:"display:flex;flex:1;align-items:center;justify-content:flex-end"}),V=(0,r.Z)(w.Z,{target:"ejgji4u4"})("margin-right:",(0,g.Z)(.5),";max-width:190px;"),O=(0,r.Z)("span",{target:"ejgji4u3"})({name:"1p3qk0r",styles:"&:hover{cursor:pointer;}"}),U=(0,r.Z)("div",{target:"ejgji4u2"})("color:",(e=>e.theme.headingColor),";font-size:",(e=>e.theme.headerFontSize),";"),A=(0,r.Z)(y,{target:"ejgji4u1"})("margin-top:",(0,g.Z)(2),";"),P=(0,r.Z)("div",{target:"ejgji4u0"})("display:grid;grid-template-columns:max-content minmax(0, 1fr);gap:",(0,g.Z)(1),";justify-items:start;align-items:center;")},"./app/stores/releaseStore.tsx":(e,t,s)=>{s.d(t,{Z:()=>n,p:()=>i}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var o=s("../node_modules/reflux/src/index.js"),r=s("./app/actions/organizationActions.tsx");const i=(e,t)=>`${e}${t}`,a={state:{orgSlug:void 0,release:new Map,releaseLoading:new Map,releaseError:new Map,deploys:new Map,deploysLoading:new Map,deploysError:new Map},unsubscribeListeners:[],init(){this.unsubscribeListeners.push(this.listenTo(r.Z.update,this.updateOrganization)),this.reset()},reset(){this.state={orgSlug:void 0,release:new Map,releaseLoading:new Map,releaseError:new Map,deploys:new Map,deploysLoading:new Map,deploysError:new Map},this.trigger(this.state)},updateOrganization(e){this.reset(),this.state.orgSlug=e.slug,this.trigger(this.state)},loadRelease(e,t,s){this.orgSlug&&this.orgSlug===e||(this.reset(),this.orgSlug=e);const o=i(t,s),{releaseLoading:r,releaseError:a,...n}=this.state;this.state={...n,releaseLoading:{...r,[o]:!0},releaseError:{...a,[o]:void 0}},this.trigger(this.state)},loadReleaseError(e,t,s){const o=i(e,t),{releaseLoading:r,releaseError:a,...n}=this.state;this.state={...n,releaseLoading:{...r,[o]:!1},releaseError:{...a,[o]:s}},this.trigger(this.state)},loadReleaseSuccess(e,t,s){const o=i(e,t),{release:r,releaseLoading:a,releaseError:n,...l}=this.state;this.state={...l,release:{...r,[o]:s},releaseLoading:{...a,[o]:!1},releaseError:{...n,[o]:void 0}},this.trigger(this.state)},loadDeploys(e,t,s){this.orgSlug&&this.orgSlug===e||(this.reset(),this.orgSlug=e);const o=i(t,s),{deploysLoading:r,deploysError:a,...n}=this.state;this.state={...n,deploysLoading:{...r,[o]:!0},deploysError:{...a,[o]:void 0}},this.trigger(this.state)},loadDeploysError(e,t,s){const o=i(e,t),{deploysLoading:r,deploysError:a,...n}=this.state;this.state={...n,deploysLoading:{...r,[o]:!1},deploysError:{...a,[o]:s}},this.trigger(this.state)},loadDeploysSuccess(e,t,s){const o=i(e,t),{deploys:r,deploysLoading:a,deploysError:n,...l}=this.state;this.state={...l,deploys:{...r,[o]:s},deploysLoading:{...a,[o]:!1},deploysError:{...n,[o]:void 0}},this.trigger(this.state)},get(e,t){const s=i(e,t);return{release:this.state.release[s],releaseLoading:this.state.releaseLoading[s],releaseError:this.state.releaseError[s],deploys:this.state.deploys[s],deploysLoading:this.state.deploysLoading[s],deploysError:this.state.deploysError[s]}}},n=(0,o.createStore)(a)},"./app/stores/repositoryStore.tsx":(e,t,s)=>{s.d(t,{Z:()=>r});const o={state:{orgSlug:void 0,repositories:void 0,repositoriesLoading:void 0,repositoriesError:void 0},init(){this.resetRepositories()},resetRepositories(){this.state={orgSlug:void 0,repositories:void 0,repositoriesLoading:void 0,repositoriesError:void 0},this.trigger(this.state)},loadRepositories(e){this.state={orgSlug:e,repositories:e===this.state.orgSlug?this.state.repositories:void 0,repositoriesLoading:!0,repositoriesError:void 0},this.trigger(this.state)},loadRepositoriesError(e){this.state={...this.state,repositories:void 0,repositoriesLoading:!1,repositoriesError:e},this.trigger(this.state)},loadRepositoriesSuccess(e){this.state={...this.state,repositories:e,repositoriesLoading:!1,repositoriesError:void 0},this.trigger(this.state)},get(){return{...this.state}}},r=(0,s("../node_modules/reflux/src/index.js").createStore)(o)},"./app/utils/withRepositories.tsx":(e,t,s)=>{s.d(t,{Z:()=>p});var o=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=s("../node_modules/react/index.js"),i=s("../node_modules/@sentry/hub/esm/exports.js"),a=s("./app/stores/repositoryStore.tsx"),n=s("./app/utils/getDisplayName.tsx"),l=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const d={repositories:void 0,repositoriesLoading:void 0,repositoriesError:void 0},p=function(e){class t extends r.Component{constructor(e,t){super(e,t),(0,o.Z)(this,"unsubscribe",a.Z.listen((()=>this.onStoreUpdate()),void 0));const s=a.Z.get();this.state=s.orgSlug===e.organization.slug?{...d,...s}:{...d}}componentDidMount(){const{organization:e}=this.props,t=e.slug;a.Z.get().orgSlug!==t&&a.Z.resetRepositories(),this.fetchRepositories()}componentWillUnmount(){this.unsubscribe()}fetchRepositories(){const{api:e,organization:t}=this.props,s=t.slug,o=a.Z.get();(!o.repositories&&!o.repositoriesLoading||o.repositoriesError)&&function(e,t){const{orgSlug:s}=t,o=`/organizations/${s}/repos/`;a.Z.state.repositoriesLoading=!0,a.Z.loadRepositories(s),e.requestPromise(o,{method:"GET"}).then((e=>{a.Z.loadRepositoriesSuccess(e)})).catch((e=>{a.Z.loadRepositoriesError(e),i.$e((t=>{t.setLevel("warning"),t.setFingerprint(["getRepositories-action-creator"]),i.Tb(e)}))}))}(e,{orgSlug:s})}onStoreUpdate(){const e=a.Z.get();this.setState({...e})}render(){return(0,l.tZ)(e,{...this.props,...this.state})}}return t.displayName="WithRepositories",(0,o.Z)(t,"displayName",`withRepositories(${(0,n.Z)(e)})`),t}}}]);
//# sourceMappingURL=../sourcemaps/app_components_versionHoverCard_tsx.53564b3300e71854bf7ea4ef6be71297.js.map