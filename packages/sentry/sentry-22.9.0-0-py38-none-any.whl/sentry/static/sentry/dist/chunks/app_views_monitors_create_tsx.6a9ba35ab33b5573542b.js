"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_monitors_create_tsx"],{"./app/views/asyncView.tsx":(e,t,s)=>{s.d(t,{Z:()=>i});var n=s("./app/components/asyncComponent.tsx"),o=s("./app/components/sentryDocumentTitle.tsx"),r=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class i extends n.Z{getTitle(){return""}render(){return(0,r.tZ)(o.Z,{title:this.getTitle(),children:this.renderComponent()})}}i.displayName="AsyncView"},"./app/views/monitors/create.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>c});var n=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),r=s("../node_modules/react-router/es/index.js"),i=s("./app/views/asyncView.tsx"),l=s("./app/views/monitors/monitorForm.tsx"),a=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class c extends i.Z{constructor(){super(...arguments),(0,n.Z)(this,"onSubmitSuccess",(e=>{r.browserHistory.push(`/organizations/${this.props.params.orgId}/monitors/${e.id}/`)}))}getTitle(){return`Monitors - ${this.props.params.orgId}`}renderBody(){return(0,a.BX)(o.Fragment,{children:[(0,a.tZ)("h1",{children:"New Monitor"}),(0,a.tZ)(l.Z,{apiMethod:"POST",apiEndpoint:`/organizations/${this.props.params.orgId}/monitors/`,onSubmitSuccess:this.onSubmitSuccess})]})}}},"./app/views/monitors/monitorForm.tsx":(e,t,s)=>{s.d(t,{Z:()=>v});var n=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),r=s("../node_modules/mobx-react-lite/es/index.js"),i=s("./app/components/acl/access.tsx"),l=s("./app/components/forms/field/index.tsx"),a=s("./app/components/forms/form.tsx"),c=s("./app/components/forms/numberField.tsx"),d=s("./app/components/forms/selectField.tsx"),u=s("./app/components/forms/textCopyInput.tsx"),m=s("./app/components/forms/textField.tsx"),p=s("./app/components/panels/index.tsx"),h=s("./app/locale.tsx"),g=s("./app/utils/withPageFilters.tsx"),b=s("./app/utils/withProjects.tsx"),f=(s("../node_modules/core-js/modules/web.url.to-json.js"),s("./app/components/forms/model.tsx"));class x extends f.Z{getTransformedData(){return this.fields.toJSON().reduce(((e,t)=>{let[s,n]=t;return 0!==s.indexOf("config.")?(e[s]=n,e):(e.config||(e.config={}),"config.schedule.frequency"!==s&&"config.schedule.interval"!==s||Array.isArray(e.config.schedule)||(e.config.schedule=[null,null]),"config.schedule.frequency"===s?e.config.schedule[0]=parseInt(n,10):"config.schedule.interval"===s?e.config.schedule[1]=n:e.config[s.substr(7)]=n,e)}),{})}getTransformedValue(e){return 0===e.indexOf("config")?this.getValue(e):super.getTransformedValue(e)}}var Z=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const y=[{value:"crontab",label:"Crontab"},{value:"interval",label:"Interval"}],j=[{value:"cron_job",label:"Cron Job"}],w=[{value:"minute",label:"minute(s)"},{value:"hour",label:"hour(s)"},{value:"day",label:"day(s)"},{value:"week",label:"week(s)"},{value:"month",label:"month(s)"},{value:"year",label:"year(s)"}];class _ extends o.Component{constructor(){super(...arguments),(0,n.Z)(this,"form",new x)}formDataFromConfig(e,t){const s={};return"cron_job"===e&&(s["config.schedule_type"]=t.schedule_type,s["config.checkin_margin"]=t.checkin_margin,s["config.max_runtime"]=t.max_runtime,"interval"===t.schedule_type?(s["config.schedule.frequency"]=t.schedule[0],s["config.schedule.interval"]=t.schedule[1]):s["config.schedule"]=t.schedule),s}render(){const{monitor:e}=this.props,t=this.props.selection.projects[0],s=t?this.props.projects.find((e=>e.id===t+"")):null;return(0,Z.tZ)(i.Z,{access:["project:write"],children:t=>{let{hasAccess:n}=t;return(0,Z.BX)(a.Z,{allowUndo:!0,requireChanges:!0,apiEndpoint:this.props.apiEndpoint,apiMethod:this.props.apiMethod,model:this.form,initialData:e?{name:e.name,type:e.type,project:e.project.slug,...this.formDataFromConfig(e.type,e.config)}:{project:s?s.slug:null},onSubmitSuccess:this.props.onSubmitSuccess,children:[(0,Z.BX)(p.s_,{children:[(0,Z.tZ)(p.V9,{children:(0,h.t)("Details")}),(0,Z.BX)(p.N,{children:[e&&(0,Z.tZ)(l.Z,{label:(0,h.t)("ID"),children:(0,Z.tZ)("div",{className:"controls",children:(0,Z.tZ)(u.ZP,{children:e.id})})}),(0,Z.tZ)(d.Z,{name:"project",label:(0,h.t)("Project"),disabled:!n,options:this.props.projects.filter((e=>e.isMember)).map((e=>({value:e.slug,label:e.slug}))),required:!0}),(0,Z.tZ)(m.Z,{name:"name",placeholder:(0,h.t)("My Cron Job"),label:(0,h.t)("Name"),disabled:!n,required:!0})]})]}),(0,Z.BX)(p.s_,{children:[(0,Z.tZ)(p.V9,{children:(0,h.t)("Config")}),(0,Z.BX)(p.N,{children:[(0,Z.tZ)(d.Z,{name:"type",label:(0,h.t)("Type"),disabled:!n,options:j,required:!0}),(0,Z.tZ)(r.Qj,{children:()=>"cron_job"===this.form.getValue("type")?(0,Z.BX)(o.Fragment,{children:[(0,Z.tZ)(c.Z,{name:"config.max_runtime",label:(0,h.t)("Max Runtime"),disabled:!n,help:(0,h.t)("The maximum runtime (in minutes) a check-in is allowed before it's marked as a failure."),placeholder:"e.g. 30"}),(0,Z.tZ)(d.Z,{name:"config.schedule_type",label:(0,h.t)("Schedule Type"),disabled:!n,options:y,required:!0})]}):null}),(0,Z.tZ)(r.Qj,{children:()=>{switch(this.form.getValue("config.schedule_type")){case"crontab":return(0,Z.BX)(o.Fragment,{children:[(0,Z.tZ)(m.Z,{name:"config.schedule",label:(0,h.t)("Schedule"),disabled:!n,placeholder:"*/5 * * * *",required:!0,help:(0,h._N)("Changes to the schedule will apply on the next check-in. See [link:Wikipedia] for crontab syntax.",{link:(0,Z.tZ)("a",{href:"https://en.wikipedia.org/wiki/Cron"})})}),(0,Z.tZ)(c.Z,{name:"config.checkin_margin",label:(0,h.t)("Check-in Margin"),disabled:!n,help:(0,h.t)("The margin (in minutes) a check-in is allowed to exceed it's scheduled window before being treated as missed."),placeholder:"e.g. 30"})]});case"interval":return(0,Z.BX)(o.Fragment,{children:[(0,Z.tZ)(c.Z,{name:"config.schedule.frequency",label:(0,h.t)("Frequency"),disabled:!n,placeholder:"e.g. 1",required:!0}),(0,Z.tZ)(d.Z,{name:"config.schedule.interval",label:(0,h.t)("Interval"),disabled:!n,options:w,required:!0}),(0,Z.tZ)(c.Z,{name:"config.checkin_margin",label:(0,h.t)("Check-in Margin"),disabled:!n,help:(0,h.t)("The margin (in minutes) a check-in is allowed to exceed it's scheduled window before being treated as missed."),placeholder:"e.g. 30"})]});default:return null}}})]})]})]})}})}}_.displayName="MonitorForm";const v=(0,g.Z)((0,b.Z)(_))}}]);
//# sourceMappingURL=../sourcemaps/app_views_monitors_create_tsx.be871ddb1e81693234653d7ef2fa56f0.js.map