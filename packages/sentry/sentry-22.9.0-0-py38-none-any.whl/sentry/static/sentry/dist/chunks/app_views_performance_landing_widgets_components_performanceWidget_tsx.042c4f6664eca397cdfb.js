"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_performance_landing_widgets_components_performanceWidget_tsx"],{"./app/views/performance/landing/widgets/components/performanceWidget.tsx":(t,e,a)=>{a.d(e,{I:()=>N});var i=a("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=(a("../node_modules/core-js/modules/web.dom-collections.iterator.js"),a("../node_modules/react/index.js")),s=a("../node_modules/react-router/es/index.js"),o=a("./app/components/charts/errorPanel.tsx"),n=a("./app/components/placeholder.tsx"),l=a("./app/icons/iconWarning.tsx"),d=a("./app/styles/space.tsx"),p=a("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),c=a("./app/utils/getDynamicText.tsx"),_=(a("../node_modules/core-js/modules/es.array.includes.js"),a("./app/components/tag.tsx")),u=a("./app/utils/useOrganization.tsx"),m=a("./app/views/performance/landing/widgets/utils.tsx"),T=a("./app/utils/performance/contexts/metricsEnhancedSetting.tsx"),A=a("./app/utils/performance/contexts/utils.tsx"),S=a("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const[g,R]=(0,A.n)({name:"MetricsEnhancedPerformanceDataContext"}),h=t=>{let{children:e,chartSetting:a}=t;const{setAutoSampleState:i}=(0,T.Eg)(),[s,o]=(0,r.useState)(void 0),n=(0,r.useCallback)((t=>{m.zS.includes(a)||(!0===t?i(T.nl.metrics):!1===t&&i(T.nl.transactions),o(t))}),[i,o,a]);return(0,S.tZ)(g,{value:{isMetricsData:s,setIsMetricsData:n},children:e})};h.displayName="MEPDataProvider";const f=R,O=()=>{const{isMetricsData:t}=f();if(!(0,u.Z)().features.includes("performance-use-metrics"))return null;if(void 0===t)return(0,S.tZ)("span",{"data-test-id":"no-metrics-data-tag"});const e=t?"processed":"indexed";return(0,S.tZ)(_.Z,{"data-test-id":"has-metrics-data-tag",children:e})};O.displayName="MEPTag";var y=a("./app/utils/useApi.tsx"),E=a("./app/components/panels/index.tsx");const v=(0,i.Z)(E.s_,{target:"e1evmidq1"})("padding-top:",(0,d.Z)(2),";margin-bottom:0;"),D=(0,i.Z)("div",{target:"e1evmidq0"})("");function P(t){return t.isErrored?t.errorComponent:t.isLoading&&t.loadingComponent?t.loadingComponent:t.hasData?(0,S.tZ)(r.Fragment,{children:t.dataComponents}):t.emptyComponent}P.displayName="DataStateSwitch",a("../node_modules/core-js/modules/es.string.replace.js");var w=a("./app/utils/dates.tsx");function I(t){var e;const a=null!==(e=t.children)&&void 0!==e?e:(0,S.tZ)(r.Fragment,{});return t.queries.length?(0,S.tZ)(r.Fragment,{children:t.queries.filter((e=>!e.enabled||e.enabled(t.widgetData))).map((e=>(0,S.tZ)(C,{...t,query:e},e.queryKey)))}):(0,S.tZ)(r.Fragment,{children:a})}function C(t){const e=t.query,a=t.queryProps.eventView.getPageFilters(),i=a.datetime.start?(0,w.hC)(a.datetime.start):null,s=a.datetime.end?(0,w.hC)(a.datetime.end):null;return(0,r.useEffect)((()=>()=>{t.removeWidgetDataForKey(e.queryKey)}),[]),(0,S.tZ)(e.component,{fields:e.fields,yAxis:e.fields,start:i,end:s,period:a.datetime.period,project:a.projects,environment:a.environments,organization:t.queryProps.organization,orgSlug:t.queryProps.organization.slug,eventView:t.queryProps.eventView,query:t.queryProps.eventView.getQueryWithAdditionalConditions(),widgetData:t.widgetData,referrer:(o=t.queryProps.chartSetting,`api.performance.generic-widget-chart.${o.replace(/_/g,"-")}`),children:a=>(0,S.tZ)(r.Fragment,{children:(0,S.tZ)(M,{results:a,...t,query:e})})},e.queryKey);var o}function M(t){const e=f(),{results:a,query:i}=t,s=i.transform(t.queryProps,a,t.query);return(0,r.useEffect)((()=>{var r,o,n,l,d;const p=null!==(r=null==a||null===(o=a.seriesAdditionalInfo)||void 0===o||null===(n=o[t.queryProps.fields[0]])||void 0===n?void 0:n.isMetricsData)&&void 0!==r?r:null==a||null===(l=a.histograms)||void 0===l||null===(d=l.meta)||void 0===d?void 0:d.isMetricsData;e.setIsMetricsData(p),t.setWidgetDataForKey(i.queryKey,s)}),[null==s?void 0:s.hasData,null==s?void 0:s.isLoading,null==s?void 0:s.isErrored]),(0,S.tZ)(r.Fragment,{})}I.displayName="QueryHandler",C.displayName="SingleQueryHandler",M.displayName="QueryResultSaver";var Z=a("./app/components/charts/styles.tsx"),$=a("./app/components/questionTooltip.tsx"),F=a("./app/components/textOverflow.tsx");function x(t){const{title:e,titleTooltip:a,Subtitle:i,HeaderActions:r}=t;return(0,S.BX)(V,{children:[(0,S.BX)(W,{children:[(0,S.BX)(L,{"data-test-id":"performance-widget-title",children:[(0,S.tZ)(F.Z,{children:e}),(0,S.tZ)(O,{}),(0,S.tZ)($.Z,{position:"top",size:"sm",title:a})]}),i?(0,S.tZ)(i,{...t}):null]}),(0,S.tZ)(b,{children:r&&(0,S.tZ)(r,{...t})})]})}x.displayName="WidgetHeader";const L=(0,i.Z)(Z.ws,{target:"evi51ay3"})({name:"ld8wu3",styles:"position:relative;z-index:initial"}),W=(0,i.Z)("div",{target:"evi51ay2"})({name:"6kz1wu",styles:"display:flex;flex-direction:column;align-items:flex-start"}),V=(0,i.Z)("div",{target:"evi51ay1"})("display:flex;justify-content:space-between;align-items:flex-start;gap:",(0,d.Z)(1),";"),b=(0,i.Z)("div",{target:"evi51ay0"})("display:flex;align-items:center;gap:",(0,d.Z)(1),";");function N(t){var e;const[a,i]=(0,r.useState)({}),s=null!==(e=a[t.chartSetting])&&void 0!==e?e:{},o=(0,r.useRef)(s),n=(0,r.useCallback)(((e,a)=>{const r={...o.current,[e]:a};o.current=r,i({[t.chartSetting]:r})}),[a,i]),l=(0,r.useCallback)((e=>{const a={...o.current};delete a[e],o.current=a,i({[t.chartSetting]:a})}),[a,i]),d={widgetData:s,setWidgetDataForKey:n,removeWidgetDataForKey:l},p=Object.entries(t.Queries).map((t=>{let[e,a]=t;return{...a,queryKey:e}})),c=(0,y.Z)(),_=t.Visualizations.reduce(((t,e)=>t+e.height),0);return(0,S.tZ)(r.Fragment,{children:(0,S.BX)(h,{chartSetting:t.chartSetting,children:[(0,S.tZ)(I,{eventView:t.eventView,widgetData:s,setWidgetDataForKey:n,removeWidgetDataForKey:l,queryProps:t,queries:p,api:c}),(0,S.tZ)(U,{...t,...d,totalHeight:_})]})})}function U(t){const{Visualizations:e,chartHeight:a,totalHeight:i,containerType:r,EmptyComponent:s}=t,o=(t=>{let{containerType:e}=t;return"panel"===e?v:D})({containerType:r}),l=Object.keys(t.Queries).length,d=Object.values(t.widgetData).length!==l,_=!d&&Object.values(t.widgetData).every((t=>!t||t.hasData)),u=Object.values(t.widgetData).some((t=>!t||t.isLoading)),m=!d&&Object.values(t.widgetData).some((t=>t&&t.isErrored));return(0,S.BX)(o,{"data-test-id":"performance-widget-container",children:[(0,S.tZ)(j,{children:(0,S.tZ)(x,{...t})}),(0,S.tZ)(P,{isLoading:u,isErrored:m,hasData:_,errorComponent:(0,S.tZ)(q,{height:i}),dataComponents:e.map(((e,i)=>(0,S.tZ)(j,{noPadding:e.noPadding,bottomPadding:e.bottomPadding,"data-test-id":"widget-state-has-data",onClick:()=>{return e=t.chartSetting,a=t.organization,void(0,p.Z)("performance_views.landingv3.widget.interaction",{organization:a,widget_type:e});var e,a},children:(0,c.Z)({value:(0,S.tZ)(e.component,{grid:H,queryFields:e.fields,widgetData:t.widgetData,height:a}),fixed:(0,S.tZ)(n.Z,{height:`${a}px`})})},i))),loadingComponent:(0,S.tZ)(z,{height:`${i}px`}),emptyComponent:s?(0,S.tZ)(s,{}):(0,S.tZ)(z,{height:`${i}px`})})]})}N.displayName="GenericPerformanceWidget",U.displayName="_DataDisplay",(0,s.withRouter)(U);const q=t=>(0,S.tZ)(o.Z,{"data-test-id":"widget-state-is-errored",height:`${t.height}px`,children:(0,S.tZ)(l.F,{color:"gray300",size:"lg"})});q.displayName="DefaultErrorComponent";const H={left:(0,d.Z)(0),right:(0,d.Z)(0),top:(0,d.Z)(2),bottom:(0,d.Z)(1)},j=(0,i.Z)("div",{target:"eqcpc8s1"})("padding-left:",(t=>t.noPadding?(0,d.Z)(0):(0,d.Z)(2)),";padding-right:",(t=>t.noPadding?(0,d.Z)(0):(0,d.Z)(2)),";padding-bottom:",(t=>t.bottomPadding?(0,d.Z)(1):(0,d.Z)(0)),";"),z=(0,i.Z)(n.Z,{target:"eqcpc8s0"})({name:"cs3onb",styles:"border-color:transparent;border-bottom-right-radius:inherit;border-bottom-left-radius:inherit"});N.defaultProps={containerType:"panel",chartHeight:200}},"./app/views/performance/landing/widgets/types.tsx":(t,e,a)=>{let i,r;a.d(e,{A:()=>r}),function(t){t.ERROR="error",t.LOADING="loading",t.EMPTY="empty",t.DATA="data"}(i||(i={})),function(t){t.histogram="histogram",t.area="area",t.vitals="vitals",t.line_list="line_list",t.trends="trends"}(r||(r={}))},"./app/views/performance/landing/widgets/utils.tsx":(t,e,a)=>{a.d(e,{CJ:()=>n,E9:()=>p,I2:()=>_,gM:()=>d,hD:()=>R,rp:()=>A,zM:()=>S,zS:()=>c}),a("../node_modules/core-js/modules/es.array.includes.js");var i=a("./app/utils.tsx"),r=a("./app/utils/localStorage.tsx"),s=a("./app/utils/performance/contexts/metricsEnhancedSetting.tsx"),o=a("./app/views/performance/landing/widgets/widgetDefinitions.tsx");const n=["children","organization","yAxis","period","start","end","environment","project","referrer"],l={};function d(t){let e={};const a=l;return t.shouldQueryProvideMEPAutoParams&&(e={...e,...a,dataset:"metricsEnhanced"}),t.shouldQueryProvideMEPTransactionParams&&(e={...e,...a,dataset:"discover"}),t.shouldQueryProvideMEPMetricParams&&(e={...e,...a,dataset:"metrics"}),(0,i.z)(e)?void 0:e}function p(){return{...l,dataset:"metrics"}}const c=[o.s.MOST_RELATED_ERRORS,o.s.MOST_RELATED_ISSUES];function _(t,e){if(!c.includes(e))return d(t)}const u="landing-chart-container",m=(t,e,a)=>`landing-chart-container#${e}#${a}#${t}`;function T(){return JSON.parse(r.Z.getItem(u)||"{}")}const A=(t,e,a,i,r)=>{if(r)return i;const s=m(t,a,e),n=T(),l=null==n?void 0:n[s];return l&&Object.values(o.s).includes(l)?l:i},S=(t,e,a,i)=>{const s=m(t,a,e),o=T();o[s]=i,function(t){r.Z.setItem(u,JSON.stringify(t))}(o)},g=[o.s.DURATION_HISTOGRAM,o.s.FCP_HISTOGRAM,o.s.LCP_HISTOGRAM,o.s.FID_HISTOGRAM];function R(t,e,a){return(0,s.gp)(t)&&a.metricSettingState!==s.oR.transactionsOnly?e.filter((t=>!g.includes(t))):e}},"./app/views/performance/landing/widgets/widgetDefinitions.tsx":(t,e,a)=>{a.d(e,{W:()=>d,s:()=>n});var i=a("./app/constants/chartPalette.tsx"),r=a("./app/locale.tsx"),s=a("./app/views/performance/data.tsx"),o=a("./app/views/performance/landing/widgets/types.tsx");let n;!function(t){t.DURATION_HISTOGRAM="duration_histogram",t.LCP_HISTOGRAM="lcp_histogram",t.FCP_HISTOGRAM="fcp_histogram",t.FID_HISTOGRAM="fid_histogram",t.APDEX_AREA="apdex_area",t.P50_DURATION_AREA="p50_duration_area",t.P75_DURATION_AREA="p75_duration_area",t.P95_DURATION_AREA="p95_duration_area",t.P99_DURATION_AREA="p99_duration_area",t.P75_LCP_AREA="p75_lcp_area",t.TPM_AREA="tpm_area",t.FAILURE_RATE_AREA="failure_rate_area",t.USER_MISERY_AREA="user_misery_area",t.WORST_LCP_VITALS="worst_lcp_vitals",t.WORST_FCP_VITALS="worst_fcp_vitals",t.WORST_CLS_VITALS="worst_cls_vitals",t.WORST_FID_VITALS="worst_fid_vitals",t.MOST_IMPROVED="most_improved",t.MOST_REGRESSED="most_regressed",t.MOST_RELATED_ERRORS="most_related_errors",t.MOST_RELATED_ISSUES="most_related_issues",t.SLOW_HTTP_OPS="slow_http_ops",t.SLOW_DB_OPS="slow_db_ops",t.SLOW_RESOURCE_OPS="slow_resource_ops",t.SLOW_BROWSER_OPS="slow_browser_ops",t.COLD_STARTUP_AREA="cold_startup_area",t.WARM_STARTUP_AREA="warm_startup_area",t.SLOW_FRAMES_AREA="slow_frames_area",t.FROZEN_FRAMES_AREA="frozen_frames_area",t.MOST_SLOW_FRAMES="most_slow_frames",t.MOST_FROZEN_FRAMES="most_frozen_frames"}(n||(n={}));const l=i.Z[5],d=t=>{let{organization:e}=t;return{[n.DURATION_HISTOGRAM]:{title:(0,r.t)("Duration Distribution"),titleTooltip:(0,s.$r)(e,s.V$.DURATION_DISTRIBUTION),fields:["transaction.duration"],dataType:o.A.histogram,chartColor:l[5]},[n.LCP_HISTOGRAM]:{title:(0,r.t)("LCP Distribution"),titleTooltip:(0,s.$r)(e,s.V$.DURATION_DISTRIBUTION),fields:["measurements.lcp"],dataType:o.A.histogram,chartColor:l[5]},[n.FCP_HISTOGRAM]:{title:(0,r.t)("FCP Distribution"),titleTooltip:(0,s.$r)(e,s.V$.DURATION_DISTRIBUTION),fields:["measurements.fcp"],dataType:o.A.histogram,chartColor:l[5]},[n.FID_HISTOGRAM]:{title:(0,r.t)("FID Distribution"),titleTooltip:(0,s.$r)(e,s.V$.DURATION_DISTRIBUTION),fields:["measurements.fid"],dataType:o.A.histogram,chartColor:l[5]},[n.WORST_LCP_VITALS]:{title:(0,r.t)("Worst LCP Web Vitals"),titleTooltip:(0,s.$r)(e,s.V$.LCP),fields:["measurements.lcp"],vitalStops:{poor:4e3,meh:2500},dataType:o.A.vitals},[n.WORST_FCP_VITALS]:{title:(0,r.t)("Worst FCP Web Vitals"),titleTooltip:(0,s.$r)(e,s.V$.FCP),fields:["measurements.fcp"],vitalStops:{poor:3e3,meh:1e3},dataType:o.A.vitals},[n.WORST_FID_VITALS]:{title:(0,r.t)("Worst FID Web Vitals"),titleTooltip:(0,s.$r)(e,s.V$.FID),fields:["measurements.fid"],vitalStops:{poor:300,meh:100},dataType:o.A.vitals},[n.WORST_CLS_VITALS]:{title:(0,r.t)("Worst CLS Web Vitals"),titleTooltip:(0,s.$r)(e,s.V$.CLS),fields:["measurements.cls"],vitalStops:{poor:.25,meh:.1},dataType:o.A.vitals},[n.TPM_AREA]:{title:(0,r.t)("Transactions Per Minute"),titleTooltip:(0,s.$r)(e,s.V$.TPM),fields:["tpm()"],dataType:o.A.area,chartColor:l[1],allowsOpenInDiscover:!0},[n.APDEX_AREA]:{title:(0,r.t)("Apdex"),titleTooltip:(0,s.$r)(e,s.V$.APDEX),fields:["apdex()"],dataType:o.A.area,chartColor:l[4],allowsOpenInDiscover:!0},[n.P50_DURATION_AREA]:{title:(0,r.t)("p50 Duration"),titleTooltip:(0,s.$r)(e,s.V$.P50),fields:["p50(transaction.duration)"],dataType:o.A.area,chartColor:l[3],allowsOpenInDiscover:!0},[n.P75_DURATION_AREA]:{title:(0,r.t)("p75 Duration"),titleTooltip:(0,s.$r)(e,s.V$.P75),fields:["p75(transaction.duration)"],dataType:o.A.area,chartColor:l[3],allowsOpenInDiscover:!0},[n.P95_DURATION_AREA]:{title:(0,r.t)("p95 Duration"),titleTooltip:(0,s.$r)(e,s.V$.P95),fields:["p95(transaction.duration)"],dataType:o.A.area,chartColor:l[3],allowsOpenInDiscover:!0},[n.P99_DURATION_AREA]:{title:(0,r.t)("p99 Duration"),titleTooltip:(0,s.$r)(e,s.V$.P99),fields:["p99(transaction.duration)"],dataType:o.A.area,chartColor:l[3],allowsOpenInDiscover:!0},[n.P75_LCP_AREA]:{title:(0,r.t)("p75 LCP"),titleTooltip:(0,s.$r)(e,s.V$.P75),fields:["p75(measurements.lcp)"],dataType:o.A.area,chartColor:l[1],allowsOpenInDiscover:!0},[n.FAILURE_RATE_AREA]:{title:(0,r.t)("Failure Rate"),titleTooltip:(0,s.$r)(e,s.V$.FAILURE_RATE),fields:["failure_rate()"],dataType:o.A.area,chartColor:l[2],allowsOpenInDiscover:!0},[n.USER_MISERY_AREA]:{title:(0,r.t)("User Misery"),titleTooltip:(0,s.$r)(e,s.V$.USER_MISERY),fields:["user_misery()"],dataType:o.A.area,chartColor:l[0],allowsOpenInDiscover:!0},[n.COLD_STARTUP_AREA]:{title:(0,r.t)("Cold Startup Time"),titleTooltip:(0,s.$r)(e,s.V$.APP_START_COLD),fields:["p75(measurements.app_start_cold)"],dataType:o.A.area,chartColor:l[4],allowsOpenInDiscover:!0},[n.WARM_STARTUP_AREA]:{title:(0,r.t)("Warm Startup Time"),titleTooltip:(0,s.$r)(e,s.V$.APP_START_WARM),fields:["p75(measurements.app_start_warm)"],dataType:o.A.area,chartColor:l[3],allowsOpenInDiscover:!0},[n.SLOW_FRAMES_AREA]:{title:(0,r.t)("Slow Frames"),titleTooltip:(0,s.$r)(e,s.V$.SLOW_FRAMES),fields:["p75(measurements.frames_slow_rate)"],dataType:o.A.area,chartColor:l[0],allowsOpenInDiscover:!0},[n.FROZEN_FRAMES_AREA]:{title:(0,r.t)("Frozen Frames"),titleTooltip:(0,s.$r)(e,s.V$.FROZEN_FRAMES),fields:["p75(measurements.frames_frozen_rate)"],dataType:o.A.area,chartColor:l[5],allowsOpenInDiscover:!0},[n.MOST_RELATED_ERRORS]:{title:(0,r.t)("Most Related Errors"),titleTooltip:(0,s.$r)(e,s.V$.MOST_ERRORS),fields:["failure_count()"],dataType:o.A.line_list,chartColor:l[0]},[n.MOST_RELATED_ISSUES]:{title:(0,r.t)("Most Related Issues"),titleTooltip:(0,s.$r)(e,s.V$.MOST_ISSUES),fields:["count()"],dataType:o.A.line_list,chartColor:l[0]},[n.SLOW_HTTP_OPS]:{title:(0,r.t)("Slow HTTP Ops"),titleTooltip:(0,s.$r)(e,s.V$.SLOW_HTTP_SPANS),fields:["p75(spans.http)"],dataType:o.A.line_list,chartColor:l[0]},[n.SLOW_BROWSER_OPS]:{title:(0,r.t)("Slow Browser Ops"),titleTooltip:(0,s.$r)(e,s.V$.SLOW_HTTP_SPANS),fields:["p75(spans.browser)"],dataType:o.A.line_list,chartColor:l[0]},[n.SLOW_RESOURCE_OPS]:{title:(0,r.t)("Slow Resource Ops"),titleTooltip:(0,s.$r)(e,s.V$.SLOW_HTTP_SPANS),fields:["p75(spans.resource)"],dataType:o.A.line_list,chartColor:l[0]},[n.SLOW_DB_OPS]:{title:(0,r.t)("Slow DB Ops"),titleTooltip:(0,s.$r)(e,s.V$.SLOW_HTTP_SPANS),fields:["p75(spans.db)"],dataType:o.A.line_list,chartColor:l[0]},[n.MOST_SLOW_FRAMES]:{title:(0,r.t)("Most Slow Frames"),titleTooltip:(0,s.$r)(e,s.V$.SLOW_FRAMES),fields:["avg(measurements.frames_slow)"],dataType:o.A.line_list,chartColor:l[0]},[n.MOST_FROZEN_FRAMES]:{title:(0,r.t)("Most Frozen Frames"),titleTooltip:(0,s.$r)(e,s.V$.FROZEN_FRAMES),fields:["avg(measurements.frames_frozen)"],dataType:o.A.line_list,chartColor:l[0]},[n.MOST_IMPROVED]:{title:(0,r.t)("Most Improved"),titleTooltip:(0,r.t)("This compares the baseline (%s) of the past with the present.","improved"),fields:[],dataType:o.A.trends},[n.MOST_REGRESSED]:{title:(0,r.t)("Most Regressed"),titleTooltip:(0,r.t)("This compares the baseline (%s) of the past with the present.","regressed"),fields:[],dataType:o.A.trends}}}}}]);
//# sourceMappingURL=../sourcemaps/app_views_performance_landing_widgets_components_performanceWidget_tsx.690512ecb96df0f6b6f43a6973d58e48.js.map