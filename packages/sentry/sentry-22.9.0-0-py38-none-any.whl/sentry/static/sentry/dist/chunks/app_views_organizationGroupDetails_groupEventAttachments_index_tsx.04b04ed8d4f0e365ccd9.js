(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_organizationGroupDetails_groupEventAttachments_index_tsx"],{"./app/components/acl/role.tsx":(e,t,s)=>{"use strict";s.d(t,{u:()=>i}),s("../node_modules/core-js/modules/es.array.includes.js");var n=s("../node_modules/react/index.js"),o=s("./app/stores/configStore.tsx"),r=s("./app/utils/isActiveSuperuser.tsx"),a=s("./app/utils/isRenderFunc.tsx");const i=(0,s("./app/utils/withOrganization.tsx").Z)((function(e){let{role:t,organization:s,children:i}=e;const d=o.Z.get("user"),l=(0,n.useMemo)((()=>function(e,t,s){var n,o;if(!e)return!1;if((0,r.M)())return!0;if(!Array.isArray(t.orgRoleList))return!1;const a=t.orgRoleList.map((e=>e.id));if(!a.includes(s)||!a.includes(null!==(n=t.role)&&void 0!==n?n:""))return!1;const i=a.indexOf(s);return a.indexOf(null!==(o=t.role)&&void 0!==o?o:"")>=i}(d,s,t)),[s,t,d]);return(0,a.l)(i)?i({hasRole:l}):l?i:null}))},"./app/components/events/eventAttachmentActions.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>v});var n=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=s("../node_modules/react/index.js"),r=s("./app/components/button.tsx"),a=s("./app/components/buttonBar.tsx"),i=s("./app/components/confirm.tsx"),d=s("./app/icons/index.tsx"),l=s("./app/locale.tsx"),c=s("./app/styles/space.tsx"),p=s("./app/utils/withApi.tsx"),m=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class u extends o.Component{handlePreview(){const{onPreview:e,attachmentId:t}=this.props;e&&e(t)}render(){const{url:e,withPreviewButton:t,hasPreview:s,previewIsOpen:n,onDelete:o,attachmentId:c}=this.props;return(0,m.BX)(a.ZP,{gap:1,children:[(0,m.tZ)(i.Z,{confirmText:(0,l.t)("Delete"),message:(0,l.t)("Are you sure you wish to delete this file?"),priority:"danger",onConfirm:()=>o(c),disabled:!e,children:(0,m.tZ)(r.ZP,{size:"xs",icon:(0,m.tZ)(d.Fz,{size:"xs"}),"aria-label":(0,l.t)("Delete"),disabled:!e,title:e?void 0:(0,l.t)("Insufficient permissions to delete attachments")})}),(0,m.tZ)(h,{size:"xs",icon:(0,m.tZ)(d.Dj,{size:"xs"}),href:e?`${e}?download=1`:"",disabled:!e,title:e?void 0:(0,l.t)("Insufficient permissions to download attachments"),"aria-label":(0,l.t)("Download")}),t&&(0,m.tZ)(h,{size:"xs",disabled:!e||!s,priority:n?"primary":"default",icon:(0,m.tZ)(d.fn,{size:"xs"}),onClick:()=>this.handlePreview(),title:e?s?void 0:(0,l.t)("This attachment cannot be previewed"):(0,l.t)("Insufficient permissions to preview attachments"),children:(0,l.t)("Preview")})]})}}u.displayName="EventAttachmentActions";const h=(0,n.Z)(r.ZP,{target:"erg6n450"})("margin-right:",(0,c.Z)(.5),";"),v=(0,p.Z)(u)},"./app/utils/attachmentUrl.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>d});var n=s("../node_modules/react/index.js"),o=s("./app/components/acl/role.tsx"),r=s("./app/utils/withOrganization.tsx"),a=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function i(e){let{attachment:t,organization:s,eventId:n,projectId:r,children:i}=e;return(0,a.tZ)(o.u,{role:s.attachmentsRole,children:e=>{let{hasRole:o}=e;return i(o?`/api/0/projects/${s.slug}/${r}/events/${n}/attachments/${t.id}/`:null)}})}i.displayName="AttachmentUrl";const d=(0,r.Z)((0,n.memo)(i))},"./app/views/organizationGroupDetails/groupEventAttachments/groupEventAttachmentsFilter.tsx":(e,t,s)=>{"use strict";s.d(t,{M:()=>h,Z:()=>Z});var n=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=s("../node_modules/react-router/es/index.js"),r=s("../node_modules/lodash/omit.js"),a=s.n(r),i=s("../node_modules/lodash/xor.js"),d=s.n(i),l=s("./app/components/button.tsx"),c=s("./app/components/buttonBar.tsx"),p=s("./app/locale.tsx"),m=s("./app/styles/space.tsx"),u=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const h=["event.minidump","event.applecrashreport"],v=e=>{const{query:t,pathname:s}=e.location,{types:n}=t,o=a()(t,"types"),r={...t,types:h};let i="";return void 0===n?i="all":0===d()(h,n).length&&(i="onlyCrash"),(0,u.tZ)(x,{children:(0,u.BX)(c.ZP,{merged:!0,active:i,children:[(0,u.tZ)(l.ZP,{barId:"all",size:"sm",to:{pathname:s,query:o},children:(0,p.t)("All Attachments")}),(0,u.tZ)(l.ZP,{barId:"onlyCrash",size:"sm",to:{pathname:s,query:r},children:(0,p.t)("Only Crash Reports")})]})})};v.displayName="GroupEventAttachmentsFilter";const x=(0,n.Z)("div",{target:"eftnont0"})("display:flex;justify-content:flex-end;margin-bottom:",(0,m.Z)(3),";"),Z=(0,o.withRouter)(v)},"./app/views/organizationGroupDetails/groupEventAttachments/index.tsx":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>k});var n=s("./app/components/acl/feature.tsx"),o=s("./app/components/acl/featureDisabled.tsx"),r=s("./app/locale.tsx"),a=s("./app/utils/withOrganization.tsx"),i=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),d=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react-router/es/index.js")),l=s("../node_modules/lodash/pick.js"),c=s.n(l),p=s("./app/actionCreators/indicator.tsx"),m=s("./app/components/asyncComponent.tsx"),u=s("./app/components/emptyStateWarning.tsx"),h=s("./app/components/layouts/thirds.tsx"),v=s("./app/components/loadingIndicator.tsx"),x=s("./app/components/pagination.tsx"),Z=s("./app/components/panels/index.tsx"),g=s("./app/views/organizationGroupDetails/groupEventAttachments/groupEventAttachmentsFilter.tsx"),y=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),j=s("./app/components/dateTime.tsx"),f=s("./app/components/events/eventAttachmentActions.tsx"),_=s("./app/components/fileSize.tsx"),b=s("./app/components/links/link.tsx"),A=s("./app/utils/attachmentUrl.tsx");const w={"event.minidump":(0,r.t)("Minidump"),"event.applecrashreport":(0,r.t)("Apple Crash Report"),"event.attachment":(0,r.t)("Other")};var I=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const D=e=>{let{attachment:t,projectId:s,onDelete:n,isDeleted:o,orgId:a,groupId:i}=e;return(0,I.BX)(z,{isDeleted:o,children:[(0,I.tZ)("td",{children:(0,I.BX)("h5",{children:[t.name,(0,I.tZ)("br",{}),(0,I.BX)("small",{children:[(0,I.tZ)(j.Z,{date:t.dateCreated})," Â·"," ",(0,I.tZ)(b.Z,{to:`/organizations/${a}/issues/${i}/events/${t.event_id}/`,children:t.event_id})]})]})}),(0,I.tZ)("td",{children:w[t.type]||(0,r.t)("Other")}),(0,I.tZ)("td",{children:(0,I.tZ)(_.Z,{bytes:t.size})}),(0,I.tZ)("td",{children:(0,I.tZ)(E,{children:(0,I.tZ)(A.Z,{projectId:s,eventId:t.event_id,attachment:t,children:e=>o?null:(0,I.tZ)(f.Z,{url:e,onDelete:n,attachmentId:t.id})})})})]})};D.displayName="GroupEventAttachmentsTableRow";const z=(0,y.Z)("tr",{target:"egfj2n61"})("opacity:",(e=>e.isDeleted?.3:1),";td{text-decoration:",(e=>e.isDeleted?"line-through":"normal"),";}"),E=(0,y.Z)("div",{target:"egfj2n60"})({name:"1r5gb7q",styles:"display:inline-block"}),N=D,P=e=>{let{attachments:t,orgId:s,projectId:n,groupId:o,onDelete:a,deletedAttachments:i}=e;const d=[(0,r.t)("Name"),(0,r.t)("Type"),(0,r.t)("Size"),(0,r.t)("Actions")];return(0,I.BX)("table",{className:"table events-table",children:[(0,I.tZ)("thead",{children:(0,I.tZ)("tr",{children:d.map((e=>(0,I.tZ)("th",{children:e},e)))})}),(0,I.tZ)("tbody",{children:t.map((e=>(0,I.tZ)(N,{attachment:e,orgId:s,projectId:n,groupId:o,onDelete:a,isDeleted:i.some((t=>e.id===t))},e.id)))})]})};P.displayName="GroupEventAttachmentsTable";const B=P;class C extends m.Z{constructor(){super(...arguments),(0,i.Z)(this,"handleDelete",(async e=>{var t,s;const{params:n,projectSlug:o}=this.props,r=null===(t=this.state)||void 0===t||null===(s=t.eventAttachments)||void 0===s?void 0:s.find((t=>t.id===e));if(r){this.setState((t=>({deletedAttachments:[...t.deletedAttachments,e]})));try{await this.api.requestPromise(`/projects/${n.orgId}/${o}/events/${r.event_id}/attachments/${r.id}/`,{method:"DELETE"})}catch(e){(0,p.Iw)("An error occurred while deleteting the attachment")}}}))}getDefaultState(){return{...super.getDefaultState(),deletedAttachments:[]}}getEndpoints(){const{params:e,location:t}=this.props;return[["eventAttachments",`/issues/${e.groupId}/attachments/`,{query:{...c()(t.query,["cursor","environment","types"]),limit:50}}]]}renderNoQueryResults(){return(0,I.tZ)(u.Z,{children:(0,I.tZ)("p",{children:(0,r.t)("No crash reports found")})})}renderEmpty(){return(0,I.tZ)(u.Z,{children:(0,I.tZ)("p",{children:(0,r.t)("No attachments found")})})}renderLoading(){return this.renderBody()}renderInnerBody(){const{projectSlug:e,params:t,location:s}=this.props,{loading:n,eventAttachments:o,deletedAttachments:r}=this.state;return n?(0,I.tZ)(v.Z,{}):o&&o.length>0?(0,I.tZ)(B,{attachments:o,orgId:t.orgId,projectId:e,groupId:t.groupId,onDelete:this.handleDelete,deletedAttachments:r}):s.query.types?this.renderNoQueryResults():this.renderEmpty()}renderBody(){return(0,I.tZ)(h.uT,{children:(0,I.BX)(h.or,{fullWidth:!0,children:[(0,I.tZ)(g.Z,{}),(0,I.tZ)(Z.s_,{className:"event-list",children:(0,I.tZ)(Z.N,{children:this.renderInnerBody()})}),(0,I.tZ)(x.Z,{pageLinks:this.state.eventAttachmentsPageLinks})]})})}}const R=(0,d.withRouter)(C),$=e=>{let{organization:t,group:s}=e;return(0,I.tZ)(n.Z,{features:["event-attachments"],organization:t,renderDisabled:e=>(0,I.tZ)(o.Z,{...e,featureName:(0,r.t)("Event Attachments")}),children:(0,I.tZ)(R,{projectSlug:s.project.slug})})};$.displayName="GroupEventAttachmentsContainer";const k=(0,a.Z)($)},"../node_modules/lodash/_baseDifference.js":(e,t,s)=>{var n=s("../node_modules/lodash/_SetCache.js"),o=s("../node_modules/lodash/_arrayIncludes.js"),r=s("../node_modules/lodash/_arrayIncludesWith.js"),a=s("../node_modules/lodash/_arrayMap.js"),i=s("../node_modules/lodash/_baseUnary.js"),d=s("../node_modules/lodash/_cacheHas.js");e.exports=function(e,t,s,l){var c=-1,p=o,m=!0,u=e.length,h=[],v=t.length;if(!u)return h;s&&(t=a(t,i(s))),l?(p=r,m=!1):t.length>=200&&(p=d,m=!1,t=new n(t));e:for(;++c<u;){var x=e[c],Z=null==s?x:s(x);if(x=l||0!==x?x:0,m&&Z==Z){for(var g=v;g--;)if(t[g]===Z)continue e;h.push(x)}else p(t,Z,l)||h.push(x)}return h}},"../node_modules/lodash/_baseXor.js":(e,t,s)=>{var n=s("../node_modules/lodash/_baseDifference.js"),o=s("../node_modules/lodash/_baseFlatten.js"),r=s("../node_modules/lodash/_baseUniq.js");e.exports=function(e,t,s){var a=e.length;if(a<2)return a?r(e[0]):[];for(var i=-1,d=Array(a);++i<a;)for(var l=e[i],c=-1;++c<a;)c!=i&&(d[i]=n(d[i]||l,e[c],t,s));return r(o(d,1),t,s)}},"../node_modules/lodash/xor.js":(e,t,s)=>{var n=s("../node_modules/lodash/_arrayFilter.js"),o=s("../node_modules/lodash/_baseRest.js"),r=s("../node_modules/lodash/_baseXor.js"),a=s("../node_modules/lodash/isArrayLikeObject.js"),i=o((function(e){return r(n(e,a))}));e.exports=i}}]);
//# sourceMappingURL=../sourcemaps/app_views_organizationGroupDetails_groupEventAttachments_index_tsx.747a2e39d6f15515e0fd8ec2b83017fd.js.map