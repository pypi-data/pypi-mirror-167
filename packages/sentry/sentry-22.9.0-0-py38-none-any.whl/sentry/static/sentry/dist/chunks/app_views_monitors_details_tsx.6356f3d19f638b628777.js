"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_monitors_details_tsx"],{"./app/views/monitors/details.tsx":(t,e,s)=>{s.r(e),s.d(e,{default:()=>Y});var o=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),r=s("./app/components/panels/index.tsx"),i=s("./app/locale.tsx"),a=s("./app/views/asyncView.tsx"),d=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),l=s("./app/components/asyncComponent.tsx"),c=s("./app/components/duration.tsx"),m=s("./app/components/timeSince.tsx"),p=s("./app/styles/space.tsx");const u=(0,d.Z)("div",{target:"ehlf75x0"})("display:inline-block;position:relative;border-radius:50%;height:",(t=>t.size),"px;width:",(t=>t.size),"px;",(t=>t.color?`background: ${t.color};`:`background: ${"error"===t.status?t.theme.error:"ok"===t.status?t.theme.success:t.theme.disabled};`),";");var h=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class Z extends l.Z{getEndpoints(){const{monitor:t}=this.props;return[["checkInList",`/monitors/${t.id}/checkins/`,{query:{per_page:10}}]]}renderError(){return(0,h.tZ)(b,{children:super.renderError()})}renderBody(){return(0,h.tZ)(r.N,{children:this.state.checkInList.map((t=>(0,h.BX)(r.Lv,{children:[(0,h.tZ)(x,{children:(0,h.tZ)(u,{status:t.status,size:16})}),(0,h.tZ)(v,{children:(0,h.tZ)(m.Z,{date:t.dateCreated})}),(0,h.tZ)(y,{children:t.duration&&(0,h.tZ)(c.Z,{seconds:t.duration/100})})]},t.id)))})}}const g=(0,d.Z)("div",{target:"e19bvxt54"})("margin-right:",(0,p.Z)(2),";"),x=(0,d.Z)(g,{target:"e19bvxt53"})({name:"s5xdrg",styles:"display:flex;align-items:center"}),v=(0,d.Z)(g,{target:"e19bvxt52"})({name:"kow0uz",styles:"font-variant-numeric:tabular-nums"}),y=(0,d.Z)("div",{target:"e19bvxt51"})({name:"kow0uz",styles:"font-variant-numeric:tabular-nums"}),b=(0,d.Z)("div",{target:"e19bvxt50"})("margin:",(0,p.Z)(3)," ",(0,p.Z)(3)," 0;");var k=s("../node_modules/react-router/es/index.js"),I=s("./app/actionCreators/indicator.tsx"),w=s("./app/components/button.tsx"),B=s("./app/components/buttonBar.tsx"),N=s("./app/components/confirm.tsx"),z=s("./app/icons/index.tsx"),$=s("../node_modules/@sentry/hub/esm/exports.js"),f=s("./app/utils/useApi.tsx");const E=t=>{let{monitor:e,orgId:s,onUpdate:o}=t;const n=(0,f.Z)();return(0,h.tZ)(_,{children:(0,h.BX)(B.ZP,{gap:1,children:[(0,h.BX)(w.ZP,{size:"sm",icon:(0,h.tZ)(z.yl,{size:"xs"}),to:`/organizations/${s}/monitors/${e.id}/edit/`,children:["Â ",(0,i.t)("Edit")]}),(0,h.tZ)(w.ZP,{size:"sm",onClick:()=>{return t={status:"disabled"===e.status?"active":"disabled"},(0,I.E3)(),void n.requestPromise(`/monitors/${e.id}/`,{method:"PUT",data:t}).then((t=>{(0,I.B8)(),null==o||o(t)})).catch((t=>{var e;e=t,$.$e((t=>{$.Tb(e)})),window.console&&console.error&&console.error(e),(0,I.Iw)((0,i.t)("Unable to update monitor."))}));var t},children:"disabled"!==e.status?(0,i.t)("Pause"):(0,i.t)("Enable")}),(0,h.tZ)(N.Z,{onConfirm:()=>{const t=`/organizations/${s}/monitors/`;(0,I.E3)((0,i.t)("Deleting Monitor...")),n.requestPromise(`/monitors/${e.id}/`,{method:"DELETE"}).then((()=>{k.browserHistory.push(t)})).catch((()=>{(0,I.Iw)((0,i.t)("Unable to remove monitor."))}))},message:(0,i.t)("Deleting this monitor is permanent. Are you sure you wish to continue?"),children:(0,h.tZ)(w.ZP,{size:"sm",icon:(0,h.tZ)(z.Fz,{size:"xs"}),children:(0,i.t)("Delete")})})]})})};E.displayName="MonitorHeaderActions";const _=(0,d.Z)("div",{target:"e11hcv560"})("margin-bottom:",(0,p.Z)(3),";display:flex;flex-shrink:1;"),C=E;var j=s("./app/views/monitors/monitorIcon.tsx");const q=t=>{let{monitor:e,orgId:s,onUpdate:o}=t;return(0,h.BX)("div",{className:"release-details",children:[(0,h.BX)("div",{className:"row",children:[(0,h.BX)("div",{className:"col-sm-6 col-xs-10",children:[(0,h.tZ)("h3",{children:e.name}),(0,h.tZ)("div",{className:"release-meta",children:e.id})]}),(0,h.BX)("div",{className:"col-sm-2 hidden-xs",children:[(0,h.tZ)("h6",{className:"nav-header",children:(0,i.t)("Last Check-in")}),e.lastCheckIn&&(0,h.tZ)(m.Z,{date:e.lastCheckIn})]}),(0,h.BX)("div",{className:"col-sm-2 hidden-xs",children:[(0,h.tZ)("h6",{className:"nav-header",children:(0,i.t)("Next Check-in")}),e.nextCheckIn&&(0,h.tZ)(m.Z,{date:e.nextCheckIn})]}),(0,h.BX)("div",{className:"col-sm-2",children:[(0,h.tZ)("h6",{className:"nav-header",children:(0,i.t)("Status")}),(0,h.tZ)(j.Z,{status:e.status,size:16})]})]}),(0,h.tZ)(C,{orgId:s,monitor:e,onUpdate:o})]})};q.displayName="MonitorHeader";const L=q;var X=s("./app/components/emptyMessage.tsx"),P=s("./app/components/issues/compactIssue.tsx"),T=s("./app/components/loadingError.tsx"),M=s("./app/components/loadingIndicator.tsx"),U=s("./app/components/pagination.tsx");function S(t){let{endpoint:e,emptyText:s,query:o,location:a,pagination:d,renderEmpty:l,noBorder:c,noMargin:m}=t;const u=(0,f.Z)(),[Z,g]=(0,n.useState)({issueIds:[],status:"loading",pageLinks:null,data:[]}),x=(0,n.useCallback)((()=>{var t;u.clear(),u.request(e,{method:"GET",query:{...o,...null!=a&&null!==(t=a.query)&&void 0!==t&&t.cursor?{cursor:a.query.cursor}:{}},success:(t,e,s)=>{var o;g({data:t,status:"success",issueIds:t.map((t=>t.id)),pageLinks:null!==(o=null==s?void 0:s.getResponseHeader("Link"))&&void 0!==o?o:null})},error:()=>{g((t=>({...t,status:"error"})))}})}),[o,e,a.query,u]),v=!!a;(0,n.useEffect)((()=>{v&&(g({issueIds:[],status:"loading",pageLinks:null,data:[]}),x())}),[x,v]);const y=(0,n.useMemo)((()=>({...c?{border:0,borderRadius:0}:{},...m?{marginBottom:0}:{}})),[c,m]);return(0,h.BX)(n.Fragment,{children:["loading"===Z.status?(0,h.tZ)("div",{style:{margin:"18px 18px 0"},children:(0,h.tZ)(M.Z,{})}):"error"===Z.status?(0,h.tZ)("div",{style:{margin:`${(0,p.Z)(2)} ${(0,p.Z)(2)} 0`},children:(0,h.tZ)(T.Z,{onRetry:x})}):Z.issueIds.length>0?(0,h.tZ)(r.s_,{style:y,children:(0,h.tZ)(r.N,{className:"issue-list",children:Z.data.map((t=>(0,h.tZ)(P.Z,{id:t.id,data:t},t.id)))})}):l?l():(0,h.tZ)(r.s_,{style:y,children:(0,h.tZ)(X.Z,{icon:(0,h.tZ)(z.jV,{size:"xl"}),children:null!=s?s:(0,i.t)("Nothing to show here, move along.")})}),d&&Z.pageLinks&&(0,h.tZ)(U.Z,{pageLinks:Z.pageLinks})]})}S.displayName="IssueList";const D=(0,k.withRouter)(S),R=t=>{let{orgId:e,monitor:s}=t;return(0,h.tZ)(D,{endpoint:`/organizations/${e}/issues/`,query:{query:'monitor.id:"'+s.id+'"',project:s.project.id,limit:5},pagination:!1,emptyText:(0,i.t)("No issues found"),noBorder:!0,noMargin:!0})};R.displayName="MonitorIssues";const A=R;var F=s("./app/components/charts/miniBarChart.tsx"),H=s("./app/utils/theme.tsx");class V extends l.Z{getEndpoints(){const{monitor:t}=this.props,e=Math.floor((new Date).getTime()/1e3),s=e-2592e3;return[["stats",`/monitors/${t.id}/stats/`,{query:{since:s,until:e,resolution:"1d"}}]]}renderBody(){var t;let e=!0;const s={seriesName:(0,i.t)("Successful"),data:[]},o={seriesName:(0,i.t)("Failed"),data:[]};null===(t=this.state.stats)||void 0===t||t.forEach((t=>{(t.ok||t.error)&&(e=!1);const n=1e3*t.ts;s.data.push({name:n.toString(),value:t.ok}),o.data.push({name:n.toString(),value:t.error})}));const n=[H.ZP.green300,H.ZP.red300];return(0,h.tZ)(r.s_,{children:(0,h.tZ)(r.N,{withPadding:!0,children:e?(0,h.tZ)(X.Z,{title:(0,i.t)("Nothing recorded in the last 30 days."),description:(0,i.t)("All check-ins for this monitor.")}):(0,h.tZ)(F.Z,{isGroupedByDate:!0,showTimeInTooltip:!0,labelYAxisExtents:!0,stacked:!0,colors:n,height:150,series:[s,o]})})})}}class G extends a.Z{constructor(){super(...arguments),(0,o.Z)(this,"onUpdate",(t=>this.setState((e=>({monitor:{...e.monitor,...t}})))))}getEndpoints(){const{params:t,location:e}=this.props;return[["monitor",`/monitors/${t.monitorId}/`,{query:e.query}]]}getTitle(){return this.state.monitor?`${this.state.monitor.name} - Monitors - ${this.props.params.orgId}`:`Monitors - ${this.props.params.orgId}`}renderBody(){const{monitor:t}=this.state;return null===t?null:(0,h.BX)(n.Fragment,{children:[(0,h.tZ)(L,{monitor:t,orgId:this.props.params.orgId,onUpdate:this.onUpdate}),(0,h.tZ)(V,{monitor:t}),(0,h.BX)(r.s_,{style:{paddingBottom:0},children:[(0,h.tZ)(r.V9,{children:(0,i.t)("Related Issues")}),(0,h.tZ)(A,{monitor:t,orgId:this.props.params.orgId})]}),(0,h.BX)(r.s_,{children:[(0,h.tZ)(r.V9,{children:(0,i.t)("Recent Check-ins")}),(0,h.tZ)(Z,{monitor:t})]})]})}}const Y=G},"./app/views/monitors/monitorIcon.tsx":(t,e,s)=>{s.d(e,{Z:()=>o});const o=(0,s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js").Z)("div",{target:"ezalhst0"})("display:inline-block;position:relative;border-radius:50%;height:",(t=>t.size),"px;width:",(t=>t.size),"px;",(t=>t.color?`background: ${t.color};`:`background: ${"error"===t.status?t.theme.error:"ok"===t.status?t.theme.success:t.theme.disabled};`),";")}}]);
//# sourceMappingURL=../sourcemaps/app_views_monitors_details_tsx.ec91071eb680d7ceed5f8ed21a55bd82.js.map