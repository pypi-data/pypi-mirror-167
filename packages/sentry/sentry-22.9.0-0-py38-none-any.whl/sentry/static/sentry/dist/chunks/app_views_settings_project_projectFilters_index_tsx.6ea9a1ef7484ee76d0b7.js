"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_settings_project_projectFilters_index_tsx"],{"./app/data/forms/inboundFilters.tsx":(e,t,s)=>{s.r(t),s.d(t,{customFilterFields:()=>h,default:()=>c,route:()=>o});var r=s("../node_modules/react/index.js"),i=s("./app/components/links/externalLink.tsx"),n=s("./app/locale.tsx"),a=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const o="/settings/:orgId/projects/:projectId/filters/",l=(0,n.t)("Separate multiple entries with a newline."),d=(0,n._N)("Allows [link:glob pattern matching].",{link:(0,a.tZ)(i.Z,{href:"https://en.wikipedia.org/wiki/Glob_(programming)"})}),p=e=>({options:e}),c=[{title:(0,n.t)("Custom Filters"),fields:[{name:"filters:blacklisted_ips",type:"string",multiline:!0,autosize:!0,rows:1,maxRows:10,placeholder:"e.g. 127.0.0.1 or 10.0.0.0/8",label:(0,n.t)("IP Addresses"),help:(0,a.BX)(r.Fragment,{children:[(0,n.t)("Filter events from these IP addresses. "),l]}),getData:p}]}],h=[{name:"filters:releases",type:"string",multiline:!0,autosize:!0,maxRows:10,rows:1,placeholder:"e.g. 1.* or [!3].[0-9].*",label:(0,n.t)("Releases"),help:(0,a.BX)(r.Fragment,{children:[(0,n.t)("Filter events from these releases. "),l," ",d]}),getData:p},{name:"filters:error_messages",type:"string",multiline:!0,autosize:!0,maxRows:10,rows:1,placeholder:"e.g. TypeError* or *: integer division or modulo by zero",label:(0,n.t)("Error Message"),help:(0,a.BX)(r.Fragment,{children:[(0,n.t)("Filter events by error messages. "),l," ",d]}),getData:p}]},"./app/utils/recreateRoute.tsx":(e,t,s)=>{s.d(t,{Z:()=>a});var r=s("../node_modules/lodash/findLastIndex.js"),i=s.n(r),n=s("./app/utils/replaceRouterParams.tsx");function a(e,t){var s,r;const{routes:a,params:o,location:l,stepBack:d}=t,p=a.map((e=>{let{path:t}=e;return t||""}));let c,h;"string"!=typeof e?(h=a.indexOf(e)+1,c=i()(p.slice(0,h),(e=>"/"===e[0]))):c=i()(p,(e=>"/"===e[0]));let m=p.slice(c,h);void 0!==d&&(m=m.slice(0,d));const u=null!==(s=null==l?void 0:l.search)&&void 0!==s?s:"",g=null!==(r=null==l?void 0:l.hash)&&void 0!==r?r:"",x=`${m.join("")}${"string"!=typeof e?"":e}${u}${g}`;return(0,n.Z)(x,o)}},"./app/views/settings/project/permissionAlert.tsx":(e,t,s)=>{s.d(t,{Z:()=>l});var r=s("./app/components/acl/access.tsx"),i=s("./app/components/alert.tsx"),n=s("./app/locale.tsx"),a=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const o=e=>{let{access:t=["project:write"],...s}=e;return(0,a.tZ)(r.Z,{access:t,children:e=>{let{hasAccess:t}=e;return!t&&(0,a.tZ)(i.Z,{type:"warning",...s,children:(0,n.t)("These settings can only be edited by users with the organization owner, manager, or admin role.")})}})};o.displayName="PermissionAlert";const l=o},"./app/views/settings/project/projectFilters/index.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>ge}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=s("../node_modules/react/index.js"),i=s("./app/components/links/link.tsx"),n=s("./app/components/navTabs.tsx"),a=s("./app/components/sentryDocumentTitle.tsx"),o=s("./app/locale.tsx"),l=s("./app/utils/recreateRoute.tsx"),d=s("./app/views/settings/components/settingsPageHeader.tsx"),p=s("./app/views/settings/components/text/textBlock.tsx"),c=s("./app/views/settings/project/permissionAlert.tsx"),h=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),m=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),u=s("./app/actionCreators/indicator.tsx"),g=s("./app/components/asyncComponent.tsx"),x=s("./app/components/avatar/index.tsx"),Z=s("./app/components/button.tsx"),f=s("./app/components/confirm.tsx"),b=s("./app/components/emptyMessage.tsx"),w=s("./app/components/eventOrGroupHeader.tsx"),y=s("./app/components/pagination.tsx"),v=s("./app/components/panels/index.tsx"),j=s("./app/icons/index.tsx"),k=s("./app/styles/space.tsx"),F=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function D(e){let{data:t,onUndiscard:s}=e;const r=t.actor;return(0,F.BX)(v.Lv,{center:!0,children:[(0,F.tZ)(_,{children:(0,F.tZ)(w.Z,{includeLink:!1,hideIcons:!0,className:"truncate",size:"normal",data:t})}),(0,F.tZ)(B,{children:r&&(0,F.tZ)(x.Z,{user:r,hasTooltip:!0,tooltip:(0,o.t)("Discarded by %s",r.name||r.email)})}),(0,F.tZ)(I,{children:(0,F.tZ)(f.Z,{message:(0,o.t)("Undiscarding this issue means that incoming events that match this will no longer be discarded. New incoming events will count toward your event quota and will display on your issues dashboard. Are you sure you wish to continue?"),onConfirm:()=>s(t.id),children:(0,F.tZ)(Z.ZP,{"aria-label":(0,o.t)("Undiscard"),title:(0,o.t)("Undiscard"),size:"xs",icon:(0,F.tZ)(j.Fz,{size:"xs"})})})})]})}D.displayName="GroupTombstoneRow";class S extends g.Z{constructor(){super(...arguments),(0,h.Z)(this,"handleUndiscard",(e=>{const{orgId:t,projectId:s}=this.props,r=`/projects/${t}/${s}/tombstones/${e}/`;this.api.requestPromise(r,{method:"DELETE"}).then((()=>{(0,u.S9)((0,o.t)("Events similar to these will no longer be filtered")),this.fetchData()})).catch((()=>{(0,u.Iw)((0,o.t)("We were unable to undiscard this issue")),this.fetchData()}))}))}getEndpoints(){const{orgId:e,projectId:t}=this.props;return[["tombstones",`/projects/${e}/${t}/tombstones/`,{},{paginate:!0}]]}renderEmpty(){return(0,F.tZ)(v.s_,{children:(0,F.tZ)(b.Z,{children:(0,o.t)("You have no discarded issues")})})}renderBody(){const{tombstones:e,tombstonesPageLinks:t}=this.state;return e.length?(0,F.BX)(r.Fragment,{children:[(0,F.tZ)(v.s_,{children:e.map((e=>(0,F.tZ)(D,{data:e,onUndiscard:this.handleUndiscard},e.id)))}),t&&(0,F.tZ)(y.Z,{pageLinks:t})]}):this.renderEmpty()}}const _=(0,m.Z)("div",{target:"eehuqin2"})({name:"mfxqnx",styles:"flex:1;align-items:center;min-width:0"}),B=(0,m.Z)("div",{target:"eehuqin1"})("margin:0 ",(0,k.Z)(3),";flex-shrink:1;align-items:center;"),I=(0,m.Z)("div",{target:"eehuqin0"})({name:"nq9fxm",styles:"flex-shrink:1;align-items:center"}),P=S;var T=s("./app/components/charts/miniBarChart.tsx"),C=s("./app/components/loadingError.tsx"),E=s("./app/components/placeholder.tsx"),z=s("./app/utils/theme.tsx"),N=s("./app/utils/withApi.tsx");const X={"browser-extensions":{title:(0,o.t)("Browser Extension"),color:z.ZP.gray200},cors:{title:"CORS",color:z.ZP.yellow300},"error-message":{title:(0,o.t)("Error Message"),color:z.ZP.purple300},"discarded-hash":{title:(0,o.t)("Discarded Issue"),color:z.ZP.gray200},"invalid-csp":{title:(0,o.t)("Invalid CSP"),color:z.ZP.blue300},"ip-address":{title:(0,o.t)("IP Address"),color:z.ZP.red200},"legacy-browsers":{title:(0,o.t)("Legacy Browser"),color:z.ZP.gray200},localhost:{title:(0,o.t)("Localhost"),color:z.ZP.blue300},"release-version":{title:(0,o.t)("Release"),color:z.ZP.purple200},"web-crawlers":{title:(0,o.t)("Web Crawler"),color:z.ZP.red300}};class $ extends r.Component{constructor(){super(...arguments),(0,h.Z)(this,"state",{loading:!0,error:!1,statsError:!1,formattedData:[],blankStats:!0}),(0,h.Z)(this,"fetchData",(()=>{this.getFilterStats()}))}componentDidMount(){this.fetchData()}componentDidUpdate(e){e.project!==this.props.project&&this.fetchData()}formatData(e){const t=new Set,s=Object.keys(X).map((s=>({data:e[s].map((e=>{let[r,i]=e;return i>0&&(t.add(X[s].title),this.setState({blankStats:!1})),{name:1e3*r,value:i}})),seriesName:X[s].title,color:X[s].color})));return s.filter((e=>t.has(e.seriesName)))}getFilterStats(){const e=Object.keys(X),{project:t}=this.props,{orgId:s}=this.props.params,r=Math.floor((new Date).getTime()/1e3),i=r-2592e3,n=`/projects/${s}/${t.slug}/stats/`,a={since:i,until:r,resolution:"1d"},o=e.map((e=>this.props.api.requestPromise(n,{query:Object.assign({stat:e},a)})));Promise.all(o).then((t=>{const s={};for(let r=0;r<e.length;r++)s[e[r]]=t[r];this.setState({formattedData:this.formatData(s),error:!1,loading:!1})})).catch((()=>{this.setState({error:!0,loading:!1})}))}render(){const{loading:e,error:t,formattedData:s}=this.state,r=e||!s,i=!r&&t,n=!r&&!t,a=s?s.map((e=>e.color||z.ZP.gray200)):void 0;return(0,F.BX)(v.s_,{children:[(0,F.tZ)(v.V9,{children:(0,o.t)("Errors filtered in the last 30 days (by day)")}),(0,F.BX)(v.N,{withPadding:!0,children:[r&&(0,F.tZ)(E.Z,{height:"100px"}),i&&(0,F.tZ)(C.Z,{onRetry:this.fetchData}),n&&!this.state.blankStats&&(0,F.tZ)(T.Z,{series:s,colors:a,height:100,isGroupedByDate:!0,stacked:!0,labelYAxisExtents:!0}),n&&this.state.blankStats&&(0,F.tZ)(b.Z,{title:(0,o.t)("Nothing filtered in the last 30 days."),description:(0,o.t)("Issues filtered as a result of your settings below will be shown here.")})]})]})}}$.displayName="ProjectFiltersChart";const A=(0,N.Z)($);var L=s("./app/actions/projectActions.tsx"),R=s("./app/components/acl/access.tsx"),U=s("./app/components/acl/feature.tsx"),q=s("./app/components/acl/featureDisabled.tsx"),O=s("./app/components/forms/fieldFromConfig.tsx"),M=s("./app/components/forms/form.tsx"),V=s("./app/components/forms/formField/index.tsx"),G=s("./app/components/forms/jsonForm.tsx"),H=s("./app/components/switchButton.tsx"),W=s("./app/data/forms/inboundFilters.tsx"),Y=s("./app/stores/hookStore.tsx");const J={ie_pre_9:{icon:"internet-explorer",helpText:"Version 8 and lower",title:"Internet Explorer"},ie9:{icon:"internet-explorer",helpText:"Version 9",title:"Internet Explorer"},ie10:{icon:"internet-explorer",helpText:"Version 10",title:"Internet Explorer"},ie11:{icon:"internet-explorer",helpText:"Version 11",title:"Internet Explorer"},safari_pre_6:{icon:"safari",helpText:"Version 5 and lower",title:"Safari"},opera_pre_15:{icon:"opera",helpText:"Version 14 and lower",title:"Opera"},opera_mini_pre_8:{icon:"opera",helpText:"Version 8 and lower",title:"Opera Mini"},android_pre_4:{icon:"android",helpText:"Version 3 and lower",title:"Android"}},K=Object.keys(J);var Q={name:"nb8u23",styles:"flex-shrink:0;margin-left:6px"};class ee extends r.Component{constructor(e){let t;super(e),(0,h.Z)(this,"handleToggleSubfilters",((e,t)=>{let{subfilters:s}=this.state;!0===e?s=new Set(K):!1===e?s=new Set:s.has(e)?s.delete(e):s.add(e),this.setState({subfilters:new Set(s)},(()=>{this.props.onToggle(this.props.data,s,t)}))})),t=!0===e.data.active?new Set(K):!1===e.data.active?new Set:new Set(e.data.active),this.state={loading:!1,error:!1,subfilters:t}}render(){const{disabled:e}=this.props;return(0,F.BX)("div",{children:[!e&&(0,F.BX)(ce,{children:[(0,F.BX)(he,{children:[(0,o.t)("Filter"),":"]}),(0,F.tZ)(me,{onClick:this.handleToggleSubfilters.bind(this,!0),children:(0,o.t)("All")}),(0,F.tZ)(me,{onClick:this.handleToggleSubfilters.bind(this,!1),children:(0,o.t)("None")})]}),(0,F.tZ)(ie,{children:K.map((t=>{const s=J[t];return(0,F.tZ)(ae,{children:(0,F.BX)(ne,{children:[(0,F.BX)(oe,{children:[(0,F.tZ)(le,{className:`icon-${s.icon}`}),(0,F.BX)("div",{children:[(0,F.tZ)(de,{children:s.title}),(0,F.tZ)(pe,{children:s.helpText})]})]}),(0,F.tZ)(H.Z,{isActive:this.state.subfilters.has(t),isDisabled:e,css:Q,toggle:this.handleToggleSubfilters.bind(this,t),size:"lg"})]})},t)}))})]})}}ee.displayName="LegacyBrowserFilterRow";class te extends g.Z{constructor(){super(...arguments),(0,h.Z)(this,"handleLegacyChange",((e,t,s,r,i)=>{null==e||e(r,i),null==t||t(r,i)})),(0,h.Z)(this,"handleSubmit",(e=>{L.Z.updateSuccess(e)})),(0,h.Z)(this,"renderDisabledCustomFilters",(e=>(0,F.tZ)(q.Z,{featureName:(0,o.t)("Custom Inbound Filters"),features:e.features,alert:v.aU,message:(0,o.t)("Release and Error Message filtering are not enabled on your Sentry installation")}))),(0,h.Z)(this,"renderCustomFilters",(e=>()=>(0,F.tZ)(U.Z,{features:["projects:custom-inbound-filters"],hookName:"feature-disabled:custom-inbound-filters",renderDisabled:e=>{let{children:t,...s}=e;return"function"==typeof t?t({...s,renderDisabled:this.renderDisabledCustomFilters}):null},children:t=>{var s;let{hasFeature:i,organization:n,renderDisabled:a,...l}=t;return(0,F.BX)(r.Fragment,{children:[!i&&"function"==typeof a&&a({organization:n,hasFeature:i,children:null,...l}),W.customFilterFields.map((t=>(0,F.tZ)(O.Z,{field:t,disabled:e||!i},t.name))),i&&(null===(s=this.props.project.options)||void 0===s?void 0:s["filters:error_messages"])&&(0,F.tZ)(v.aU,{type:"warning","data-test-id":"error-message-disclaimer",children:(0,o.t)("Minidumps, errors in the minified production build of React, and Internet Explorer's i18n errors cannot be filtered by message.")})]})}})))}getDefaultState(){return{...super.getDefaultState(),hooksDisabled:Y.Z.get("feature-disabled:custom-inbound-filters")}}getEndpoints(){const{orgId:e,projectId:t}=this.props.params;return[["filterList",`/projects/${e}/${t}/filters/`]]}componentDidUpdate(e,t){e.project.slug!==this.props.project.slug&&this.reloadData(),super.componentDidUpdate(e,t)}renderBody(){const{features:e,params:t,project:s}=this.props,{orgId:i,projectId:n}=t,a=`/projects/${i}/${n}/`,l=`${a}filters/`;return(0,F.tZ)(R.Z,{access:["project:write"],children:t=>{let{hasAccess:i}=t;return(0,F.BX)(r.Fragment,{children:[(0,F.BX)(v.s_,{children:[(0,F.tZ)(v.V9,{children:(0,o.t)("Filters")}),(0,F.tZ)(v.N,{children:this.state.filterList.map((e=>{const t={name:e.id,label:e.name,help:e.description,disabled:!i};return(0,F.tZ)(v.Lv,{noPadding:!0,children:(0,F.tZ)(re,{apiMethod:"PUT",apiEndpoint:`${l}${e.id}/`,initialData:{[e.id]:e.active},saveOnBlur:!0,children:"legacy-browsers"!==e.id?(0,F.tZ)(O.Z,{getData:t=>({active:t[e.id]}),field:{type:"boolean",...t}},e.id):(0,F.tZ)(V.Z,{inline:!1,...t,getData:t=>({subfilters:[...t[e.id]]}),children:t=>{let{onChange:s,onBlur:r}=t;return(0,F.tZ)(ee,{data:e,disabled:!i,onToggle:this.handleLegacyChange.bind(this,s,r)},e.id)}})})},e.id)}))})]}),(0,F.tZ)(M.Z,{apiMethod:"PUT",apiEndpoint:a,initialData:s.options,saveOnBlur:!0,onSubmitSuccess:this.handleSubmit,children:(0,F.tZ)(G.Z,{features:e,forms:W.default,disabled:!i,renderFooter:this.renderCustomFilters(!i)})})]})}})}}const se=te,re=(0,m.Z)(M.Z,{target:"eawr7uk10"})({name:"82a6rk",styles:"flex:1"}),ie=(0,m.Z)("div",{target:"eawr7uk9"})({name:"5kov97",styles:"display:flex;flex-wrap:wrap"}),ne=(0,m.Z)("div",{target:"eawr7uk8"})("display:flex;align-items:center;background:",(e=>e.theme.backgroundSecondary),";border-radius:3px;flex:1;padding:12px;height:100%;"),ae=(0,m.Z)("div",{target:"eawr7uk7"})({name:"1516fzb",styles:"padding:12px;width:50%"}),oe=(0,m.Z)("div",{target:"eawr7uk6"})({name:"zol16h",styles:"display:flex;flex:1;align-items:center"}),le=(0,m.Z)("div",{target:"eawr7uk5"})({name:"1onzlav",styles:"width:38px;height:38px;background-repeat:no-repeat;background-position:center;background-size:38px 38px;margin-right:6px;flex-shrink:0"}),de=(0,m.Z)("div",{target:"eawr7uk4"})({name:"19au3w7",styles:"font-size:14px;font-weight:bold;line-height:1;white-space:nowrap"}),pe=(0,m.Z)("div",{target:"eawr7uk3"})("color:",(e=>e.theme.subText),";font-size:12px;line-height:1;white-space:nowrap;"),ce=(0,m.Z)("div",{target:"eawr7uk2"})({name:"fq0hzo",styles:"text-align:right;padding:0 12px"}),he=(0,m.Z)("span",{target:"eawr7uk1"})({name:"akdn31",styles:"font-weight:bold;margin-right:6px"}),me=(0,m.Z)("a",{target:"eawr7uk0"})({name:"ahpk6n",styles:"border-right:1px solid #f1f2f3;margin-right:6px;padding-right:6px;&:last-child{border-right:none;margin-right:0;}"});function ue(e){const{project:t,params:s,location:h}=e,{orgId:m,projectId:u,filterType:g}=s;if(!t)return null;const x=new Set(t.features);return(0,F.BX)(r.Fragment,{children:[(0,F.tZ)(a.Z,{title:(0,o.t)("Inbound Filters"),projectSlug:u}),(0,F.tZ)(d.Z,{title:(0,o.t)("Inbound Data Filters")}),(0,F.tZ)(c.Z,{}),(0,F.tZ)(p.Z,{children:(0,o.t)("Filters allow you to prevent Sentry from storing events in certain situations. Filtered events are tracked separately from rate limits, and do not apply to any project quotas.")}),(0,F.BX)("div",{children:[(0,F.tZ)(A,{project:t,params:s}),x.has("discard-groups")&&(0,F.BX)(n.Z,{underlined:!0,style:{paddingTop:"30px"},children:[(0,F.tZ)("li",{className:"data-filters"===g?"active":"",children:(0,F.tZ)(i.Z,{to:(0,l.Z)("data-filters/",{...e,stepBack:-1}),children:(0,o.t)("Data Filters")})}),(0,F.tZ)("li",{className:"discarded-groups"===g?"active":"",children:(0,F.tZ)(i.Z,{to:(0,l.Z)("discarded-groups/",{...e,stepBack:-1}),children:(0,o.t)("Discarded Issues")})})]}),"discarded-groups"===g?(0,F.tZ)(P,{orgId:m,projectId:t.slug,location:h}):(0,F.tZ)(se,{project:t,params:s,features:x})]})]})}ue.displayName="ProjectFilters";const ge=ue}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_project_projectFilters_index_tsx.122e1a57a21a59c949456b0ea1c3a305.js.map