(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_organizationStats_teamInsights_health_tsx-node_modules_lodash_maxBy_js-node_modules-ed2a57","node_modules_lodash_maxBy_js"],{"./app/utils/discover/discoverQuery.tsx":(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var n=r("./app/utils/withApi.tsx"),s=r("./app/utils/discover/genericDiscoverQuery.tsx"),o=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function i(e,t){return e.transactionName!==t.transactionName||e.transactionThreshold!==t.transactionThreshold||e.transactionThresholdMetric!==t.transactionThresholdMetric}function a(e){const t=e.useEvents?"events":"eventsv2",r=e.useEvents?(e,t)=>{var r;const{fields:n,...s}=null!==(r=e.meta)&&void 0!==r?r:{};return{...e,meta:{...n,...s}}}:void 0;return(0,o.tZ)(s.ZP,{route:t,shouldRefetchData:i,afterFetch:r,...e})}a.displayName="DiscoverQuery";const l=(0,n.Z)(a)},"./app/utils/discover/genericDiscoverQuery.tsx":(e,t,r)=>{"use strict";r.d(t,{AA:()=>h,ZP:()=>m,o:()=>u});var n=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=(r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("../node_modules/core-js/modules/es.error.cause.js"),r("../node_modules/react/index.js")),o=r("./app/locale.tsx"),i=r("./app/utils/discover/eventView.tsx"),a=r("./app/utils/performance/contexts/performanceEventViewContext.tsx"),l=r("./app/views/organizationContext.tsx"),d=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class u{constructor(e,t){(0,n.Z)(this,"message",void 0),(0,n.Z)(this,"originalError",void 0),this.message=e,this.originalError=t}getOriginalError(){return this.originalError}}class c extends s.Component{constructor(){super(...arguments),(0,n.Z)(this,"state",{isLoading:!0,tableFetchID:void 0,error:null,tableData:null,pageLinks:null}),(0,n.Z)(this,"_shouldRefetchData",(e=>{const t=this.getPayload(this.props),r=this.getPayload(e);return!(0,i.ze)(t,r)||e.limit!==this.props.limit||e.route!==this.props.route||e.cursor!==this.props.cursor})),(0,n.Z)(this,"_parseError",(e=>{var t;if(this.props.parseError)return this.props.parseError(e);if(!e)return null;const r=null===(t=e.responseJSON)||void 0===t?void 0:t.detail;if("string"==typeof r)return new u(r,e);const n=null==r?void 0:r.message;return new u("string"==typeof n?n:(0,o.t)("An unknown error occurred."),e)})),(0,n.Z)(this,"fetchData",(async()=>{const{api:e,queryBatching:t,beforeFetch:r,afterFetch:n,didFetch:s,eventView:o,orgSlug:i,route:a,setError:l}=this.props;if(!o.isValid())return;const d=`/organizations/${i}/${a}/`,u=Symbol("tableFetchID"),c=this.getPayload(this.props);this.setState({isLoading:!0,tableFetchID:u}),null==l||l(void 0),null==r||r(e),e.clear();try{const[r,,o]=await h(e,d,c,t);if(this.state.tableFetchID!==u)return;const i=n?n(r,this.props):r;null==s||s(i),this.setState((e=>{var t;return{isLoading:!1,tableFetchID:void 0,error:null,pageLinks:null!==(t=null==o?void 0:o.getResponseHeader("Link"))&&void 0!==t?t:e.pageLinks,tableData:i}}))}catch(e){const t=this._parseError(e);this.setState({isLoading:!1,tableFetchID:void 0,error:t,tableData:null}),l&&l(null!=t?t:void 0)}}))}componentDidMount(){this.fetchData()}componentDidUpdate(e){const t=this._shouldRefetchData(e),r=!1===e.eventView.isValid()&&this.props.eventView.isValid(),n=!!this.props.shouldRefetchData&&this.props.shouldRefetchData(e,this.props);(t||r||n)&&this.fetchData()}getPayload(e){var t;const{cursor:r,limit:n,noPagination:s,referrer:o}=e,i=this.props.getRequestPayload?this.props.getRequestPayload(e):e.eventView.getEventsAPIPayload(e.location,e.forceAppendRawQueryString);return r&&(i.cursor=r),n&&(i.per_page=n),s&&(i.noPagination=s),o&&(i.referrer=o),Object.assign(i,null!==(t=e.queryExtras)&&void 0!==t?t:{}),i}render(){const{isLoading:e,error:t,tableData:r,pageLinks:n}=this.state,s={isLoading:e,error:t,tableData:r,pageLinks:n},o=this.props.children;return null==o?void 0:o(s)}}function p(e){var t,r,n,o;const i=null===(t=(0,s.useContext)(l.g))||void 0===t?void 0:t.slug,u=null===(r=(0,s.useContext)(a.uL))||void 0===r?void 0:r.eventView,p=null!==(n=e.orgSlug)&&void 0!==n?n:i,h=null!==(o=e.eventView)&&void 0!==o?o:u;if(void 0===p||void 0===h)throw new Error("GenericDiscoverQuery requires both an orgSlug and eventView");const m={...e,orgSlug:p,eventView:h};return(0,d.tZ)(c,{...m})}function h(e,t,r,n){return null!=n&&n.batchRequest?n.batchRequest(e,t,{query:r,includeAllArgs:!0}):e.requestPromise(t,{method:"GET",includeAllArgs:!0,query:{...r}})}c.displayName="_GenericDiscoverQuery",p.displayName="GenericDiscoverQuery";const m=p},"./app/utils/performance/contexts/performanceEventViewContext.tsx":(e,t,r)=>{"use strict";r.d(t,{bq:()=>s,uL:()=>i}),r("../node_modules/core-js/modules/web.dom-collections.iterator.js");var n=r("./app/utils/performance/contexts/utils.tsx");const[s,o,i]=(0,n.n)({name:"PerformanceEventViewContext"})},"./app/utils/performance/contexts/utils.tsx":(e,t,r)=>{"use strict";r.d(t,{n:()=>s}),r("../node_modules/core-js/modules/es.error.cause.js");var n=r("../node_modules/react/index.js");function s(e){const{strict:t=!0,errorMessage:r=`useContext for "${e.name}" must be inside a Provider with a value`,name:s}=e,o=(0,n.createContext)(void 0);return o.displayName=s,[o.Provider,function(){const e=(0,n.useContext)(o);if(!e&&t)throw new Error(r);return e},o]}},"./app/utils/performance/quickTrace/utils.tsx":(e,t,r)=>{"use strict";r.d(t,{$J:()=>y,Ci:()=>j,R8:()=>g,S2:()=>x,_Z:()=>Z,eF:()=>f,eW:()=>h,hp:()=>c,q2:()=>p,xB:()=>w,y3:()=>b}),r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("../node_modules/core-js/modules/es.error.cause.js");var n=r("../node_modules/lodash/omit.js"),s=r.n(n),o=r("../node_modules/moment-timezone/index.js"),i=r.n(o),a=r("./app/components/events/interfaces/spans/utils.tsx"),l=r("./app/constants/pageFilters.tsx"),d=r("./app/utils/analytics.tsx"),u=r("./app/utils/discover/eventView.tsx");function c(e){return"transaction"===e.type}function p(e,t){return c(t)?e.event_id===t.id:void 0!==e.errors&&e.errors.some((e=>e.event_id===t.id))}function h(e,t){const r=[],n=[],s=[{event:t,path:[]}];for(;s.length;){const t=s.shift();if(p(t.event,e)){for(const e of t.path)r.push(e);n.push(t.event)}else{const e=[...t.path,m(t.event)];for(const r of t.event.children)s.push({event:r,path:e})}}if(!n.length)throw new Error("No relevant path exists!");for(;n.length;){const e=n.shift();for(const t of e.children)n.push(t);r.push(m(e))}return r}function m(e){return s()(e,["children"])}function g(e,t,r){var n,s,o;const{type:i,trace:a}=e;if("empty"===i||null===a)throw new Error("Current event not in trace navigator!");const l="full"===i,u=null!==(n=a.find((e=>p(e,t))))&&void 0!==n?n:null;if(null===u)throw new Error("Current event not in trace navigator!");const c=u.parent_event_id&&null!==(s=a.find((e=>e.event_id===u.parent_event_id)))&&void 0!==s?s:null,h=null!==(o=a.find((e=>e.event_id!==u.event_id&&e.event_id!==(null==c?void 0:c.event_id)&&0===e.generation)))&&void 0!==o?o:null,m=l?[]:null,g=[],f=l?[]:null,Z=new Set;return a.forEach((e=>{Z.add(e.project_id),(e=>e.parent_event_id===u.event_id)(e)?g.push(e):l&&((e=>null!==u.generation&&null!==e.generation&&e.generation>0&&u.generation-1>e.generation)(e)?null==m||m.push(e):(e=>null!==u.generation&&null!==e.generation&&u.generation+1<e.generation)(e)&&(null==f||f.push(e)))})),l&&Z.size>1&&function(e,t){(0,d.ec)({eventKey:"quick_trace.connected_services",eventName:"Quick Trace: Connected Services",organization_id:parseInt(e.id,10),projects:t})}(r,Z.size),{root:h,ancestors:null===m?null:v(m),parent:c,current:u,children:v(g),descendants:null===f?null:v(f)}}function v(e){return e.sort(((e,t)=>t["transaction.duration"]-e["transaction.duration"]))}function f(e){let{eventView:t,location:r}=e;return s()(t.getEventsAPIPayload(r),["field","sort","per_page"])}function Z(e){let{start:t,end:r,statsPeriod:n}=e;return u.ZP.fromSavedQuery({id:void 0,version:2,name:"",fields:["transaction.duration"],projects:[l.mP],query:"",environment:[],start:t,end:r,range:null!=n?n:void 0})}function y(e){const t=c(e)?e.startTimestamp:i()(e.dateReceived?e.dateReceived:e.dateCreated).valueOf()/1e3,r=c(e)?e.endTimestamp:t;return(0,a.TC)({start:t,end:r})}function x(e,t,r){let n=r;const s=[e];for(;s.length;){const e=s.pop();for(const t of e.children)s.push(t);n=t(n,e)}return n}function w(e,t){return x(e,((e,r)=>(t(r)&&e.push(r),e)),[])}function b(e){return Boolean(e.event_id)}function j(e){return Boolean(e.event_id)}},"./app/views/organizationStats/teamInsights/health.tsx":(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>Re});var n=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),s=r("../node_modules/react/index.js"),o=r("./app/components/layouts/thirds.tsx"),i=r("./app/components/loadingIndicator.tsx"),a=r("./app/components/noProjectMessage.tsx"),l=r("./app/components/sentryDocumentTitle.tsx"),d=r("./app/locale.tsx"),u=r("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),c=r("./app/utils/localStorage.tsx"),p=r("./app/utils/useOrganization.tsx"),h=r("./app/utils/useTeams.tsx"),m=r("./app/views/organizationStats/header.tsx"),g=r("./app/views/organizationStats/teamInsights/controls.tsx"),v=r("./app/views/organizationStats/teamInsights/descriptionCard.tsx"),f=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),Z=(r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js")),y=r("../node_modules/lodash/round.js"),x=r.n(y),w=r("./app/components/asyncComponent.tsx"),b=r("./app/components/button.tsx"),j=r("./app/components/charts/barChart.tsx"),_=r("./app/components/links/link.tsx"),S=r("./app/components/organizations/pageFilters/parse.tsx"),T=r("./app/components/panels/panelTable.tsx"),z=r("./app/icons/index.tsx"),E=r("./app/styles/space.tsx"),D=r("./app/utils/formatters.tsx"),q=r("./app/views/organizationStats/teamInsights/styles.tsx"),k=r("./app/views/organizationStats/teamInsights/utils.tsx"),P=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class M extends w.Z{constructor(){super(...arguments),(0,f.Z)(this,"shouldRenderBadRequests",!0)}getDefaultState(){return{...super.getDefaultState(),alertsTriggered:null,alertsTriggeredRules:null}}getEndpoints(){const{organization:e,start:t,end:r,period:n,utc:s,teamSlug:o}=this.props,i={start:t,end:r,period:n,utc:s};return[["alertsTriggered",`/teams/${e.slug}/${o}/alerts-triggered/`,{query:{...(0,S.fK)(i)}}],["alertsTriggeredRules",`/teams/${e.slug}/${o}/alerts-triggered-index/`,{query:{...(0,S.fK)(i)}}]]}componentDidUpdate(e){const{start:t,end:r,period:n,utc:s,teamSlug:o}=this.props;e.start===t&&e.end===r&&e.period===n&&e.utc===s&&e.teamSlug===o||this.remountComponent()}renderTrend(e){const{weeklyAvg:t,totalThisWeek:r}=e,n=r-t;return 0===t?"—":(0,P.BX)(I,{color:n<=0?"green300":"red300",children:[(0,D.rl)(Math.abs(n/t),0),(0,P.tZ)(L,{direction:n<=0?"down":"up",size:"xs"})]})}renderLoading(){return(0,P.tZ)(N,{children:(0,P.tZ)(i.Z,{})})}renderBody(){const{organization:e,period:t,projects:r}=this.props,{alertsTriggered:n,alertsTriggeredRules:o}=this.state,i=(0,k.Gs)((0,k.E7)(null!=n?n:{}));return(0,P.BX)(s.Fragment,{children:[(0,P.tZ)(N,{children:(0,P.tZ)(j.v,{style:{height:190},isGroupedByDate:!0,useShortDate:!0,period:"7d",legend:{right:0,top:0},yAxis:{minInterval:1},xAxis:(0,k.tP)(i.length),series:[{seriesName:(0,d.t)("Alerts Triggered"),data:i,silent:!0,barCategoryGap:"5%"}]})}),(0,P.tZ)(C,{isEmpty:!n||!o||0===o.length,emptyMessage:(0,d.t)("No alerts triggered for this team’s projects"),emptyAction:(0,P.BX)($,{children:[(0,P.tZ)(b.ZP,{priority:"primary",size:"sm",to:`/organizations/${e.slug}/alerts/rules/`,children:(0,d.t)("Create Alert")}),(0,P.tZ)(b.ZP,{size:"sm",external:!0,to:"https://docs.sentry.io/product/alerts/create-alerts/",children:(0,d.t)("Learn more")})]}),headers:[(0,d.t)("Alert Rule"),(0,d.t)("Project"),(0,P.tZ)(B,{children:(0,d._N)("Last [period] Average",{period:t})},"last"),(0,P.tZ)(B,{children:(0,d.t)("This Week")},"curr"),(0,P.tZ)(B,{children:(0,d.t)("Difference")},"diff")],children:null==o?void 0:o.map((t=>{const n=r.find((e=>e.slug===t.projects[0]));return(0,P.BX)(s.Fragment,{children:[(0,P.tZ)(A,{children:(0,P.tZ)(_.Z,{to:`/organizations/${e.slug}/alerts/rules/details/${t.id}/`,children:t.name})}),(0,P.tZ)(q.R,{children:n&&(0,P.tZ)(q.W,{avatarSize:18,project:n})}),(0,P.tZ)(B,{children:x()(t.weeklyAvg,2)}),(0,P.tZ)(B,{children:t.totalThisWeek}),(0,P.tZ)(B,{children:this.renderTrend(t)})]},t.id)}))})]})}}const R=M,N=(0,n.Z)("div",{target:"e1w90l1w6"})("padding:",(0,E.Z)(2)," ",(0,E.Z)(2)," 0 ",(0,E.Z)(2),";border-bottom:1px solid ",(e=>e.theme.border),";"),C=(0,n.Z)(T.Z,{target:"e1w90l1w5"})("grid-template-columns:1fr 0.5fr 0.2fr 0.2fr 0.2fr;font-size:",(e=>e.theme.fontSizeMedium),";white-space:nowrap;margin-bottom:0;border:0;box-shadow:unset;&>div{padding:",(0,E.Z)(1)," ",(0,E.Z)(2),";}",(e=>e.isEmpty&&(0,Z.iv)("&>div:last-child{padding:48px ",(0,E.Z)(2),";}","")),";"),A=(0,n.Z)("div",{target:"e1w90l1w4"})((e=>e.theme.overflowEllipsis),";"),B=(0,n.Z)("div",{target:"e1w90l1w3"})({name:"mnwtso",styles:"text-align:right;font-variant-numeric:tabular-nums"}),L=(0,n.Z)(z.CC,{target:"e1w90l1w2"})("margin:0 ",(0,E.Z)(.5),";"),I=(0,n.Z)("div",{target:"e1w90l1w1"})("color:",(e=>e.theme[e.color]),";"),$=(0,n.Z)("div",{target:"e1w90l1w0"})("&>a{margin-right:",(0,E.Z)(.5),";margin-left:",(0,E.Z)(.5),";}");var F=r("./app/components/collapsePanel.tsx"),V=r("./app/components/loadingError.tsx"),G=r("./app/utils/discover/discoverQuery.tsx"),X=r("./app/utils/discover/eventView.tsx"),Q=r("./app/utils/discover/fieldRenderers.tsx"),W=r("./app/views/performance/transactionSummary/utils.tsx");function O(e){var t;let{organization:r,location:n,projects:o,periodTableData:i,weekTableData:a,isLoading:l,period:u,error:c}=e;const p=(null==i?void 0:i.meta)&&(0,Q.Js)("user_misery()",i.meta,!1),h=(null!==(t=null==i?void 0:i.data)&&void 0!==t?t:[]).map((e=>{const t=null==a?void 0:a.data.find((t=>t.project===e.project&&t.transaction===e.transaction)),r=t?100*(e["user_misery()"]-t["user_misery()"]):null;return{...e,trend:r}})).filter((e=>null!==e.trend)).sort(((e,t)=>Math.abs(t.trend)-Math.abs(e.trend))),m=(0,k.NW)(h);return c?(0,P.tZ)(V.Z,{}):(0,P.tZ)(F.Z,{items:m.length,children:e=>{let{isExpanded:t,showMoreButton:c}=e;return(0,P.BX)(s.Fragment,{children:[(0,P.tZ)(H,{isEmpty:0===o.length||0===(null==i?void 0:i.data.length),emptyMessage:(0,d.t)("No key transactions starred by this team"),emptyAction:(0,P.tZ)(b.ZP,{size:"sm",external:!0,href:"https://docs.sentry.io/product/performance/transaction-summary/#starring-key-transactions",children:(0,d.t)("Learn More")}),headers:[(0,P.BX)(J,{children:[(0,P.tZ)(ee,{isSolid:!0,color:"yellow300"})," ",(0,d.t)("Key transaction")]},"transaction"),(0,d.t)("Project"),(0,d._N)("Last [period]",{period:u}),(0,d.t)("Last 7 Days"),(0,P.tZ)(re,{children:(0,d.t)("Change")},"change")],isLoading:l,children:m.map(((e,i)=>{const l=o.find((t=>{let{slug:r}=t;return e.project===r})),{trend:u,project:c,transaction:h}=e,m=null==a?void 0:a.data.find((e=>e.project===c&&e.transaction===h));if(!m||null===u)return null;const g=null==p?void 0:p(e,{organization:r,location:n}),v=m&&(null==p?void 0:p(m,{organization:r,location:n})),f=Math.round(Math.abs(u));return i>=F.$&&!t?null:(0,P.BX)(s.Fragment,{children:[(0,P.BX)(Y,{children:[(0,P.tZ)("div",{children:(0,P.tZ)(ee,{isSolid:!0,color:"yellow300"})}),(0,P.tZ)(te,{children:(0,P.tZ)(_.Z,{to:(0,W.e1)({orgSlug:r.slug,transaction:e.transaction,projectID:null==l?void 0:l.id,query:{query:"transaction.duration:<15m"}}),children:e.transaction})})]}),(0,P.tZ)(J,{children:(0,P.tZ)(q.R,{children:l&&(0,P.tZ)(q.W,{avatarSize:18,project:l})})}),(0,P.tZ)(J,{children:g}),(0,P.tZ)(J,{children:null!=v?v:"—"}),(0,P.tZ)(ne,{children:0===f?(0,P.BX)(se,{children:["0% ",(0,d.t)("change")]}):(0,P.BX)(oe,{color:u>=0?"green300":"red300",children:[`${f}% `,u>=0?(0,d.t)("better"):(0,d.t)("worse")]})})]},i)}))}),!l&&c]})}})}function K(e){let{organization:t,teamId:r,projects:n,location:s,period:o,start:i,end:a}=e;if(0===n.length)return(0,P.tZ)(O,{isLoading:!1,organization:t,location:s,projects:[],period:o,periodTableData:{data:[]},weekTableData:{data:[]}});const l={id:void 0,query:"transaction.duration:<15m team_key_transaction:true",projects:[],version:2,orderby:"-tpm",teams:[Number(r)],fields:["transaction","project","tpm()","count_unique(user)","count_miserable(user)","user_misery()"]},d=X.ZP.fromSavedQuery({...l,name:"periodMisery",range:null!=o?o:void 0,start:i,end:a}),u=X.ZP.fromSavedQuery({...l,name:"weekMisery",range:"7d"});return(0,P.tZ)(G.Z,{eventView:d,orgSlug:t.slug,location:s,useEvents:!0,children:e=>{let{isLoading:r,tableData:i,error:a}=e;return(0,P.tZ)(G.Z,{eventView:u,orgSlug:t.slug,location:s,useEvents:!0,children:e=>{let{isLoading:l,tableData:d,error:u}=e;return(0,P.tZ)(O,{isLoading:r||l,organization:t,location:s,projects:n,period:o,periodTableData:i,weekTableData:d,error:null!=a?a:u})}})}})}O.displayName="TeamMisery",K.displayName="TeamMiseryWrapper";const U=K,H=(0,n.Z)(T.Z,{target:"e1uglq28"})("grid-template-columns:1.25fr 0.5fr 112px 112px 0.25fr;font-size:",(e=>e.theme.fontSizeMedium),";white-space:nowrap;margin-bottom:0;border:0;box-shadow:unset;&>div{padding:",(0,E.Z)(1)," ",(0,E.Z)(2),";}",(e=>e.isEmpty&&(0,Z.iv)("&>div:last-child{padding:48px ",(0,E.Z)(2),";}","")),";"),J=(0,n.Z)("div",{target:"e1uglq27"})({name:"s5xdrg",styles:"display:flex;align-items:center"}),Y=(0,n.Z)("div",{target:"e1uglq26"})((e=>e.theme.overflowEllipsis),";display:flex;align-items:center;"),ee=(0,n.Z)(z.GK,{target:"e1uglq25"})("display:block;margin-right:",(0,E.Z)(1),";margin-bottom:",(0,E.Z)(.5),";"),te=(0,n.Z)("div",{target:"e1uglq24"})((e=>e.theme.overflowEllipsis),";"),re=(0,n.Z)("span",{target:"e1uglq23"})({name:"2qga7i",styles:"text-align:right"}),ne=(0,n.Z)("div",{target:"e1uglq22"})({name:"4os8x4",styles:"display:flex;align-items:center;justify-content:flex-end;text-align:right"}),se=(0,n.Z)("div",{target:"e1uglq21"})("color:",(e=>e.theme.subText),";"),oe=(0,n.Z)("div",{target:"e1uglq20"})("color:",(e=>e.theme[e.color]),";");var ie=r("../node_modules/@emotion/react/dist/emotion-element-cbed451f.browser.esm.js"),ae=r("../node_modules/lodash/isEqual.js"),le=r.n(ae),de=r("../node_modules/moment/moment.js"),ue=r.n(de),ce=r("./app/components/charts/components/markLine.tsx"),pe=r("./app/components/placeholder.tsx");class he extends w.Z{constructor(){super(...arguments),(0,f.Z)(this,"shouldRenderBadRequests",!0)}getDefaultState(){return{...super.getDefaultState(),weekReleases:null,periodReleases:null}}getEndpoints(){const{organization:e,start:t,end:r,period:n,utc:s,teamSlug:o}=this.props,i={start:t,end:r,period:n,utc:s};return[["periodReleases",`/teams/${e.slug}/${o}/release-count/`,{query:{...(0,S.fK)(i)}}],["weekReleases",`/teams/${e.slug}/${o}/release-count/`,{query:{statsPeriod:"7d"}}]]}componentDidUpdate(e){const{teamSlug:t,start:r,end:n,period:s,utc:o}=this.props;e.start===r&&e.end===n&&e.period===s&&e.utc===o&&le()(e.teamSlug,t)||this.remountComponent()}getReleaseCount(e,t){const{periodReleases:r,weekReleases:n}=this.state,s="week"===t?null==n?void 0:n.last_week_totals:null==r?void 0:r.project_avgs;return null!=s&&s[e]?Math.ceil(null==s?void 0:s[e]):0}getTrend(e){const t=this.getReleaseCount(e,"period"),r=this.getReleaseCount(e,"week");return null===t||null===r?null:r-t}renderLoading(){return this.renderBody()}renderReleaseCount(e,t){const{loading:r}=this.state;if(r)return(0,P.tZ)("div",{children:(0,P.tZ)(pe.Z,{width:"80px",height:"25px"})});const n=this.getReleaseCount(Number(e),t);return null===n?"—":n}renderTrend(e){const{loading:t}=this.state;if(t)return(0,P.tZ)("div",{children:(0,P.tZ)(pe.Z,{width:"80px",height:"25px"})});const r=this.getTrend(Number(e));return null===r?"—":(0,P.BX)(xe,{color:r>=0?"green300":"red300",children:[`${x()(Math.abs(r),3)}`,(0,P.tZ)(ye,{direction:r>=0?"up":"down",size:"xs"})]})}renderBody(){var e,t;const{projects:r,period:n,theme:o,organization:i}=this.props,{periodReleases:a}=this.state,l=r.map((e=>{var t;return{project:e,trend:null!==(t=this.getTrend(Number(e.id)))&&void 0!==t?t:0}})).sort(((e,t)=>Math.abs(t.trend)-Math.abs(e.trend))),u=(0,k.NW)(l),c=Object.entries(null!==(e=null==a?void 0:a.release_counts)&&void 0!==e?e:{}).map((e=>{let[t,r]=e;return{value:Math.ceil(r),name:new Date(t).getTime()}})),p=(0,k.Gs)(c),h=Object.values(null!==(t=null==a?void 0:a.project_avgs)&&void 0!==t?t:{}),m=h.reduce(((e,t)=>e+t),0),g=Math.ceil(m/h.length);return(0,P.BX)("div",{children:[(0,P.tZ)(ge,{children:(0,P.tZ)(j.v,{style:{height:190},isGroupedByDate:!0,useShortDate:!0,period:"7d",legend:{right:3,top:0},yAxis:{minInterval:1},xAxis:(0,k.tP)(p.length),series:[{seriesName:(0,d.t)("This Period"),silent:!0,data:p,markLine:(0,ce.Z)({silent:!0,lineStyle:{color:o.gray200,type:"dashed",width:1},data:[{yAxis:g}],label:{show:!1}}),barCategoryGap:"5%"}],tooltip:{formatter:e=>{const[t]=Array.isArray(e)?e:[e],r="MMM D",s=ue()(t.data[0]).format(r),o=ue()(t.data[0]).add(7,"days").format(r);return['<div class="tooltip-series">',`<div><span class="tooltip-label">${t.marker} <strong>${t.seriesName}</strong></span> ${t.data[1]}</div>`,`<div><span class="tooltip-label"><strong>Last ${n} Average</strong></span> ${g}</div>`,"</div>",`<div class="tooltip-date">${s} - ${o}</div>`,'<div class="tooltip-arrow"></div>'].join("")}}})}),(0,P.tZ)(ve,{isEmpty:0===r.length,emptyMessage:(0,d.t)("No releases were setup for this team’s projects"),emptyAction:(0,P.tZ)(b.ZP,{size:"sm",external:!0,href:"https://docs.sentry.io/product/releases/setup/",children:(0,d.t)("Learn More")}),headers:[(0,d.t)("Releases Per Project"),(0,P.tZ)(fe,{children:(0,d._N)("Last [period] Average",{period:n})},"last"),(0,P.tZ)(fe,{children:(0,d.t)("Last 7 Days")},"curr"),(0,P.tZ)(fe,{children:(0,d.t)("Difference")},"diff")],children:u.map((e=>{let{project:t}=e;return(0,P.BX)(s.Fragment,{children:[(0,P.tZ)(q.R,{children:(0,P.tZ)(q.W,{avatarSize:18,project:t,to:{pathname:`/organizations/${i.slug}/releases/`,query:{project:t.id}}})}),(0,P.tZ)(Ze,{children:this.renderReleaseCount(t.id,"period")}),(0,P.tZ)(Ze,{children:(0,P.tZ)(_.Z,{to:{pathname:`/organizations/${i.slug}/releases/`,query:{project:t.id,statsPeriod:"7d"}},children:this.renderReleaseCount(t.id,"week")})}),(0,P.tZ)(Ze,{children:this.renderTrend(t.id)})]},t.id)}))})]})}}const me=(0,ie.d)(he),ge=(0,n.Z)("div",{target:"e1az29pq5"})("padding:",(0,E.Z)(2)," ",(0,E.Z)(2)," 0 ",(0,E.Z)(2),";border-bottom:1px solid ",(e=>e.theme.border),";"),ve=(0,n.Z)(T.Z,{target:"e1az29pq4"})("grid-template-columns:1fr 0.2fr 0.2fr 0.2fr;white-space:nowrap;margin-bottom:0;border:0;font-size:",(e=>e.theme.fontSizeMedium),";box-shadow:unset;&>div{padding:",(0,E.Z)(1)," ",(0,E.Z)(2),";}",(e=>e.isEmpty&&(0,Z.iv)("&>div:last-child{padding:48px ",(0,E.Z)(2),";}","")),";"),fe=(0,n.Z)("span",{target:"e1az29pq3"})({name:"2qga7i",styles:"text-align:right"}),Ze=(0,n.Z)("div",{target:"e1az29pq2"})({name:"4os8x4",styles:"display:flex;align-items:center;justify-content:flex-end;text-align:right"}),ye=(0,n.Z)(z.CC,{target:"e1az29pq1"})("margin:0 ",(0,E.Z)(.5),";"),xe=(0,n.Z)("div",{target:"e1az29pq0"})("color:",(e=>e.theme[e.color]),";");var we=r("./app/components/charts/miniBarChart.tsx"),be=r("./app/components/charts/sessionsRequest.tsx"),je=r("./app/types/index.tsx"),_e=r("./app/utils/sessions.tsx"),Se=r("./app/views/releases/utils/index.tsx");class Te extends w.Z{constructor(){super(...arguments),(0,f.Z)(this,"shouldRenderBadRequests",!0)}getDefaultState(){return{...super.getDefaultState(),weekSessions:null,periodSessions:null}}getEndpoints(){const{organization:e,start:t,end:r,period:n,utc:s,projects:o}=this.props,i=o.filter((e=>e.hasSessions));if(0===i.length)return[];const a={start:t,end:r,period:n,utc:s},l={environment:[],project:i.map((e=>e.id)),field:"sum(session)",groupBy:["session.status","project"],interval:"1d"};return[["periodSessions",`/organizations/${e.slug}/sessions/`,{query:{...l,...(0,S.fK)(a)}}],["weekSessions",`/organizations/${e.slug}/sessions/`,{query:{...l,statsPeriod:"7d"}}]]}componentDidUpdate(e){const{projects:t,start:r,end:n,period:s,utc:o}=this.props;e.start===r&&e.end===n&&e.period===s&&e.utc===o&&le()(e.projects,t)||this.remountComponent()}getScore(e,t){const{periodSessions:r,weekSessions:n}=this.state,s="week"===t?n:r,o=null==s?void 0:s.groups.filter((t=>t.by.project===e));return(0,_e.Pn)(o,je.kI.SESSIONS)}getTrend(e){const t=this.getScore(e,"period"),r=this.getScore(e,"week");return null===t||null===r?null:r-t}getMiniBarChartSeries(e,t){const r=(0,_e.wt)(t.groups.filter((t=>t.by.project===Number(e.id))),je.kI.SESSIONS,t.intervals),n=(0,_e.iy)(je.kI.SESSIONS,t.groups.find((t=>t.by.project===Number(e.id)&&t.by["session.status"]===je.$y.HEALTHY)),t.intervals),s=Array(r.length/7).fill(0);n.forEach(((e,t)=>s[Math.floor(t/7)]+=e.value));const o=Array(r.length/7).fill(0);r.forEach(((e,t)=>o[Math.floor(t/7)]+=e));const i=s.map(((e,t)=>({name:n[7*t].name,value:o[t]?(0,D.$1)(e/o[t]*100,2):0})));return[{seriesName:(0,d.t)("Crash Free Sessions"),data:i}]}renderLoading(){return this.renderBody()}renderScore(e,t){const{loading:r}=this.state;if(r)return(0,P.tZ)("div",{children:(0,P.tZ)(pe.Z,{width:"80px",height:"25px"})});const n=this.getScore(Number(e),t);return null===n?"—":(0,Se.zB)(n)}renderTrend(e){const{loading:t}=this.state;if(t)return(0,P.tZ)("div",{children:(0,P.tZ)(pe.Z,{width:"80px",height:"25px"})});const r=this.getTrend(Number(e));return null===r?"—":(0,P.BX)(Pe,{color:r>=0?"green300":"red300",children:[`${x()(Math.abs(r),3)}%`,(0,P.tZ)(ke,{direction:r>=0?"up":"down",size:"xs"})]})}renderBody(){const{organization:e,projects:t,period:r}=this.props,n=t.map((e=>{var t;return{project:e,trend:null!==(t=this.getTrend(Number(e.id)))&&void 0!==t?t:0}})).sort(((e,t)=>Math.abs(t.trend)-Math.abs(e.trend))),o=(0,k.NW)(n);return(0,P.tZ)(be.Z,{api:this.api,project:t.map((e=>{let{id:t}=e;return Number(t)})),organization:e,interval:"1d",groupBy:["session.status","project"],field:[je.kI.SESSIONS],statsPeriod:r,children:e=>{let{response:n,loading:i}=e;return(0,P.tZ)(Ee,{isEmpty:0===t.length,emptyMessage:(0,d.t)("No projects with release health enabled"),emptyAction:(0,P.tZ)(b.ZP,{size:"sm",external:!0,href:"https://docs.sentry.io/platforms/dotnet/guides/nlog/configuration/releases/#release-health",children:(0,d.t)("Learn More")}),headers:[(0,d.t)("Project"),(0,P.tZ)(De,{children:(0,d._N)("Last [period]",{period:r})},"last"),(0,P.tZ)(De,{children:(0,d._N)("[period] Avg",{period:r})},"avg"),(0,P.tZ)(De,{children:(0,d.t)("Last 7 Days")},"curr"),(0,P.tZ)(De,{children:(0,d.t)("Difference")},"diff")],children:o.map((e=>{let{project:t}=e;return(0,P.BX)(s.Fragment,{children:[(0,P.tZ)(q.R,{children:(0,P.tZ)(q.W,{avatarSize:18,project:t})}),(0,P.tZ)("div",{children:n&&!i&&(0,P.tZ)(we.Z,{isGroupedByDate:!0,showTimeInTooltip:!0,series:this.getMiniBarChartSeries(t,n),height:25,tooltipFormatter:e=>`${e.toLocaleString()}%`})}),(0,P.tZ)(qe,{children:this.renderScore(t.id,"period")}),(0,P.tZ)(qe,{children:this.renderScore(t.id,"week")}),(0,P.tZ)(qe,{children:this.renderTrend(t.id)})]},t.id)}))})}})}}const ze=Te,Ee=(0,n.Z)(T.Z,{target:"e182a5844"})("grid-template-columns:1fr 0.2fr 0.2fr 0.2fr 0.2fr;font-size:",(e=>e.theme.fontSizeMedium),";white-space:nowrap;margin-bottom:0;border:0;box-shadow:unset;overflow:visible;&>div{padding:",(0,E.Z)(1)," ",(0,E.Z)(2),";}",(e=>e.isEmpty&&(0,Z.iv)("&>div:last-child{padding:48px ",(0,E.Z)(2),";}","")),";"),De=(0,n.Z)("span",{target:"e182a5843"})({name:"2qga7i",styles:"text-align:right"}),qe=(0,n.Z)("div",{target:"e182a5842"})({name:"4os8x4",styles:"display:flex;align-items:center;justify-content:flex-end;text-align:right"}),ke=(0,n.Z)(z.CC,{target:"e182a5841"})("margin:0 ",(0,E.Z)(.5),";"),Pe=(0,n.Z)("div",{target:"e182a5840"})("color:",(e=>e.theme[e.color]),";");function Me(e){var t,r,n,f,Z;let{location:y,router:x}=e;const w=(0,p.Z)(),{teams:b,initiallyLoaded:j}=(0,h.Z)({provideUserTeams:!0}),_=null!==(t=null==y?void 0:y.query)&&void 0!==t?t:{},S=`teamInsightsSelectedTeamId:${w.slug}`;let T=null!==(r=_.team)&&void 0!==r?r:c.Z.getItem(S);T&&!b.find((e=>e.id===T))&&(T=null);const z=null!==(n=T)&&void 0!==n?n:null===(f=b[0])||void 0===f?void 0:f.id,E=b.find((e=>e.id===z)),D=null!==(Z=null==E?void 0:E.projects)&&void 0!==Z?Z:[];(0,s.useEffect)((()=>{(0,u.Z)("team_insights.viewed",{organization:w})}),[w]);const{period:q,start:M,end:N,utc:C}=(0,k.lI)(_);return 0===b.length?(0,P.tZ)(a.Z,{organization:w,superuserNeedsToBeProjectMember:!0}):(0,P.BX)(s.Fragment,{children:[(0,P.tZ)(l.Z,{title:(0,d.t)("Project Health"),orgSlug:w.slug}),(0,P.tZ)(m.Z,{organization:w,activeTab:"health"}),(0,P.BX)(Ne,{children:[(0,P.tZ)(g.Z,{location:y,router:x,currentTeam:E}),!j&&(0,P.tZ)(i.Z,{}),j&&(0,P.BX)(o.or,{fullWidth:!0,children:[(0,P.tZ)(v.Z,{title:(0,d.t)("Crash Free Sessions"),description:(0,d.t)("The percentage of healthy, errored, and abnormal sessions that didn’t cause a crash."),children:(0,P.tZ)(ze,{projects:D,organization:w,period:q,start:M,end:N,utc:C})}),(0,P.tZ)(v.Z,{title:(0,d.t)("User Misery"),description:(0,d.t)("The number of unique users that experienced load times 4x the project’s configured threshold."),children:(0,P.tZ)(U,{organization:w,projects:D,teamId:E.id,period:q,start:null==M?void 0:M.toString(),end:null==N?void 0:N.toString(),location:y})}),(0,P.tZ)(v.Z,{title:(0,d.t)("Metric Alerts Triggered"),description:(0,d.t)("Alerts triggered from the Alert Rules your team created."),children:(0,P.tZ)(R,{organization:w,projects:D,teamSlug:E.slug,period:q,start:null==M?void 0:M.toString(),end:null==N?void 0:N.toString(),location:y})}),(0,P.tZ)(v.Z,{title:(0,d.t)("Number of Releases"),description:(0,d.t)("The releases that were created in your team’s projects."),children:(0,P.tZ)(me,{projects:D,organization:w,teamSlug:E.slug,period:q,start:M,end:N,utc:C})})]})]})]})}Me.displayName="TeamStatsHealth";const Re=Me,Ne=(0,n.Z)(o.uT,{target:"e2twaak0"})("@media (min-width: ",(e=>e.theme.breakpoints.medium),"){display:block;}")},"./app/views/performance/traceDetails/utils.tsx":(e,t,r)=>{"use strict";r.d(t,{Rg:()=>i,YA:()=>o,uM:()=>a}),r("../node_modules/core-js/modules/web.dom-collections.iterator.js");var n=r("./app/constants/pageFilters.tsx"),s=r("./app/utils/performance/quickTrace/utils.tsx");function o(e,t,r,s){const{start:o,end:i,statsPeriod:a}=r;return{pathname:`/organizations/${e.slug}/performance/trace/${t}/`,query:{...s,statsPeriod:a,[n.V.PAGE_START]:o,[n.V.PAGE_END]:i}}}function i(e){const t={projects:new Set,errors:new Set,transactions:new Set,startTimestamp:Number.MAX_SAFE_INTEGER,endTimestamp:0,maxGeneration:0};return e.reduce(((e,t)=>(0,s.S2)(t,((e,t)=>{for(const n of null!==(r=t.errors)&&void 0!==r?r:[]){var r;e.errors.add(n.event_id)}return e.transactions.add(t.event_id),e.projects.add(t.project_slug),e.startTimestamp=Math.min(e.startTimestamp,t.start_timestamp),e.endTimestamp=Math.max(e.endTimestamp,t.timestamp),e.maxGeneration=Math.max(e.maxGeneration,t.generation),e}),e)),t)}function a(e){return null===e.parent_span_id}},"./app/views/performance/transactionSummary/utils.tsx":(e,t,r)=>{"use strict";r.d(t,{K0:()=>d,PU:()=>c,Z6:()=>h,e1:()=>p,uI:()=>g,vd:()=>m,xf:()=>u});var n=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),s=r("./app/styles/space.tsx"),o=r("./app/utils/discover/urls.tsx"),i=r("./app/utils/performance/urls.ts"),a=r("./app/utils/tokenizeSearch.tsx"),l=r("./app/views/performance/traceDetails/utils.tsx");let d;function u(e){const t=c(e);return t.removeFilter("transaction"),t}function c(e){const t=new a.MY(e);return t.removeFilter("event.type"),t}function p(e){let{orgSlug:t,transaction:r,projectID:n,query:s,unselectedSeries:o="p100()",display:i,trendFunction:a,trendColumn:l,showTransactions:d,additionalQuery:c}=e;const p=function(e){let{orgSlug:t}=e;return`/organizations/${t}/performance/summary/`}({orgSlug:t});let h;return h="string"==typeof s.query?u(s.query).formatString():s.query,{pathname:p,query:{transaction:r,project:n,environment:s.environment,statsPeriod:s.statsPeriod,start:s.start,end:s.end,query:h,unselectedSeries:o,showTransactions:d,display:i,trendFunction:a,trendColumn:l,...c}}}function h(e){return(t,r,n)=>{const s=`${r.trace}`;return s?(0,l.YA)(t,s,e,{}):{}}}function m(e){return(t,r,n,s)=>{const a=(0,o.JE)(r);return(0,i.D)(t.slug,a,e,n,s)}}!function(e){e.FASTEST="fastest",e.SLOW="slow",e.OUTLIER="outlier",e.RECENT="recent"}(d||(d={}));const g=(0,n.Z)("div",{target:"e1radvp0"})("margin-top:",(0,s.Z)(3),";")},"../node_modules/lodash/_baseExtremum.js":(e,t,r)=>{var n=r("../node_modules/lodash/isSymbol.js");e.exports=function(e,t,r){for(var s=-1,o=e.length;++s<o;){var i=e[s],a=t(i);if(null!=a&&(void 0===l?a==a&&!n(a):r(a,l)))var l=a,d=i}return d}},"../node_modules/lodash/_baseGt.js":e=>{e.exports=function(e,t){return e>t}},"../node_modules/lodash/_baseMean.js":(e,t,r)=>{var n=r("../node_modules/lodash/_baseSum.js");e.exports=function(e,t){var r=null==e?0:e.length;return r?n(e,t)/r:NaN}},"../node_modules/lodash/_baseSum.js":e=>{e.exports=function(e,t){for(var r,n=-1,s=e.length;++n<s;){var o=t(e[n]);void 0!==o&&(r=void 0===r?o:r+o)}return r}},"../node_modules/lodash/maxBy.js":(e,t,r)=>{var n=r("../node_modules/lodash/_baseExtremum.js"),s=r("../node_modules/lodash/_baseGt.js"),o=r("../node_modules/lodash/_baseIteratee.js");e.exports=function(e,t){return e&&e.length?n(e,o(t,2),s):void 0}},"../node_modules/lodash/mean.js":(e,t,r)=>{var n=r("../node_modules/lodash/_baseMean.js"),s=r("../node_modules/lodash/identity.js");e.exports=function(e){return n(e,s)}},"../node_modules/lodash/negate.js":e=>{e.exports=function(e){if("function"!=typeof e)throw new TypeError("Expected a function");return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}},"../node_modules/lodash/omitBy.js":(e,t,r)=>{var n=r("../node_modules/lodash/_baseIteratee.js"),s=r("../node_modules/lodash/negate.js"),o=r("../node_modules/lodash/pickBy.js");e.exports=function(e,t){return o(e,s(n(t)))}}}]);
//# sourceMappingURL=../sourcemaps/app_views_organizationStats_teamInsights_health_tsx-node_modules_lodash_maxBy_js-node_modules-ed2a57.21ad8caee2dbc9de848082eb28b51ffa.js.map