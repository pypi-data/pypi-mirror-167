"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_charts_eventsChart_tsx-app_components_charts_optionSelector_tsx"],{"./app/components/charts/chartZoom.tsx":(e,t,s)=>{s.d(t,{Z:()=>y});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),a=s("../node_modules/moment/moment.js"),i=s.n(a),n=s("../node_modules/query-string/index.js"),l=s("./app/actionCreators/pageFilters.tsx"),d=s("./app/components/charts/components/dataZoomInside.tsx");s("../node_modules/echarts/lib/component/dataZoomSlider.js");const p={realtime:!1,showDetail:!1,left:0,right:6,bottom:8};function c(e){return e&&Array.isArray(e)?e:[{...p,...e}]}var u=s("./app/components/charts/components/toolBox.tsx"),m=s("./app/utils/callIfFunction.tsx"),h=s("./app/utils/dates.tsx");const v=e=>e?i().utc(e).format(i().HTML5_FMT.DATETIME_LOCAL_SECONDS):null;class g extends o.Component{constructor(e){var t;super(e),t=this,(0,r.Z)(this,"history",void 0),(0,r.Z)(this,"currentPeriod",void 0),(0,r.Z)(this,"zooming",null),(0,r.Z)(this,"saveCurrentPeriod",(e=>{this.currentPeriod={period:e.period,start:v(e.start),end:v(e.end)}})),(0,r.Z)(this,"setPeriod",(function(e){let{period:s,start:r,end:o}=e,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{router:i,onZoom:d,usePageDate:p}=t.props,c=v(r),u=v(o);a&&t.history.push(t.currentPeriod),(0,m.g)(d,{period:s,start:c,end:u}),t.zooming=()=>{if(p&&i){const e={...i.location.query,pageStart:r?(0,h.v5)(r):void 0,pageEnd:o?(0,h.v5)(o):void 0,pageStatsPeriod:null!=s?s:void 0};n.stringify(e)!==n.stringify(i.location.query)&&i.push({pathname:i.location.pathname,query:e})}else(0,l.dR)({period:s,start:c?(0,h.hC)(c):c,end:u?(0,h.hC)(u):u},i);t.saveCurrentPeriod({period:s,start:r,end:o})}})),(0,r.Z)(this,"handleChartReady",(e=>{(0,m.g)(this.props.onChartReady,e)})),(0,r.Z)(this,"handleZoomRestore",((e,t)=>{this.history.length&&(this.setPeriod(this.history[0]),this.history=[],(0,m.g)(this.props.onRestore,e,t))})),(0,r.Z)(this,"handleDataZoom",((e,t)=>{const s=t.getModel(),{startValue:r,endValue:o}=s._payload.batch[0];if(null===r&&null===o){const e=this.history.pop();if(!e)return;this.setPeriod(e)}else{const e=i().utc(r),t=i().utc(o);this.setPeriod({period:null,start:e,end:t},!0)}(0,m.g)(this.props.onDataZoom,e,t)})),(0,r.Z)(this,"handleChartFinished",((e,t)=>{var s;"function"==typeof this.zooming&&(this.zooming(),this.zooming=null);const r=null===(s=t._componentsViews)||void 0===s?void 0:s.find((e=>e._features&&e._features.dataZoom));r&&!r._features.dataZoom._isZoomActive&&t.dispatchAction({type:"takeGlobalCursor",key:"dataZoomSelect",dataZoomSelectActive:!0}),(0,m.g)(this.props.onFinished)})),this.history=[],this.saveCurrentPeriod(e)}componentDidUpdate(){this.props.disabled||this.saveCurrentPeriod(this.props)}render(){const{utc:e,start:t,end:s,disabled:r,children:o,xAxisIndex:a,router:i,onZoom:n,onRestore:l,onChartReady:p,onDataZoom:m,onFinished:v,showSlider:g,chartZoomOptions:y,...x}=this.props,f=null!=e?e:void 0,b=t?(0,h.hC)(t):void 0,Z=s?(0,h.hC)(s):void 0;return o(r?{utc:f,start:b,end:Z,...x}:{isGroupedByDate:!0,onChartReady:this.handleChartReady,utc:f,start:b,end:Z,dataZoom:g?[...c({xAxisIndex:a,...y}),...(0,d.Z)({xAxisIndex:a,...y})]:(0,d.Z)({xAxisIndex:a,...y}),showTimeInTooltip:!0,toolBox:(0,u.Z)({},{dataZoom:{title:{zoom:"",back:""},iconStyle:{borderWidth:0,color:"transparent",opacity:0}}}),onDataZoom:this.handleDataZoom,onFinished:this.handleChartFinished,onRestore:this.handleZoomRestore,...x})}}g.displayName="ChartZoom";const y=g},"./app/components/charts/components/dataZoomInside.tsx":(e,t,s)=>{s.d(t,{Z:()=>o}),s("../node_modules/echarts/lib/component/dataZoomInside.js");const r={type:"inside",zoomOnMouseWheel:!1,zoomLock:!0,throttle:50};function o(e){return e&&Array.isArray(e)?e:[{...r,...e}]}},"./app/components/charts/components/toolBox.tsx":(e,t,s)=>{function r(){let{dataZoom:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{...e?{dataZoom:{yAxisIndex:"none",title:{zoom:"zoom",back:"undo"},...e}}:{},...t}}function o(e,t){return{right:0,top:0,itemSize:16,z:-1,feature:r(t),...e}}s.d(t,{Z:()=>o})},"./app/components/charts/components/visualMap.tsx":(e,t,s)=>{function r(e){return e}s.d(t,{Z:()=>r}),s("../node_modules/echarts/lib/component/visualMap.js")},"./app/components/charts/errorPanel.tsx":(e,t,s)=>{s.d(t,{Z:()=>r});const r=(0,s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js").Z)("div",{target:"e1six6h50"})("display:flex;flex-direction:column;justify-content:center;align-items:center;flex:1;flex-shrink:0;overflow:hidden;height:",(e=>e.height||"200px"),";position:relative;border-color:transparent;margin-bottom:0;color:",(e=>e.theme.gray300),";font-size:",(e=>e.theme.fontSizeExtraLarge),";")},"./app/components/charts/eventsChart.tsx":(e,t,s)=>{s.d(t,{Z:()=>R});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/core-js/modules/es.error.cause.js"),s("../node_modules/react/index.js")),a=s("../node_modules/@emotion/react/dist/emotion-element-cbed451f.browser.esm.js"),i=s("../node_modules/lodash/isEqual.js"),n=s.n(i),l=s("./app/components/charts/areaChart.tsx"),d=s("./app/components/charts/barChart.tsx"),p=s("./app/components/charts/chartZoom.tsx"),c=s("./app/components/charts/errorPanel.tsx"),u=s("./app/components/charts/lineChart.tsx"),m=s("./app/components/charts/releaseSeries.tsx"),h=s("./app/components/charts/transitionChart.tsx"),v=s("./app/components/charts/transparentLoadingMask.tsx"),g=s("./app/components/charts/utils.tsx"),y=s("./app/components/charts/worldMapChart.tsx"),x=s("./app/icons/index.tsx"),f=s("./app/locale.tsx"),b=s("./app/utils.tsx"),Z=s("./app/utils/discover/charts.tsx"),D=s("./app/utils/discover/fields.tsx"),j=s("./app/utils/queryString.tsx"),S=s("./app/components/charts/eventsGeoRequest.tsx"),C=s("./app/components/charts/eventsRequest.tsx"),_=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class w extends o.Component{constructor(){super(...arguments),(0,r.Z)(this,"state",{seriesSelection:{},forceUpdate:!1}),(0,r.Z)(this,"handleLegendSelectChanged",(e=>{const{disableableSeries:t=[]}=this.props,{selected:s}=e,r=Object.keys(s).reduce(((e,r)=>{const o=["Releases","Other"].includes(r)||t.includes(r);return e[r]=!o||s[r],e}),{});this.setState({seriesSelection:r,forceUpdate:!0},(()=>this.setState({forceUpdate:!1})))}))}shouldComponentUpdate(e,t){return!(!t.forceUpdate&&n()(this.state.seriesSelection,t.seriesSelection)&&(e.reloading||!e.timeseriesData||n()(this.props.timeseriesData,e.timeseriesData)&&n()(this.props.releaseSeries,e.releaseSeries)&&n()(this.props.previousTimeseriesData,e.previousTimeseriesData)&&n()(this.props.tableData,e.tableData)))}getChartComponent(){const{showDaily:e,timeseriesData:t,yAxis:s,chartComponent:r}=this.props;if((0,b.ri)(r))return r;if(e)return d.v;if(t.length>1)switch((0,D.fD)(s)){case"line":return u.w;case"area":return l.T;default:throw new Error(`Unknown multi plot type for ${s}`)}return l.T}render(){var e,t;const{theme:s,loading:r,reloading:o,yAxis:a,releaseSeries:i,zoomRenderProps:n,timeseriesData:l,previousTimeseriesData:p,showLegend:c,legendOptions:u,chartOptions:m,currentSeriesNames:h,previousSeriesNames:v,seriesTransformer:x,previousSeriesTransformer:b,colors:j,height:S,timeframe:C,topEvents:w,tableData:P,fromDiscover:T,timeseriesResultsTypes:R,...A}=this.props,{seriesSelection:M}=this.state;let k=this.getChartComponent();if(k===y.y){const{data:e,title:t}=(0,g.JT)(P),s=[{seriesName:t,data:e}];return(0,_.tZ)(y.y,{series:s,fromDiscover:T})}const z=[...h.length>0?h:[(0,f.t)("Current")],...v.length>0?v:[(0,f.t)("Previous")]],L=(0,f.t)("Releases"),N=w&&w+1===l.length;N&&z.push("Other"),Array.isArray(i)&&z.push(L);const O=i&&i[0],q=Array.isArray(i)&&(null==O||null===(e=O.markLine)||void 0===e?void 0:e.data)&&O.markLine.data.length>=g.XO,E=Array.isArray(i)&&0===Object.keys(M).length&&q?{[L]:!1}:M,I=c?{right:16,top:12,data:z,selected:E,...null!=u?u:{}}:void 0;let W=Array.isArray(i)?[...l,...i]:l,F=p;var Q;x&&(W=x(W)),b&&(F=null===(Q=F)||void 0===Q?void 0:Q.map((e=>b(e))));const U=l.length?null!==(t=null==j?void 0:j.slice(0,W.length))&&void 0!==t?t:[...s.charts.getColorPalette(l.length-2-(N?1:0))]:void 0;U&&U.length&&N&&U.push(s.chartOther);const $={colors:U,grid:{left:"24px",right:"24px",top:"32px",bottom:"12px"},seriesOptions:{showSymbol:!1},tooltip:{trigger:"axis",truncate:80,valueFormatter:(e,t)=>{var s;const r=null==t||null===(s=t.split(":").pop())||void 0===s?void 0:s.trim();return r?R?(0,Z.CX)(e,R[r]):(0,Z.CX)(e,(0,D.Px)(r)):(0,Z.CX)(e,"number")}},xAxis:C?{min:C.start,max:C.end}:void 0,yAxis:{axisLabel:{color:s.chartLabel,formatter:e=>{if(R){const t=1===new Set(Object.values(R)).size?R[a]:"number";return(0,Z.x1)(e,t)}return(0,Z.gu)(e,(0,D.Px)(a))}}},...null!=m?m:{},animation:typeof k!=typeof d.v&&void 0};return(0,_.tZ)(k,{...A,...n,...$,legend:I,onLegendSelectChanged:this.handleLegendSelectChanged,series:W,previousPeriod:F||void 0,height:S})}}w.displayName="Chart";const P=(0,a.d)(w);class T extends o.Component{isStacked(){const{topEvents:e,yAxis:t}=this.props;return"number"==typeof e&&e>0||Array.isArray(t)&&t.length>1}render(){const{api:e,organization:t,period:s,utc:r,query:a,router:i,start:n,end:l,projects:d,environments:u,showLegend:b,minutesThresholdToDisplaySeconds:Z,yAxis:w,disablePrevious:T,disableReleases:R,emphasizeReleases:A,currentSeriesName:M,previousSeriesName:k,seriesTransformer:z,previousSeriesTransformer:L,field:N,interval:O,showDaily:q,topEvents:E,orderby:I,confirmedQuery:W,colors:F,chartHeader:Q,legendOptions:U,chartOptions:$,preserveReleaseQueryParams:B,releaseQueryExtra:Y,disableableSeries:X,chartComponent:G,usePageZoom:H,height:J,withoutZerofill:V,fromDiscover:K,...ee}=this.props,te=!T&&!n&&!l,se=(0,j.qP)(w),re=se.map((e=>{let t=e&&(0,D.GO)(e)?(0,D.vp)(e):e;return t&&t.length>60&&(t=t.substr(0,60)+"..."),t})),oe=k?[k]:re.map((e=>(0,f.t)("previous %s",e))),ae=M?[M]:re,ie=q?"1d":O||(0,g.ZS)(this.props,"high");let ne=e=>{let{zoomRenderProps:t,releaseSeries:s,errored:r,loading:a,reloading:i,results:n,timeseriesData:l,previousTimeseriesData:d,timeframe:p,tableData:u,timeseriesResultsTypes:m}=e;if(r)return(0,_.tZ)(c.Z,{children:(0,_.tZ)(x.FC,{color:"gray300",size:"lg"})});const g=n||l;return(0,_.BX)(h.Z,{loading:a,reloading:i,height:J?`${J}px`:void 0,children:[(0,_.tZ)(v.Z,{visible:i}),o.isValidElement(Q)&&Q,(0,_.tZ)(P,{zoomRenderProps:t,loading:a,reloading:i,showLegend:b,minutesThresholdToDisplaySeconds:Z,releaseSeries:s||[],timeseriesData:null!=g?g:[],previousTimeseriesData:d,currentSeriesNames:ae,previousSeriesNames:oe,seriesTransformer:z,previousSeriesTransformer:L,stacked:this.isStacked(),yAxis:se[0],showDaily:q,colors:F,legendOptions:U,chartOptions:$,disableableSeries:X,chartComponent:G,height:J,timeframe:p,topEvents:E,tableData:null!=u?u:[],fromDiscover:K,timeseriesResultsTypes:m})]})};if(!R){const e=ne;ne=t=>(0,_.tZ)(m.Z,{utc:r,period:s,start:n,end:l,projects:d,environments:u,emphasizeReleases:A,preserveQueryParams:B,queryExtra:Y,children:s=>{let{releaseSeries:r}=s;return e({...t,releaseSeries:r})}})}return(0,_.tZ)(p.Z,{router:i,period:s,start:n,end:l,utc:r,usePageDate:H,...ee,children:r=>G===y.y?(0,_.tZ)(S.Z,{api:e,organization:t,yAxis:w,query:a,orderby:I,projects:d,period:s,start:n,end:l,environments:u,referrer:ee.referrer,children:e=>{let{errored:t,loading:s,reloading:o,tableData:a}=e;return ne({errored:t,loading:s,reloading:o,zoomRenderProps:r,tableData:a})}}):(0,_.tZ)(C.Z,{...ee,api:e,organization:t,period:s,project:d,environment:u,start:n,end:l,interval:ie,query:a,includePrevious:te,currentSeriesNames:ae,previousSeriesNames:oe,yAxis:w,field:N,orderby:I,topEvents:E,confirmedQuery:W,partial:!0,withoutZerofill:V&&!this.isStacked(),children:e=>ne({...e,zoomRenderProps:r})})})}}T.displayName="EventsChart";const R=T},"./app/components/charts/eventsGeoRequest.tsx":(e,t,s)=>{s.d(t,{Z:()=>n}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=s("../node_modules/react/index.js"),o=s("./app/utils/dates.tsx"),a=s("./app/utils/discover/eventView.tsx"),i=s("./app/utils/discover/genericDiscoverQuery.tsx");const n=e=>{let{api:t,organization:s,yAxis:n,query:l,orderby:d,projects:p,period:c,start:u,end:m,environments:h,referrer:v,children:g}=e;const y=a.ZP.fromSavedQuery({id:void 0,name:"",version:2,fields:Array.isArray(n)?n:[n],query:l,orderby:null!=d?d:"",projects:p,range:null!=c?c:"",start:u?(0,o.v5)(u):void 0,end:m?(0,o.v5)(m):void 0,environment:h}),[x,f]=(0,r.useState)(void 0),[b,Z]=(0,r.useState)(!1),[D,j]=(0,r.useState)(!1);return(0,r.useEffect)((()=>{let e=!0;return j(!1),x&&Z(!0),(0,i.AA)(t,`/organizations/${s.slug}/events-geo/`,{...y.generateQueryStringObject(),referrer:v}).then((t=>{e&&(f([t[0]]),Z(!1))})).catch((()=>{e&&(j(!0),Z(!1))})),()=>{e=!1}}),[l,n,u,m,c,h,p,t]),g({errored:D,loading:!x&&!D,reloading:b,tableData:x})}},"./app/components/charts/eventsRequest.tsx":(e,t,s)=>{s.d(t,{Z:()=>Z});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=(s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),a=s("../node_modules/lodash/isEqual.js"),i=s.n(a),n=s("../node_modules/lodash/omitBy.js"),l=s.n(n),d=s("./app/actionCreators/events.tsx"),p=s("./app/actionCreators/indicator.tsx"),c=s("./app/components/charts/loadingPanel.tsx"),u=s("./app/components/charts/utils.tsx"),m=s("./app/locale.tsx"),h=s("./app/utils.tsx"),v=s("./app/utils/discover/fieldRenderers.tsx"),g=s("./app/utils/discover/fields.tsx"),y=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const x=["api","children","organization","loading","queryBatching","generatePathname"],f=e=>l()(e,((e,t)=>x.includes(t)));class b extends o.PureComponent{constructor(){super(...arguments),(0,r.Z)(this,"state",{reloading:!!this.props.loading,errored:!1,timeseriesData:null,fetchedWithPrevious:!1}),(0,r.Z)(this,"unmounting",!1),(0,r.Z)(this,"fetchData",(async()=>{const{api:e,confirmedQuery:t,onError:s,expired:r,name:o,hideError:a,...i}=this.props;let n,l=null;if(!1!==t){if(this.setState((e=>({reloading:null!==e.timeseriesData,errored:!1,errorMessage:void 0}))),r)n=(0,m.t)("%s has an invalid date range. Please try a more recent date range.",o),(0,p.Iw)(n,{append:!0}),this.setState({errored:!0,errorMessage:n});else try{e.clear(),l=await(0,d.lI)(e,i)}catch(e){n=e&&e.responseJSON&&e.responseJSON.detail?e.responseJSON.detail:(0,m.t)("Error loading chart data"),a||(0,p.Iw)(n),s&&s(n),this.setState({errored:!0,errorMessage:n})}this.unmounting||(this.setState({reloading:!1,timeseriesData:l,fetchedWithPrevious:i.includePrevious}),i.dataLoadedCallback&&i.dataLoadedCallback(l))}})),(0,r.Z)(this,"getData",(e=>{const{fetchedWithPrevious:t}=this.state,{period:s,includePrevious:r}=this.props,o=t||(0,u.Sw)(r,s),a=Math.floor(e.length/2);return{current:o?e.slice(a):e,previous:o?e.slice(0,a):null}}))}componentDidMount(){this.fetchData()}componentDidUpdate(e){i()(f(e),f(this.props))||this.fetchData()}componentWillUnmount(){this.unmounting=!0}calculateTotalsPerTimestamp(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>1e3*e;return e.map(((e,s)=>{let[r,o]=e;return{name:t(r,o,s),value:o.reduce(((e,t)=>{let{count:s}=t;return e+s}),0)}}))}transformPreviousPeriodData(e,t,s){return t?{seriesName:null!=s?s:"Previous",data:this.calculateTotalsPerTimestamp(t,((t,s,r)=>1e3*e[r][0])),stack:"previous"}:null}transformAggregatedTimeseries(e){return{seriesName:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",data:this.calculateTotalsPerTimestamp(e)}}transformTimeseriesData(e,t,s){let r=1;if(s){var o,a,i;const e=null==t||null===(o=t.units)||void 0===o?void 0:o[(0,g.LY)(s)];r=null!==(a=e&&(null!==(i=v.a_[e])&&void 0!==i?i:v.en[e]))&&void 0!==a?a:1}return[{seriesName:s||"Current",data:e.map((e=>{let[t,s]=e;return{name:1e3*t,value:s.reduce(((e,t)=>{let{count:s}=t;return e+s}),0)*r}}))}]}transformComparisonTimeseriesData(e){return[{seriesName:"comparisonCount()",data:e.map((e=>{let[t,s]=e;return{name:1e3*t,value:s.reduce(((e,t)=>{let{comparisonCount:s}=t;return e+(null!=s?s:0)}),0)}}))}]}processData(e){var t;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;const{data:o,isMetricsData:a,totals:i,meta:n}=e,{includeTransformedData:l,includeTimeAggregation:d,timeAggregationSeriesName:p,currentSeriesNames:c,previousSeriesNames:m,comparisonDelta:h}=this.props,{current:v,previous:g}=this.getData(o);return{data:l?this.transformTimeseriesData(v,n,null!=r?r:null==c?void 0:c[s]):[],comparisonData:l&&h?this.transformComparisonTimeseriesData(v):[],allData:o,originalData:v,totals:i,isMetricsData:a,originalPreviousData:g,previousData:l?this.transformPreviousPeriodData(v,g,null!==(t=r?(0,u.TE)(r):void 0)&&void 0!==t?t:null==m?void 0:m[s]):null,timeAggregatedData:d?this.transformAggregatedTimeseries(v,p||""):{},timeframe:e.start&&e.end?g?{start:500*(e.start+e.end),end:1e3*e.end}:{start:1e3*e.start,end:1e3*e.end}:void 0}}render(){const{children:e,showLoading:t,...s}=this.props,{topEvents:r,yAxis:o}=this.props,{timeseriesData:a,reloading:i,errored:n,errorMessage:l}=this.state,d=this.props.loading||null===a;if(t&&d)return(0,y.tZ)(c.Z,{"data-test-id":"events-request-loading"});if((0,u.Xe)(a,(0,h.ri)(r))){let t;const r={},o=Object.keys(a).map(((e,s)=>{const o=a[e],i=this.processData(o,s,(0,g.bQ)(e));return t||(t=i.timeframe),i.isMetricsData&&(r[e]={isMetricsData:i.isMetricsData}),[o.order||0,i.data[0],i.previousData,{isMetricsData:i.isMetricsData}]})).sort(((e,t)=>e[0]-t[0])),p={};Object.keys(a).forEach((e=>{var t;const s=null===(t=a[e].meta)||void 0===t?void 0:t.fields[(0,g.LY)(e)];s&&(p[e]=s)}));const c=o.map((e=>e[1])),u=o.some((e=>null===e[2]))?void 0:o.map((e=>e[2]));return e({loading:d,reloading:i,errored:n,errorMessage:l,results:c,timeframe:t,previousTimeseriesData:u,seriesAdditionalInfo:r,timeseriesResultsTypes:p,...s})}if(a){var p,m,v;const t=o&&("string"==typeof o?o:o[0]),r=t&&(null===(p=a.meta)||void 0===p?void 0:p.fields[(0,g.LY)(t)]),c=r?{[t]:r}:void 0,{data:u,comparisonData:h,allData:y,originalData:x,totals:f,originalPreviousData:b,previousData:Z,timeAggregatedData:D,timeframe:j,isMetricsData:S}=this.processData(a);return e({loading:d,reloading:i,errored:n,errorMessage:l,seriesAdditionalInfo:{[null!==(m=null===(v=this.props.currentSeriesNames)||void 0===v?void 0:v[0])&&void 0!==m?m:"current"]:{isMetricsData:S}},timeseriesData:u,comparisonTimeseriesData:h,allTimeseriesData:y,originalTimeseriesData:x,timeseriesTotals:f,originalPreviousTimeseriesData:b,previousTimeseriesData:Z?[Z]:Z,timeAggregatedData:D,timeframe:j,timeseriesResultsTypes:c,...s})}return e({loading:d,reloading:i,errored:n,errorMessage:l,...s})}}b.displayName="EventsRequest",(0,r.Z)(b,"defaultProps",{period:void 0,start:null,end:null,interval:"1d",comparisonDelta:void 0,limit:15,query:"",includePrevious:!0,includeTransformedData:!0});const Z=b},"./app/components/charts/lineChart.tsx":(e,t,s)=>{s.d(t,{w:()=>i});var r=s("./app/components/charts/series/lineSeries.tsx"),o=s("./app/components/charts/baseChart.tsx"),a=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function i(e){let{series:t,seriesOptions:s,...i}=e;return(0,a.tZ)(o.Z,{...i,series:t.map((e=>{let{seriesName:t,data:o,dataArray:a,...i}=e;return(0,r.Z)({...s,...i,name:t,data:a||(null==o?void 0:o.map((e=>{let{value:t,name:s}=e;return[s,t]}))),animation:!1,animationThreshold:1,animationDuration:0})}))})}i.displayName="LineChart"},"./app/components/charts/optionSelector.tsx":(e,t,s)=>{s.d(t,{Z:()=>u});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=(s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/react/index.js")),a=s("./app/components/featureBadge.tsx"),i=s("./app/components/forms/compactSelect.tsx"),n=s("./app/components/truncate.tsx"),l=s("./app/utils.tsx"),d=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function p(e){let{options:t,onChange:s,selected:r,title:a,featureType:p,multiple:u,...m}=e;const h=(0,o.useMemo)((()=>t.map((e=>({...e,label:(0,d.tZ)(n.Z,{value:String(e.label),maxLength:60,expandDirection:"left"})})))),[t]);return(0,d.tZ)(i.Z,{size:"sm",options:h,value:r,onChange:function(e){s(u?e.map((e=>e.value)):e.value)},isOptionDisabled:function(e){return e.disabled||u&&3===r.length&&!r.includes(e.value)},multiple:u,triggerProps:{borderless:!0,prefix:(0,d.BX)(o.Fragment,{children:[a,(0,l.ri)(p)?(0,d.tZ)(c,{type:p}):null]})},placement:"bottom right",...m})}p.displayName="OptionSelector";const c=(0,r.Z)(a.Z,{target:"e1a4edto0"})({name:"6og82r",styles:"margin-left:0px"}),u=p},"./app/components/charts/releaseSeries.tsx":(e,t,s)=>{s.d(t,{Z:()=>S});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/react/index.js")),a=s("../node_modules/react-router/es/index.js"),i=s("../node_modules/@emotion/react/dist/emotion-element-cbed451f.browser.esm.js"),n=s("../node_modules/lodash/isEqual.js"),l=s.n(n),d=s("../node_modules/lodash/memoize.js"),p=s.n(d),c=s("../node_modules/lodash/partition.js"),u=s.n(c),m=s("./app/actionCreators/indicator.tsx"),h=s("./app/components/charts/components/markLine.tsx"),v=s("./app/locale.tsx"),g=s("./app/utils.tsx"),y=s("./app/utils/dates.tsx"),x=s("./app/utils/formatters.tsx"),f=s("./app/utils/parseLinkHeader.tsx"),b=s("./app/utils/withApi.tsx"),Z=s("./app/utils/withOrganization.tsx");function D(e,t,s){const r={};return Object.keys(s).forEach((e=>{let t=s[e];!t||"start"!==e&&"end"!==e||(t=(0,y.v5)(t)),t&&(r[e]=t)})),e.clear(),e.requestPromise(`/organizations/${t.slug}/releases/stats/`,{includeAllArgs:!0,method:"GET",query:r})}class j extends o.Component{constructor(){var e;super(...arguments),e=this,(0,r.Z)(this,"state",{releases:null,releaseSeries:[]}),(0,r.Z)(this,"_isMounted",!1),(0,r.Z)(this,"getOrganizationReleasesMemoized",p()(((e,t,s)=>D(e,t,s)),((e,t,s)=>Object.values(s).map((e=>JSON.stringify(e))).join("-")))),(0,r.Z)(this,"getReleaseSeries",(function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{organization:r,router:o,tooltip:a,environments:i,start:n,end:l,period:d,preserveQueryParams:p,queryExtra:c,theme:u}=e.props,m={...c};r.features.includes("global-views")&&(m.project=o.location.query.project),p&&(m.environment=[...i],m.start=n?(0,y.v5)(n):void 0,m.end=l?(0,y.v5)(l):void 0,m.statsPeriod=d||void 0);const f=(0,h.Z)({animation:!1,lineStyle:{color:u.purple300,opacity:.3,type:"solid",...s},label:{show:!1},data:t.map((e=>({xAxis:+new Date(e.date),name:(0,x.ko)(e.version,!0),value:(0,x.ko)(e.version,!0),onClick:()=>{o.push({pathname:`/organizations/${r.slug}/releases/${e.version}/`,query:m})},label:{formatter:()=>(0,x.ko)(e.version,!0)}}))),tooltip:a||{trigger:"item",formatter:t=>{let{data:s}=t;const r=(0,y.L0)(s.value,"MMM D, YYYY LT",{local:!e.props.utc}),o=(0,g.YU)((0,x.ko)(s.name,!0));return['<div class="tooltip-series">',`<div><span class="tooltip-label"><strong>${(0,v.t)("Release")}</strong></span> ${o}</div>`,"</div>",'<div class="tooltip-date">',r,"</div>","</div>",'<div class="tooltip-arrow"></div>'].join("")}}});return{seriesName:"Releases",color:u.purple200,data:[],markLine:f}}))}componentDidMount(){this._isMounted=!0;const{releases:e}=this.props;e?this.setReleasesWithSeries(e):this.fetchData()}componentDidUpdate(e){l()(e.projects,this.props.projects)&&l()(e.environments,this.props.environments)&&l()(e.start,this.props.start)&&l()(e.end,this.props.end)&&l()(e.period,this.props.period)&&l()(e.query,this.props.query)?l()(e.emphasizeReleases,this.props.emphasizeReleases)||this.setReleasesWithSeries(this.state.releases):this.fetchData()}componentWillUnmount(){this._isMounted=!1,this.props.api.clear()}async fetchData(){const{api:e,organization:t,projects:s,environments:r,period:o,start:a,end:i,memoized:n,query:l}=this.props,d={start:a,end:i,project:s,environment:r,statsPeriod:o,query:l};let p=!0;const c=[];for(;p;)try{const s=n?this.getOrganizationReleasesMemoized:D,[r,,o]=await s(e,t,d);c.push(...r),this._isMounted&&this.setReleasesWithSeries(c);const a=null==o?void 0:o.getResponseHeader("Link");if(a){var u,h;const e=(0,f.Z)(a);p=null!==(u=null==e||null===(h=e.next)||void 0===h?void 0:h.results)&&void 0!==u&&u,d.cursor=e.next.cursor}else p=!1}catch{(0,m.Iw)((0,v.t)("Error fetching releases")),p=!1}}setReleasesWithSeries(e){const{emphasizeReleases:t=[]}=this.props,s=[];if(t.length){const[r,o]=u()(e,(e=>!t.includes(e.version)));r.length&&s.push(this.getReleaseSeries(r,{type:"dotted"})),o.length&&s.push(this.getReleaseSeries(o,{opacity:.8}))}else s.push(this.getReleaseSeries(e));this.setState({releases:e,releaseSeries:s})}render(){const{children:e}=this.props;return e({releases:this.state.releases,releaseSeries:this.state.releaseSeries})}}j.displayName="ReleaseSeries";const S=(0,a.withRouter)((0,Z.Z)((0,b.Z)((0,i.d)(j))))},"./app/components/charts/transitionChart.tsx":(e,t,s)=>{s.d(t,{Z:()=>l});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),a=s("./app/components/charts/loadingPanel.tsx"),i=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class n extends o.Component{constructor(){super(...arguments),(0,r.Z)(this,"state",{prevReloading:this.props.reloading,prevLoading:this.props.loading,key:1})}static getDerivedStateFromProps(e,t){const s=t.prevReloading,r=e.reloading,o=t.prevLoading,a=e.loading;return o!==a?{prevReloading:r,prevLoading:a,key:t.key+1}:a?{prevReloading:r,prevLoading:a,key:t.key}:s&&!r?{prevReloading:r,prevLoading:a,key:t.key+1}:{prevReloading:r,prevLoading:a,key:t.key}}render(){const{height:e,loading:t,reloading:s}=this.props;return t&&!s?(0,i.tZ)(a.Z,{height:e,"data-test-id":"events-request-loading"}):(0,i.tZ)(o.Fragment,{children:this.props.children},String(this.state.key))}}n.displayName="TransitionChart",(0,r.Z)(n,"defaultProps",{height:"200px"});const l=n},"./app/components/charts/transparentLoadingMask.tsx":(e,t,s)=>{s.d(t,{Z:()=>i});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=s("./app/components/loadingMask.tsx"),a=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const i=(0,r.Z)((e=>{let{className:t,visible:s,children:r,...i}=e;const n=s?{...i,"data-test-id":"loading-placeholder"}:i;return(0,a.tZ)(o.Z,{className:t,...n,children:r})}),{target:"ewtkxp50"})((e=>!e.visible&&"display: none;"),";opacity:0.4;z-index:1;")},"./app/components/charts/worldMapChart.tsx":(e,t,s)=>{s.d(t,{y:()=>u}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=s("../node_modules/react/index.js"),o=s("../node_modules/@emotion/react/dist/emotion-element-cbed451f.browser.esm.js"),a=s("../node_modules/echarts/core.js"),i=s("../node_modules/echarts/lib/core/echarts.js"),n=s("../node_modules/lodash/max.js"),l=s.n(n),d=s("./app/components/charts/components/visualMap.tsx");s("../node_modules/echarts/lib/chart/map.js");var p=s("./app/components/charts/baseChart.tsx"),c=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function u(e){let{series:t,seriesOptions:n,fromDiscover:u,fromDiscoverQueryList:m,...h}=e;const v=(0,o.a)(),[g,y]=(0,r.useState)((()=>({countryToCodeMap:null,map:null,codeToCountryMap:null})));if((0,r.useEffect)((()=>{let e=!1;return e||async function(){try{var e;const[t,r]=await Promise.all([s.e("app_data_countryCodesMap_tsx").then(s.bind(s,"./app/data/countryCodesMap.tsx")),s.e("app_data_world_json").then(s.t.bind(s,"./app/data/world.json",19))]),o=t.default,n=r.default;null===(e=i.je)||void 0===e||e.call(a,"sentryWorld",n);const l={};for(const e in n)l[o[e]]=e;y({countryToCodeMap:o,map:n,codeToCountryMap:l})}catch{}}(),()=>{e=!0}}),[]),null===g.countryToCodeMap||null===g.map)return null;const x=t.map((e=>{var t;let{seriesName:s,data:r,...o}=e;return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{map:""};return{roam:!0,...e,emphasis:{label:{show:!1},...e.emphasis},type:"map"}}({...n,...o,map:"sentryWorld",name:s,nameMap:null!==(t=g.countryToCodeMap)&&void 0!==t?t:void 0,aspectScale:.85,zoom:u?1.1:m?.9:1.3,center:[10.97,m?-12:9.71],itemStyle:{areaColor:v.gray200,borderColor:v.backgroundSecondary},emphasis:{itemStyle:{areaColor:v.pink300},label:{show:!1}},data:r,silent:m,roam:!m})})),f=l()(t.map((e=>{let{data:t}=e;return l()(t.map((e=>{let{value:t}=e;return t})))})))||1;return(0,c.tZ)(p.Z,{options:{backgroundColor:m?void 0:v.background,visualMap:[(0,d.Z)({show:!m,left:u?void 0:"right",right:u?5:void 0,min:0,max:f,inRange:{color:[v.purple200,v.purple300]},text:["High","Low"],textStyle:{color:v.textColor},calculable:!1})]},...h,yAxis:null,xAxis:null,series:x,tooltip:{formatter:e=>{var t;const{marker:s,name:r,value:o}=Array.isArray(e)?e[0]:e;if(isNaN(o))return"";const a="number"==typeof o?o.toLocaleString():"";return[`<div class="tooltip-series tooltip-series-solo">\n               <div><span class="tooltip-label">${s} <strong>${(null===(t=g.codeToCountryMap)||void 0===t?void 0:t[r])||r}</strong></span> ${a}</div>\n            </div>`,'<div class="tooltip-arrow"></div>'].join("")}},height:u?400:void 0})}u.displayName="WorldMapChart"}}]);
//# sourceMappingURL=../sourcemaps/app_components_charts_eventsChart_tsx-app_components_charts_optionSelector_tsx.a46756ec1735e708a4e15d91b4548c5e.js.map