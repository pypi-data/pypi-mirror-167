"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_dashboardsV2_view_tsx"],{"./app/views/dashboardsV2/orgDashboards.tsx":(e,s,a)=>{a.d(s,{Z:()=>v});var t=a("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=(a("../node_modules/core-js/modules/web.dom-collections.iterator.js"),a("../node_modules/core-js/modules/es.array.includes.js"),a("../node_modules/core-js/modules/es.string.replace.js"),a("../node_modules/react-router/es/index.js")),r=a("../node_modules/lodash/isEmpty.js"),d=a.n(r),n=a("../node_modules/lodash/isEqual.js"),i=a.n(n),p=a("./app/components/asyncComponent.tsx"),l=a("./app/components/errors/notFound.tsx"),u=a("./app/components/loadingIndicator.tsx"),c=a("./app/components/sentryDocumentTitle.tsx"),h=a("./app/locale.tsx"),b=a("./app/styles/organization.tsx"),m=a("./app/utils/analytics.tsx"),g=a("./app/views/dashboardsV2/layoutUtils.tsx"),y=a("./app/views/dashboardsV2/utils.tsx"),x=a("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class w extends p.Z{constructor(){super(...arguments),(0,t.Z)(this,"state",{loading:!0,reloading:!1,error:!1,errors:{},dashboards:[],selectedDashboard:null})}componentDidUpdate(e){i()(e.params.dashboardId,this.props.params.dashboardId)||this.remountComponent()}getEndpoints(){const{organization:e,params:s}=this.props,a=`/organizations/${e.slug}/dashboards/`,t=[["dashboards",a]];return s.dashboardId&&(t.push(["selectedDashboard",`${a}${s.dashboardId}/`]),(0,m.ec)({eventKey:"dashboards2.view",eventName:"Dashboards2: View dashboard",organization_id:parseInt(this.props.organization.id,10),dashboard_id:s.dashboardId})),t}onDashboardUpdate(e){this.setState({selectedDashboard:e})}getDashboards(){const{dashboards:e}=this.state;return Array.isArray(e)?e:[]}onRequestSuccess(e){let{stateKey:s,data:a}=e;const{params:t,organization:r,location:n}=this.props;if(t.dashboardId||"selectedDashboard"===s){const e=new Set(["project","environment","statsPeriod","start","end","utc","release"]);return void(r.features.includes("dashboards-top-level-filter")&&"selectedDashboard"===s&&(0,y.Lo)(a)&&d()(Object.keys(n.query).filter((s=>e.has(s))))&&o.browserHistory.replace({...n,query:{...n.query,project:a.projects,environment:a.environment,statsPeriod:a.period,start:a.start,end:a.end,utc:a.utc}}))}const i=a.length?a[0].id:"default-overview",p=`/organizations/${r.slug}/dashboard/${i}/`;o.browserHistory.replace({pathname:p,query:{...n.query}})}renderLoading(){return(0,x.tZ)(b.JH,{children:(0,x.tZ)(u.Z,{})})}renderBody(){const{children:e,organization:s}=this.props,{selectedDashboard:a,error:t}=this.state;let o=a;return s.features.includes("dashboard-grid-layout")&&(o=a?{...a,widgets:a.widgets.map(g.TE)}:null),e({error:t,dashboard:o,dashboards:this.getDashboards(),onDashboardUpdate:e=>this.onDashboardUpdate(e)})}renderError(e){return Object.values(this.state.errors).find((e=>e&&404===e.status))?(0,x.tZ)(l.Z,{}):super.renderError(e,!0)}renderComponent(){const{organization:e,location:s}=this.props,{loading:a,selectedDashboard:t}=this.state;return e.features.includes("dashboards-basic")?a&&e.features.includes("dashboards-top-level-filter")&&t&&(0,y.Lo)(t)&&d()(s.query)?this.renderLoading():(0,x.tZ)(c.Z,{title:(0,h.t)("Dashboards"),orgSlug:e.slug,children:super.renderComponent()}):(o.browserHistory.replace({pathname:`/organizations/${e.slug}/dashboards/`,query:{...s.query}}),null)}}const v=w},"./app/views/dashboardsV2/view.tsx":(e,s,a)=>{a.r(s),a.d(s,{DashboardBasicFeature:()=>_,default:()=>f}),a("../node_modules/core-js/modules/web.dom-collections.iterator.js"),a("../node_modules/core-js/modules/es.string.replace.js");var t=a("../node_modules/react/index.js"),o=a("../node_modules/react-router/es/index.js"),r=a("../node_modules/lodash/pick.js"),d=a.n(r),n=a("./app/actionCreators/dashboards.tsx"),i=a("./app/components/acl/feature.tsx"),p=a("./app/components/alert.tsx"),l=a("./app/components/errorBoundary.tsx"),u=a("./app/components/errors/notFound.tsx"),c=a("./app/components/loadingIndicator.tsx"),h=a("./app/locale.tsx"),b=a("./app/styles/organization.tsx"),m=a("./app/utils/useApi.tsx"),g=a("./app/utils/withOrganization.tsx"),y=a("./app/views/dashboardsV2/detail.tsx"),x=a("./app/views/dashboardsV2/orgDashboards.tsx"),w=a("./app/views/dashboardsV2/types.tsx"),v=a("./app/views/dashboardsV2/utils.tsx"),j=a("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const Z=["start","end","utc","period","project","environment","statsPeriod"];function D(e){const s=(0,m.Z)(),{organization:a,params:r,location:i}=e,p=r.dashboardId,h=a.slug,[b,g]=(0,t.useState)(),[D,f]=(0,t.useState)(w.n3.VIEW);return(0,t.useEffect)((()=>{p&&"default-overview"!==p&&(0,n.a_)(s,h,p)}),[s,h,p]),(0,t.useEffect)((()=>{const e=(0,v.y1)(i.query);g(e),e&&(f(w.n3.EDIT),o.browserHistory.replace({pathname:i.pathname,query:d()(i.query,Z)}))}),[i.pathname]),(0,j.tZ)(_,{organization:a,children:(0,j.tZ)(x.Z,{api:s,location:i,params:r,organization:a,children:s=>{let{dashboard:a,dashboards:t,error:o,onDashboardUpdate:r}=s;return o?(0,j.tZ)(u.Z,{}):a?(0,j.tZ)(l.Z,{children:(0,j.tZ)(y.Z,{...e,initialState:D,dashboard:a,dashboards:t,onDashboardUpdate:r,newWidget:b,onSetNewWidget:()=>g(void 0)})}):(0,j.tZ)(c.Z,{})}})})}D.displayName="ViewEditDashboard";const f=(0,g.Z)(D),_=e=>{let{organization:s,children:a}=e;return(0,j.tZ)(i.Z,{hookName:"feature-disabled:dashboards-page",features:["organizations:dashboards-basic"],organization:s,renderDisabled:()=>(0,j.tZ)(b.JH,{children:(0,j.tZ)(p.Z,{type:"warning",children:(0,h.t)("You don't have access to this feature")})}),children:a})};_.displayName="DashboardBasicFeature"}}]);
//# sourceMappingURL=../sourcemaps/app_views_dashboardsV2_view_tsx.1b52582cd1ebec6cc71a77f1ce6cb297.js.map