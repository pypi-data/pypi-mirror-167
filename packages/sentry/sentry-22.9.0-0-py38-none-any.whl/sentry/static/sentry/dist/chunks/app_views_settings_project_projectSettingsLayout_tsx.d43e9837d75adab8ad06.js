"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_settings_project_projectSettingsLayout_tsx"],{"./app/components/projects/appStoreConnectContext.tsx":(e,t,o)=>{o.d(t,{Z:()=>p,z:()=>c}),o("../node_modules/core-js/modules/web.dom-collections.iterator.js");var s=o("../node_modules/react/index.js"),r=o("./app/utils/appStoreValidationErrorMessage.tsx"),n=o("./app/utils/useApi.tsx"),i=o("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const a=(0,s.createContext)(void 0),c=e=>{let{children:t,project:o,organization:c}=e;const p=(0,n.Z)(),[l,d]=(0,s.useState)(),[u,m]=(0,s.useState)(void 0),h=(0,s.useMemo)((()=>(null!=l&&l.symbolSources?JSON.parse(l.symbolSources):[]).reduce(((e,t)=>{let{type:o,id:s,...r}=t;return"appstoreconnect"===o.toLowerCase()&&(e[s]={type:o,...r}),e}),{})),[null==l?void 0:l.symbolSources]);function j(e,t){if("valid"!==(null==t?void 0:t.status))return(0,r.e)(t,e)}return(0,s.useEffect)((()=>{if(!o||l)return;if(o.symbolSources)return void d(o);let e=!1;return p.requestPromise(`/projects/${c.slug}/${o.slug}/`).then((t=>{e||d(t)})).catch((()=>{})),()=>{e=!0}}),[o,c,p]),(0,s.useEffect)((()=>{if(!l)return;if(!Object.keys(h).length)return;let e=!1;return p.requestPromise(`/projects/${c.slug}/${l.slug}/appstoreconnect/status/`).then((t=>{e||m(t)})).catch((()=>{})),()=>{e=!0}}),[l,c,h,p]),(0,i.tZ)(a.Provider,{value:u&&o?Object.keys(u).reduce(((e,t)=>{const s=u[t];return{...e,[t]:{...s,updateAlertMessage:j({name:h[t].name,link:`/settings/${c.slug}/projects/${o.slug}/debug-symbols/?customRepository=${t}`},s.credentials)}}}),{}):void 0,children:t})};c.displayName="Provider";const p=a},"./app/utils/appStoreValidationErrorMessage.tsx":(e,t,o)=>{o.d(t,{O:()=>a,e:()=>c}),o("../node_modules/core-js/modules/es.error.cause.js");var s=o("../node_modules/@sentry/hub/esm/exports.js"),r=o("./app/components/links/link.tsx"),n=o("./app/locale.tsx"),i=o("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const a=(0,n.t)("An unexpected error occurred while configuring the App Store Connect integration");function c(e,t){switch(e.code){case"app-connect-authentication-error":return t?(0,n._N)("App Store Connect credentials are invalid or missing. [linkToCustomRepository]",{linkToCustomRepository:(0,i.tZ)(r.Z,{to:t.link,children:(0,n._N)("Make sure the credentials of the '[customRepositoryName]' repository are correct and exist.",{customRepositoryName:t.name})})}):(0,n.t)("The supplied App Store Connect credentials are invalid or missing.");case"app-connect-forbidden-error":return(0,n.t)("The supplied API key does not have sufficient permissions.");case"app-connect-multiple-sources-error":return(0,n.t)("Only one App Store Connect application is allowed in this project.");default:return s.Tb(new Error("Unknown app store connect error.")),a}}},"./app/views/settings/project/projectSettingsLayout.tsx":(e,t,o)=>{o.r(t),o.d(t,{default:()=>k});var s,r=o("../node_modules/react/index.js"),n=o("./app/components/projects/appStoreConnectContext.tsx"),i=o("./app/utils/withOrganization.tsx"),a=o("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),c=o("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),p=(o("../node_modules/core-js/modules/web.dom-collections.iterator.js"),o("../node_modules/react-document-title/index.js")),l=o.n(p),d=o("./app/actionCreators/members.tsx"),u=o("./app/actionCreators/projects.tsx"),m=o("./app/components/loadingError.tsx"),h=o("./app/components/loadingIndicator.tsx"),j=o("./app/components/projects/missingProjectMembership.tsx"),g=o("./app/locale.tsx"),y=o("./app/sentryTypes.tsx"),f=o("./app/stores/memberListStore.tsx"),x=o("./app/stores/projectsStore.tsx"),S=o("./app/styles/space.tsx"),b=o("./app/utils/withApi.tsx"),Z=o("./app/utils/withProjects.tsx"),v=o("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");!function(e){e.MISSING_MEMBERSHIP="MISSING_MEMBERSHIP",e.PROJECT_NOT_FOUND="PROJECT_NOT_FOUND",e.UNKNOWN="UNKNOWN"}(s||(s={}));class N extends r.Component{constructor(){super(...arguments),(0,a.Z)(this,"state",this.getInitialState()),(0,a.Z)(this,"docTitleRef",(0,r.createRef)()),(0,a.Z)(this,"unsubscribeProjects",x.Z.listen((e=>this.onProjectChange(e)),void 0)),(0,a.Z)(this,"unsubscribeMembers",f.Z.listen((e=>this.setState({memberList:e})),void 0))}getInitialState(){return{loading:!0,error:!1,errorType:null,memberList:[],project:null}}getChildContext(){return{project:this.state.project}}componentDidMount(){const{loadingProjects:e}=this.props;e||this.fetchData()}componentWillReceiveProps(e){e.projectId!==this.props.projectId&&(e.skipReload||this.remountComponent())}componentDidUpdate(e,t){if(e.projectId!==this.props.projectId&&this.fetchData(),e.projects.length!==this.props.projects.length&&this.fetchData(),t.project!==this.state.project){const e=this.docTitleRef.current;if(!e)return;e.forceUpdate()}}componentWillUnmount(){this.unsubscribeMembers(),this.unsubscribeProjects()}remountComponent(){this.setState(this.getInitialState())}getTitle(){var e,t;return null!==(e=null===(t=this.state.project)||void 0===t?void 0:t.slug)&&void 0!==e?e:"Sentry"}onProjectChange(e){this.state.project&&e.has(this.state.project.id)&&this.setState({project:{...x.Z.getById(this.state.project.id)}})}identifyProject(){const{projects:e,projectId:t}=this.props,o=t;return e.find((e=>{let{slug:t}=e;return t===o}))||null}async fetchData(){const{orgId:e,projectId:t,skipReload:o}=this.props,r=this.identifyProject(),n=r&&r.hasAccess;if(this.setState((e=>({loading:!o||e.loading,project:r}))),r&&n){(0,u.pK)(null);const o=this.props.api.requestPromise(`/projects/${e}/${t}/`);try{const e=await o;this.setState({loading:!1,project:e,error:!1,errorType:null}),(0,u.pK)(e)}catch(e){this.setState({loading:!1,error:!1,errorType:s.UNKNOWN})}(0,d.MA)(this.props.api,e,[r.id])}else if(!r||r.isMember)try{await this.props.api.requestPromise(`/projects/${e}/${t}/`)}catch(e){this.setState({loading:!1,error:!0,errorType:s.PROJECT_NOT_FOUND})}else this.setState({loading:!1,error:!0,errorType:s.MISSING_MEMBERSHIP})}renderBody(){const{children:e,organization:t}=this.props,{error:o,errorType:r,loading:n,project:i}=this.state;if(n)return(0,v.tZ)("div",{className:"loading-full-layout",children:(0,v.tZ)(h.Z,{})});if(!o&&i)return"function"==typeof e?e({project:i}):e;switch(r){case s.PROJECT_NOT_FOUND:return(0,v.tZ)("div",{className:"container",children:(0,v.tZ)("div",{className:"alert alert-block",style:{margin:"30px 0 10px"},children:(0,g.t)("The project you were looking for was not found.")})});case s.MISSING_MEMBERSHIP:return(0,v.tZ)(C,{children:(0,v.tZ)(j.Z,{organization:t,project:i})});default:return(0,v.tZ)(m.Z,{onRetry:this.remountComponent})}}render(){return(0,v.tZ)(l(),{ref:this.docTitleRef,title:this.getTitle(),children:this.renderBody()})}}N.displayName="ProjectContext",(0,a.Z)(N,"childContextTypes",{project:y.Z.Project});const w=(0,b.Z)((0,i.Z)((0,Z.Z)(N))),C=(0,c.Z)("div",{target:"e1ekcf660"})("width:100%;margin:",(0,S.Z)(2)," ",(0,S.Z)(4),";");var P=o("./app/views/settings/components/settingsLayout.tsx"),_=o("./app/utils/withProject.tsx"),I=o("./app/views/settings/components/settingsNavigation.tsx"),T=o("./app/views/settings/project/navigationConfiguration.tsx");const M=e=>{let{organization:t,project:o}=e;const s=(0,r.useContext)(n.Z),i=!!s&&Object.keys(s).some((e=>"invalid"===s[e].credentials.status));return(0,v.tZ)(I.Z,{navigationObjects:(0,T.Z)({project:o,organization:t,debugFilesNeedsReview:i}),access:new Set(t.access),features:new Set(t.features),organization:t,project:o})};M.displayName="ProjectSettingsNavigation";const O=(0,_.Z)(M);function R(e){let{params:t,organization:o,children:s,routes:i,...a}=e;const{orgId:c,projectId:p}=t;return(0,v.tZ)(w,{orgId:c,projectId:p,children:e=>{let{project:c}=e;return(0,v.tZ)(n.z,{project:c,organization:o,children:(0,v.tZ)(P.Z,{params:t,routes:i,...a,renderNavigation:()=>(0,v.tZ)(O,{organization:o}),children:s&&(0,r.isValidElement)(s)?(0,r.cloneElement)(s,{organization:o,project:c}):s})})}})}R.displayName="ProjectSettingsLayout";const k=(0,i.Z)(R)}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_project_projectSettingsLayout_tsx.85b238de667cefd852960614c69565c6.js.map