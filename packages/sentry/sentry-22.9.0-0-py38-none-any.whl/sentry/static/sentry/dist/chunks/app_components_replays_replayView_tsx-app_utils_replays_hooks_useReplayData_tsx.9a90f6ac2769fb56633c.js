"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_replays_replayView_tsx-app_utils_replays_hooks_useReplayData_tsx"],{"./app/components/replays/player/scrubber.tsx":(e,t,r)=>{r.d(t,{i:()=>v,M:()=>x});var s=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=r("./app/components/forms/controls/rangeSlider/index.tsx"),n=r("./app/components/forms/controls/rangeSlider/sliderAndInputWrapper.tsx");const o=(0,s.Z)("div",{target:"e1f3gzxp1"})({name:"1pv11yg",styles:"position:relative;height:100%;width:100%;pointer-events:none"}),i=(0,s.Z)("span",{target:"e1f3gzxp0"})("position:absolute;height:100%;width:",(e=>100*e.percent),"%;pointer-events:none;");var l=r("./app/components/replays/replayContext.tsx"),d=r("./app/components/replays/utils.tsx"),c=r("./app/styles/space.tsx"),u=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function p(e){let{className:t}=e;const{currentHoverTime:r,currentTime:s,replay:a,setCurrentTime:n}=(0,l.M)(),o=null==a?void 0:a.getDurationMs(),i=(0,d.cs)(s,o),c=(0,d.cs)(r||0,o);return(0,u.BX)(f,{className:t,children:[(0,u.BX)(m,{children:[r?(0,u.tZ)(y,{percent:c}):null,(0,u.tZ)(b,{percent:i})]}),(0,u.tZ)(h,{children:(0,u.tZ)(g,{name:"replay-timeline",min:0,max:o,value:Math.round(s),onChange:e=>n(e||0),showLabel:!1})})]})}p.displayName="Scrubber";const m=(0,s.Z)(o,{target:"e138nie77"})("background:",(e=>e.theme.gray200),";"),h=(0,s.Z)("div",{target:"e138nie76"})({name:"1aubja5",styles:"overflow:hidden;width:100%"}),g=(0,s.Z)(a.Z,{target:"e138nie75"})({name:"rjtouz",styles:"input{cursor:pointer;opacity:0;height:100%;&::-webkit-slider-thumb{height:0px;width:0px;}&::-moz-range-thumb{height:0px;width:0px;}&::-ms-thumb{height:0px;width:0px;}}"}),b=(0,s.Z)(i,{target:"e138nie74"})(""),y=(0,s.Z)(i,{target:"e138nie73"})(""),f=(0,s.Z)("div",{target:"e138nie72"})({name:"1n0uila",styles:"position:relative;width:100%;&>*{position:absolute;top:0;left:0;}"}),x=(0,s.Z)(p,{target:"e138nie71"})("height:100%;",m,"{background:transparent;}",h,",",g,",",n.Z,"{height:100%;}",b,"{background:",(e=>e.theme.purple100),';border-top-left-radius:3px;border-bottom-left-radius:3px;}/**\n   * Draw lines so users can see the currenTime & their mouse position\n   * "----|----|--------------------- duration = 1:00"\n   *      ^    ^\n   *      |    PlaybackTimeValue @ 20s\n   *      MouseTrackingValue @ 10s\n   */',b,",",y,"{border-right:",(0,c.Z)(.25)," solid ",(e=>e.theme.purple300),";}"),v=(0,s.Z)(p,{target:"e138nie70"})("height:",(0,c.Z)(.5),";:hover{margin-block:-",(0,c.Z)(.25),";height:",(0,c.Z)(1),";}",m,"{border-radius:",(e=>e.theme.borderRadiusBottom),";}",h,"{height:",(0,c.Z)(.5),";}:hover ",h,"{height:",(0,c.Z)(.75),";}",b,"{background:",(e=>e.theme.purple200),";border-bottom-left-radius:",(e=>e.theme.borderRadius),';}/**\n   * Draw the circle (appears on hover) to mark the currentTime of the video\n   * "---------o-------------------- duration = 1:00"\n   *           ^\n   *           PlaybackTimeValue @ 20s\n   */',b,":after{content:'';display:block;width:",(0,c.Z)(2),";height:",(0,c.Z)(2),";z-index:",(e=>e.theme.zIndex.initial),";pointer-events:none;background:",(e=>e.theme.purple300),";box-sizing:content-box;border-radius:",(0,c.Z)(2),";border:solid ",(e=>e.theme.white),";border-width:",(0,c.Z)(.5),";position:absolute;top:-",(0,c.Z)(1),";right:-",(0,c.Z)(1.5),";opacity:0;transition:opacity 0.1s ease;}:hover ",b,':after{opacity:1;}/*\n   * Draw a square so users can see their mouse position when it is left or right of the currentTime\n   * "----â–¡----o--------------------- duration = 1:00"\n   *      ^    ^\n   *      |    PlaybackTimeValue @ 20s\n   *      MouseTrackingValue @ 10s\n   */',y,":after{content:'';display:block;width:",(0,c.Z)(.5),";height:",(0,c.Z)(1.5),";pointer-events:none;background:",(e=>e.theme.purple200),";box-sizing:content-box;position:absolute;top:-",(0,c.Z)(.5),";right:-1px;}:hover ",y,":after{height:",(0,c.Z)(2),";top:-",(0,c.Z)(.5),";}")},"./app/components/replays/player/scrubberMouseTracking.tsx":(e,t,r)=>{r.d(t,{Z:()=>l});var s=r("../node_modules/react/index.js"),a=r("./app/components/replays/replayContext.tsx"),n=r("./app/utils/replays/hooks/useMouseTracking.tsx"),o=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function i(e){let{children:t}=e;const{replay:r,setCurrentHoverTime:i}=(0,a.M)(),l=null==r?void 0:r.getDurationMs(),d=(0,s.useCallback)((e=>{if(!e||void 0===l)return void i(void 0);const{left:t,width:r}=e;i(t>=0?t/r*l:void 0)}),[l,i]),c=(0,n.Z)({onPositionChange:d});return(0,o.tZ)("div",{...c,children:t})}i.displayName="ScrubberMouseTracking";const l=i},"./app/components/replays/replayView.tsx":(e,t,r)=>{r.d(t,{Z:()=>K});var s=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=r("../node_modules/react/index.js"),n=r("./app/components/replays/player/scrubber.tsx"),o=r("./app/components/replays/player/scrubberMouseTracking.tsx"),i=(r("../node_modules/core-js/modules/es.array.includes.js"),r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("../node_modules/@react-aria/utils/dist/module.js")),l=r("./app/components/button.tsx"),d=r("./app/components/buttonBar.tsx"),c=r("./app/components/forms/compositeSelect.tsx"),u=r("./app/components/replays/replayContext.tsx"),p=r("./app/components/replays/utils.tsx"),m=r("./app/icons/index.tsx"),h=r("./app/locale.tsx"),g=r("./app/styles/space.tsx"),b=r("./app/types/breadcrumbs.tsx"),y=r("./app/utils/replays/getBreadcrumb.tsx"),f=r("./app/utils/replays/hooks/useFullscreen.tsx"),x=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const v=[b.kS.ERROR,b.kS.INIT,b.kS.NAVIGATION,b.kS.UI,b.kS.USER];function Z(e){let{isCompact:t}=e;const{currentTime:r,isFinished:s,isPlaying:a,replay:n,restart:o,setCurrentTime:i,togglePlayPause:c}=(0,u.M)();return(0,x.BX)(d.ZP,{merged:!0,children:[!t&&(0,x.tZ)(l.ZP,{size:"sm",title:(0,h.t)("Rewind 10s"),icon:(0,x.tZ)(m.A0,{size:"sm"}),onClick:()=>i(r-1e4),"aria-label":(0,h.t)("Rewind 10 seconds")}),s?(0,x.tZ)(l.ZP,{size:"sm",title:(0,h.t)("Restart Replay"),icon:(0,x.tZ)(m.sm,{size:"sm"}),onClick:o,"aria-label":(0,h.t)("Restart Replay")}):(0,x.tZ)(l.ZP,{size:"sm",title:a?(0,h.t)("Pause"):(0,h.t)("Play"),icon:a?(0,x.tZ)(m.ky,{size:"sm"}):(0,x.tZ)(m.JF,{size:"sm"}),onClick:()=>c(!a),"aria-label":a?(0,h.t)("Pause"):(0,h.t)("Play")}),!t&&(0,x.tZ)(l.ZP,{size:"sm",title:(0,h.t)("Next breadcrumb"),icon:(0,x.tZ)(m.pi,{size:"sm"}),onClick:()=>{var e;const t=null==n||null===(e=n.getReplay().startedAt)||void 0===e?void 0:e.getTime();if(!t)return;const s=(null==n?void 0:n.getRawCrumbs())||[],a=(0,y.q)({crumbs:s.filter((e=>v.includes(e.type))),targetTimestampMs:t+r});void 0!==t&&null!=a&&a.timestamp&&i((0,p.NH)(a.timestamp,t))},"aria-label":(0,h.t)("Fast-forward to next breadcrumb")})]})}function w(){const{currentTime:e,replay:t}=(0,u.M)(),r=null==t?void 0:t.getDurationMs();return(0,x.BX)("span",{children:[(0,p.mr)(e)," / ",r?(0,p.mr)(r):"--:--"]})}function k(e){let{speedOptions:t}=e;const{setSpeed:r,speed:s,isSkippingInactive:a,toggleSkipInactive:n}=(0,u.M)(),o="skip";return(0,x.tZ)(c.Z,{placement:"bottom",trigger:e=>{let{props:t,ref:r}=e;return(0,x.tZ)(l.ZP,{ref:r,...t,size:"sm",title:(0,h.t)("Settings"),"aria-label":(0,h.t)("Settings"),icon:(0,x.tZ)(m.iC,{size:"sm"})})},sections:[{defaultValue:s,label:(0,h.t)("Playback Speed"),value:"playback_speed",onChange:r,options:t.map((e=>({label:`${e}x`,value:e})))},{multiple:!0,defaultValue:a?[o]:[],label:"",value:"fast_forward",onChange:e=>{n(e.length>0)},options:[{label:(0,h.t)("Fast-forward inactivity"),value:o}]}]})}Z.displayName="ReplayPlayPauseBar",w.displayName="ReplayCurrentTime",k.displayName="ReplayOptionsMenu";const M=e=>{let{toggleFullscreen:t=(()=>{}),speedOptions:r=[.1,.25,.5,1,2,4]}=e;const s=(0,a.useRef)(null),[n,o]=(0,a.useState)(0),{isFullscreen:d}=(0,f.Z)(),c=(0,a.useCallback)((()=>{var e,t;const{width:r}=null!==(e=null===(t=s.current)||void 0===t?void 0:t.getBoundingClientRect())&&void 0!==e?e:{width:500};o(r<400?1:0)}),[]);return(0,i.yU)({ref:s,onResize:c}),(0,a.useLayoutEffect)((()=>c),[c]),(0,x.BX)(j,{ref:s,children:[(0,x.tZ)(Z,{isCompact:n>0}),(0,x.tZ)(w,{}),(0,x.tZ)(k,{speedOptions:r}),(0,x.tZ)(l.ZP,{size:"sm",title:d?(0,h.t)("Exit full screen"):(0,h.t)("Enter full screen"),"aria-label":d?(0,h.t)("Exit full screen"):(0,h.t)("Enter full screen"),icon:d?(0,x.tZ)(m.pC,{size:"sm"}):(0,x.tZ)(m.qp,{size:"sm"}),onClick:t})]})};M.displayName="ReplayControls";const j=(0,s.Z)("div",{target:"e1ryc6sl0"})("display:grid;grid-column-gap:",(0,g.Z)(1),";grid-template-columns:max-content auto max-content max-content;align-items:center;"),R=M;var S=r("./app/components/forms/textCopyInput.tsx"),C=(r("../node_modules/core-js/modules/web.url.js"),r("../node_modules/core-js/modules/web.url-search-params.js"),r("../node_modules/lodash/last.js")),T=r.n(C);const E=function(e,t,r){var s,a;const n=e.startedAt.getTime()+Math.floor(r),o=t.filter((e=>e.type===b.kS.NAVIGATION)),i=e.urls[0],l=i?new URL(i).origin:"",d=null===(s=T()(o.filter((e=>{let{timestamp:t}=e;return+new Date(t||0)<=n}))))||void 0===s||null===(a=s.data)||void 0===a?void 0:a.to;if(!d)return l;try{const e=new URL(d);return String(e)}catch{return l+d}};function I(){const{currentTime:e,replay:t}=(0,u.M)();if(!t)return(0,x.tZ)(z,{size:"sm",disabled:!0,children:""});const r=t.getReplay(),s=t.getRawCrumbs();return(0,x.tZ)(z,{size:"sm",children:E(r,s,e)})}I.displayName="ReplayCurrentUrl";const z=(0,s.Z)(S.ZP,{target:"evzcn0b0"})("font-size:",(e=>e.theme.fontSizeMedium),";column-gap:",(0,g.Z)(1),";",S.Fy,"{border-right-width:1px;border-radius:0.25em;background-color:",(e=>e.theme.background),";border-right-color:",(e=>e.theme.border),";&:hover,&:focus{border-right-width:1px;background-color:",(e=>e.theme.background),";}}",S.qR,"{border-radius:0.25em;}"),N=I;function P(e){let{className:t}=e;return(0,x.tZ)(_,{className:t,children:(0,x.BX)(D,{children:[(0,x.tZ)(m.jo,{size:"sm"}),(0,h.t)("Buffering...")]})})}P.displayName="BufferingOverlay";const _=(0,s.Z)("div",{target:"e1tth60i1"})({name:"1p9eycc",styles:"user-select:none;display:grid;place-items:center"}),D=(0,s.Z)("div",{target:"e1tth60i0"})("display:grid;grid-template-columns:max-content max-content;gap:",(0,g.Z)(.75),";place-items:center;padding:",(0,g.Z)(3),";background:",(e=>e.theme.gray300),";border-radius:",(e=>e.theme.borderRadius),";color:",(e=>e.theme.white),";z-index:",(e=>e.theme.zIndex.initial),";"),A=P;var B=r("./app/components/tooltip.tsx");function O(e){let{speed:t,className:r}=e;return(0,x.tZ)(L,{className:r,children:(0,x.BX)(F,{title:(0,h.t)("Fast forwarding"),children:[(0,x.tZ)(m.CC,{size:"sm",direction:"right"}),t,"x"]})})}O.displayName="FastForwardBadge";const L=(0,s.Z)("div",{target:"e1135tm81"})({name:"8y7axy",styles:"user-select:none;display:grid;align-items:end;justify-items:start"}),F=(0,s.Z)(B.Z,{target:"e1135tm80"})("display:grid;grid-template-columns:max-content max-content;gap:",(0,g.Z)(.5),";align-items:center;background:",(e=>e.theme.gray300),";color:",(e=>e.theme.white),";padding:",(0,g.Z)(1.5)," ",(0,g.Z)(2),";border-top-right-radius:",(e=>e.theme.borderRadius),";z-index:",(e=>e.theme.zIndex.initial),";"),q=O;function V(e){let{className:t}=e;const{initRoot:r,dimensions:s,fastForwardSpeed:n,isBuffering:o}=(0,u.M)(),l=(0,a.useRef)(null),d=(0,a.useRef)(null),[c,p]=(0,a.useState)({width:0,height:0});(0,a.useEffect)((()=>r(d.current)),[r]);const m=(0,a.useCallback)((()=>{var e,t;return p({width:(null===(e=l.current)||void 0===e?void 0:e.clientWidth)||0,height:(null===(t=l.current)||void 0===t?void 0:t.clientHeight)||0})}),[p]);return(0,i.yU)({ref:l,onResize:m}),(0,a.useEffect)((()=>{void 0===window.ResizeObserver&&m()}),[m]),(0,a.useEffect)((()=>{if(d.current){const e=Math.min(c.width/s.width,c.height/s.height,1);e&&(d.current.style["transform-origin"]="top left",d.current.style.transform=`scale(${e})`,d.current.style.width=s.width*e+"px",d.current.style.height=s.height*e+"px")}}),[c,s]),(0,x.BX)(G,{ref:l,className:"sr-block",children:[(0,x.tZ)("div",{ref:d,className:t}),n?(0,x.tZ)(X,{speed:n}):null,o?(0,x.tZ)(H,{}):null]})}V.displayName="BasePlayerRoot";const G=(0,s.Z)("div",{target:"elabtru4"})("width:100%;display:flex;flex-grow:1;justify-content:center;align-items:center;position:relative;overflow:hidden;background-color:",(e=>e.theme.backgroundSecondary),";background-image:repeating-linear-gradient(\n      -145deg,\n      transparent,\n      transparent 8px,\n      ",(e=>e.theme.backgroundSecondary)," 8px,\n      ",(e=>e.theme.backgroundSecondary)," 11px\n    ),repeating-linear-gradient(\n      -45deg,\n      transparent,\n      transparent 15px,\n      ",(e=>e.theme.gray100)," 15px,\n      ",(e=>e.theme.gray100)," 16px\n    );"),X=(0,s.Z)(q,{target:"elabtru3"})({name:"m4y3yb",styles:"position:absolute;left:0;bottom:0"}),H=(0,s.Z)(A,{target:"elabtru2"})({name:"j2pfbl",styles:"position:absolute;top:0;left:0;right:0;bottom:0"}),U=(0,s.Z)(V,{target:"elabtru1"})({name:"1nx655q",styles:".replayer-wrapper{user-select:none;}.replayer-wrapper>.replayer-mouse-tail{position:absolute;pointer-events:none;}.replayer-wrapper>iframe{border:none;background:white;}"}),J=(0,s.Z)(U,{target:"elabtru0"})(".replayer-mouse{position:absolute;width:32px;height:32px;transition:left 0.05s linear,top 0.05s linear;background-size:contain;background-repeat:no-repeat;background-image:url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIiIGhlaWdodD0iMTkiIHZpZXdCb3g9IjAgMCAxMiAxOSIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTAgMTZWMEwxMS42IDExLjZINC44TDQuNCAxMS43TDAgMTZaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNOS4xIDE2LjdMNS41IDE4LjJMMC43OTk5OTkgNy4xTDQuNSA1LjZMOS4xIDE2LjdaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNNC42NzQ1MSA4LjYxODUxTDIuODMwMzEgOS4zOTI3MUw1LjkyNzExIDE2Ljc2OTVMNy43NzEzMSAxNS45OTUzTDQuNjc0NTEgOC42MTg1MVoiIGZpbGw9ImJsYWNrIi8+CjxwYXRoIGQ9Ik0xIDIuNFYxMy42TDQgMTAuN0w0LjQgMTAuNkg5LjJMMSAyLjRaIiBmaWxsPSJibGFjayIvPgo8L3N2Zz4K');border-color:transparent;}.replayer-mouse:after{content:'';display:inline-block;width:32px;height:32px;background:",(e=>e.theme.purple300),";border-radius:100%;transform:translate(-50%, -50%);opacity:0.3;}.replayer-mouse.active:after{animation:click 0.2s ease-in-out 1;}.replayer-mouse.touch-device{background-image:none;width:70px;height:70px;border-radius:100%;margin-left:-37px;margin-top:-37px;border:4px solid rgba(73, 80, 246, 0);transition:left 0s linear,top 0s linear,border-color 0.2s ease-in-out;}.replayer-mouse.touch-device.touch-active{border-color:",(e=>e.theme.purple200),";transition:left 0.25s linear,top 0.25s linear,border-color 0.2s ease-in-out;}.replayer-mouse.touch-device:after{opacity:0;}.replayer-mouse.touch-device.active:after{animation:touch-click 0.2s ease-in-out 1;}@keyframes click{0%{opacity:0.3;width:20px;height:20px;}50%{opacity:0.5;width:10px;height:10px;}}@keyframes touch-click{0%{opacity:0;width:20px;height:20px;}50%{opacity:0.5;width:10px;height:10px;}}");var W=r("./app/views/replays/detail/layout/fluidHeight.tsx");function $(e){let{toggleFullscreen:t,showAddressBar:r=!0}=e;return(0,x.BX)(a.Fragment,{children:[r&&(0,x.tZ)(N,{}),(0,x.BX)(Q,{children:[(0,x.tZ)(Y,{children:(0,x.tZ)(J,{})}),(0,x.tZ)(o.Z,{children:(0,x.tZ)(n.i,{})})]}),(0,x.tZ)(R,{toggleFullscreen:t})]})}$.displayName="ReplayView";const Q=(0,s.Z)(W.Z,{target:"e185m34i1"})("padding-bottom:",(0,g.Z)(1),";margin-bottom:-",(0,g.Z)(1),";"),Y=(0,s.Z)(W.Z,{target:"e185m34i0"})("background:",(e=>e.theme.background),";border-radius:",(e=>e.theme.borderRadiusTop),";border:1px solid ",(e=>e.theme.border),";border-bottom:none;box-shadow:",(e=>e.theme.dropShadowLight),";"),K=$},"./app/utils/replays/getBreadcrumb.tsx":(e,t,r)=>{function s(e){let{crumbs:t,targetTimestampMs:r,allowExact:s=!1,allowEqual:a=!1}=e;return t.reduce(((e,t)=>{const n=+new Date(t.timestamp||"");return n>r||!s&&n===r?e:!e||(a?n>=+new Date(e.timestamp||""):n>+new Date(e.timestamp||""))?t:e}),void 0)}function a(e){let{crumbs:t,targetTimestampMs:r,allowExact:s=!1}=e;return t.reduce(((e,t)=>{const a=+new Date(t.timestamp||"");return a<r||!s&&a===r?e:!e||a<+new Date(e.timestamp||"")?t:e}),void 0)}r.d(t,{F:()=>s,q:()=>a})},"./app/utils/replays/hooks/useFullscreen.tsx":(e,t,r)=>{r.d(t,{Z:()=>n}),r("../node_modules/core-js/modules/web.dom-collections.iterator.js");var s=r("../node_modules/react/index.js"),a=r("../node_modules/screenfull/index.js");function n(){const e=(0,s.useRef)(null),[t,r]=(0,s.useState)(!1),n=(0,s.useCallback)((async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{navigationUI:"auto"};a.Z.isEnabled&&e.current&&await a.Z.request(e.current,t)}),[]),o=(0,s.useCallback)((async()=>{a.Z.isEnabled&&await a.Z.exit()}),[]),i=(0,s.useCallback)((()=>t?o():n()),[n,o,t]),l=()=>{r(a.Z.isFullscreen)};return(0,s.useEffect)((()=>(a.Z.on("change",l),()=>a.Z.off("change",l))),[]),{enter:n,exit:o,isEnabled:a.Z.isEnabled,isFullscreen:t,ref:e,toggle:i}}},"./app/utils/replays/hooks/useMouseTracking.tsx":(e,t,r)=>{r.d(t,{Z:()=>o}),r("../node_modules/core-js/modules/es.error.cause.js"),r("../node_modules/core-js/modules/web.dom-collections.iterator.js");var s=r("../node_modules/react/index.js"),a=r("../node_modules/@sentry/hub/esm/exports.js");class n extends Error{}const o=function(e){let{onPositionChange:t,onMouseEnter:r,onMouseMove:o,onMouseLeave:i,...l}=e;const d=(0,s.useRef)(null),c=(0,s.useRef)(new AbortController),u=(0,s.useCallback)((async e=>{if(d.current)try{const r=await function(e,t){let{signal:r}=t;return new Promise(((t,s)=>{r.aborted&&s(new n);const a=()=>{s(new n)},o=new IntersectionObserver((e=>{for(const s of e){const e=s.boundingClientRect;t(e),r.removeEventListener("abort",a)}o.disconnect()}));r.addEventListener("abort",a),o.observe(e)}))}(d.current,{signal:c.current.signal});t({height:r.height,left:Math.min(e.clientX-r.left,r.width),top:Math.min(e.clientY-r.top,r.height),width:r.width})}catch(e){if(e instanceof n)return;a.Tb(e)}else t(void 0)}),[t,c]),p=(0,s.useCallback)((()=>{c.current&&(c.current.abort(),c.current=new AbortController),t(void 0)}),[t,c]);return{ref:d,...l,onMouseEnter:e=>{u(e),null==r||r(e)},onMouseMove:e=>{var t;null!==(t=d.current)&&void 0!==t&&t.contains(e.target)&&(u(e),null==o||o(e))},onMouseLeave:e=>{p(),null==i||i(e)}}}},"./app/utils/replays/hooks/useReplayData.tsx":(e,t,r)=>{r.d(t,{Z:()=>u}),r("../node_modules/core-js/modules/web.dom-collections.iterator.js");var s=r("../node_modules/react/index.js"),a=r("../node_modules/@sentry/hub/esm/exports.js"),n=r("./app/utils/parseLinkHeader.tsx");r("../node_modules/core-js/modules/es.error.cause.js");var o=r("./app/utils/replays/replayDataUtils.tsx"),i=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js");r("../node_modules/core-js/modules/es.array.includes.js");class l{static factory(e){let{breadcrumbs:t,replayRecord:r,errors:s,rrwebEvents:a,spans:n}=e;return t&&r&&a&&n&&s?new l({breadcrumbs:t,replayRecord:r,errors:s,rrwebEvents:a,spans:n}):null}constructor(e){let{breadcrumbs:t,replayRecord:r,errors:s,rrwebEvents:a,spans:n}=e;(0,i.Z)(this,"replayRecord",void 0),(0,i.Z)(this,"rrwebEvents",void 0),(0,i.Z)(this,"breadcrumbs",void 0),(0,i.Z)(this,"spans",void 0),(0,i.Z)(this,"getDurationMs",(()=>1e3*this.replayRecord.duration)),(0,i.Z)(this,"getReplay",(()=>this.replayRecord)),(0,i.Z)(this,"getRRWebEvents",(()=>this.rrwebEvents)),(0,i.Z)(this,"getRawCrumbs",(()=>this.breadcrumbs)),(0,i.Z)(this,"getRawSpans",(()=>this.spans)),(0,i.Z)(this,"isMemorySpan",(e=>"memory"===e.op)),(0,i.Z)(this,"isNetworkSpan",(e=>!this.isMemorySpan(e)&&!e.op.includes("paint")));const{startTimestampMs:l,endTimestampMs:d}=(0,o.iz)(a,t,n);r.startedAt=new Date(l),r.finishedAt=new Date(d),this.spans=(0,o._O)(n),this.breadcrumbs=(0,o.so)(r,s,t,this.spans),this.rrwebEvents=(0,o.ay)(r,a),this.replayRecord=r}}var d=r("./app/utils/useApi.tsx");const c=Object.freeze({breadcrumbs:void 0,errors:void 0,fetchError:void 0,fetching:!0,replayRecord:void 0,rrwebEvents:void 0,spans:void 0}),u=function(e){let{replaySlug:t,orgSlug:r}=e;const[i,u]=t.split(":"),p=(0,d.Z)(),[m,h]=(0,s.useState)(c),g=(0,s.useCallback)((async()=>(await p.requestPromise(`/projects/${r}/${i}/replays/${u}/`)).data),[p,r,i,u]),b=(0,s.useCallback)((async()=>{const e=`/projects/${r}/${i}/replays/${u}/recording-segments/?download`;let t={href:e,results:!0,cursor:""};const s=[];for(;t.results;){var a;const r=e+"&cursor="+t.cursor,[o,i,l]=await p.requestPromise(r,{includeAllArgs:!0});s.push(o),t=(0,n.Z)(null!==(a=null==l?void 0:l.getResponseHeader("Link"))&&void 0!==a?a:"").next}return s.flatMap((e=>e)).flatMap((e=>function(e){const t={breadcrumbs:[],replaySpans:[],recording:[]};return e.forEach((e=>{var r,s;"performanceSpan"===(null===(r=e.data)||void 0===r?void 0:r.tag)?t.replaySpans.push(e.data.payload):"breadcrumb"===(null==e||null===(s=e.data)||void 0===s?void 0:s.tag)?t.breadcrumbs.push(e.data.payload):t.recording.push(e)})),t}(e))).reduce(((e,t)=>(Object.entries(t).forEach((t=>{let[r,s]=t;if(!Array.isArray(s))throw new Error("Invalid value");e[r]=(e[r]||[]).concat(s)})),e)),{})}),[p,r,i,u]),y=(0,s.useCallback)((async e=>e.errorIds.length?(await p.requestPromise(`/organizations/${r}/events/`,{query:{field:["id","error.value","timestamp","error.type","issue.id"],projects:[-1],start:e.startedAt.toISOString(),end:e.finishedAt.toISOString(),query:`id:[${String(e.errorIds)}]`,referrer:"api.replay.details-page"}})).data:[]),[p,r]),f=(0,s.useCallback)((async()=>{h(c);try{const[e,t]=await Promise.all([g(),b()]),r=(0,o.qC)(e),s=await y(r);h((e=>({...e,breadcrumbs:t.breadcrumbs,errors:s,fetchError:void 0,fetching:!1,replayRecord:r,rrwebEvents:t.recording,spans:t.replaySpans})))}catch(e){a.Tb(e),h({...c,fetchError:e,fetching:!1})}}),[g,b,y]);(0,s.useEffect)((()=>{f()}),[f]);const x=(0,s.useMemo)((()=>l.factory({breadcrumbs:m.breadcrumbs,errors:m.errors,replayRecord:m.replayRecord,rrwebEvents:m.rrwebEvents,spans:m.spans})),[m.breadcrumbs,m.errors,m.replayRecord,m.rrwebEvents,m.spans]);return{fetchError:m.fetchError,fetching:m.fetching,onRetry:f,replay:x}}},"./app/views/replays/detail/layout/fluidHeight.tsx":(e,t,r)=>{r.d(t,{Z:()=>s});const s=(0,r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js").Z)("div",{target:"e42v6lb0"})({name:"oie2px",styles:"display:flex;flex-direction:column;flex-wrap:nowrap;flex-grow:1;overflow:hidden"})}}]);
//# sourceMappingURL=../sourcemaps/app_components_replays_replayView_tsx-app_utils_replays_hooks_useReplayData_tsx.2e80574a93a12604978e69d5e955e592.js.map