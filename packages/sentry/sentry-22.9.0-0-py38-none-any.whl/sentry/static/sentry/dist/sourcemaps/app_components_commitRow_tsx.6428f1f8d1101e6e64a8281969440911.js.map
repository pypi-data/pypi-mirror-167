{"version":3,"file":"chunks/app_components_commitRow_tsx.xxxxxxxxxxxxxxxxxxxx.js","mappings":"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","sources":["webpack:///./app/components/commitLink.tsx","webpack:///./app/components/commitRow.tsx"],"sourcesContent":["import Button from 'sentry/components/button';\nimport ExternalLink from 'sentry/components/links/externalLink';\nimport {IconBitbucket, IconGithub, IconGitlab, IconVsts} from 'sentry/icons';\nimport {t} from 'sentry/locale';\nimport {Repository} from 'sentry/types';\nimport {getShortCommitHash} from 'sentry/utils';\n\ntype CommitFormatterParameters = {\n  baseUrl: string;\n  commitId: string;\n};\n\ntype CommitProvider = {\n  commitUrl: (opts: CommitFormatterParameters) => string;\n  icon: React.ReactNode;\n  providerIds: string[];\n};\n\n// TODO(epurkhiser, jess): This should be moved into plugins.\nconst SUPPORTED_PROVIDERS: Readonly<CommitProvider[]> = [\n  {\n    icon: <IconGithub size=\"xs\" />,\n    providerIds: ['github', 'integrations:github', 'integrations:github_enterprise'],\n    commitUrl: ({baseUrl, commitId}) => `${baseUrl}/commit/${commitId}`,\n  },\n  {\n    icon: <IconBitbucket size=\"xs\" />,\n    providerIds: ['bitbucket', 'integrations:bitbucket'],\n    commitUrl: ({baseUrl, commitId}) => `${baseUrl}/commits/${commitId}`,\n  },\n  {\n    icon: <IconVsts size=\"xs\" />,\n    providerIds: ['visualstudio', 'integrations:vsts'],\n    commitUrl: ({baseUrl, commitId}) => `${baseUrl}/commit/${commitId}`,\n  },\n  {\n    icon: <IconGitlab size=\"xs\" />,\n    providerIds: ['gitlab', 'integrations:gitlab'],\n    commitUrl: ({baseUrl, commitId}) => `${baseUrl}/commit/${commitId}`,\n  },\n];\n\ntype Props = {\n  commitId?: string;\n  inline?: boolean;\n  repository?: Repository;\n  showIcon?: boolean;\n};\n\nfunction CommitLink({inline, commitId, repository, showIcon = true}: Props) {\n  if (!commitId || !repository) {\n    return <span>{t('Unknown Commit')}</span>;\n  }\n\n  const shortId = getShortCommitHash(commitId);\n\n  const providerData = SUPPORTED_PROVIDERS.find(provider => {\n    if (!repository.provider) {\n      return false;\n    }\n    return provider.providerIds.includes(repository.provider.id);\n  });\n\n  if (providerData === undefined) {\n    return <span>{shortId}</span>;\n  }\n\n  const commitUrl =\n    repository.url &&\n    providerData.commitUrl({\n      commitId,\n      baseUrl: repository.url,\n    });\n\n  return !inline ? (\n    <Button\n      external\n      href={commitUrl}\n      size=\"sm\"\n      icon={showIcon ? providerData.icon : null}\n    >\n      {shortId}\n    </Button>\n  ) : (\n    <ExternalLink href={commitUrl}>\n      {showIcon ? providerData.icon : null}\n      {' ' + shortId}\n    </ExternalLink>\n  );\n}\n\nexport default CommitLink;\n","import {useCallback} from 'react';\nimport styled from '@emotion/styled';\nimport * as Sentry from '@sentry/react';\n\nimport {openInviteMembersModal} from 'sentry/actionCreators/modal';\nimport UserAvatar from 'sentry/components/avatar/userAvatar';\nimport CommitLink from 'sentry/components/commitLink';\nimport {Hovercard} from 'sentry/components/hovercard';\nimport Link from 'sentry/components/links/link';\nimport {PanelItem} from 'sentry/components/panels';\nimport TextOverflow from 'sentry/components/textOverflow';\nimport TimeSince from 'sentry/components/timeSince';\nimport {IconWarning} from 'sentry/icons';\nimport {t, tct} from 'sentry/locale';\nimport space from 'sentry/styles/space';\nimport {Commit} from 'sentry/types';\n\nfunction formatCommitMessage(message: string | null) {\n  if (!message) {\n    return t('No message provided');\n  }\n\n  return message.split(/\\n/)[0];\n}\n\ninterface CommitRowProps {\n  commit: Commit;\n  className?: string;\n  customAvatar?: React.ReactNode;\n}\n\nfunction CommitRow({commit, customAvatar, className}: CommitRowProps) {\n  const handleInviteClick = useCallback(() => {\n    if (!commit.author?.email) {\n      Sentry.captureException(\n        new Error(`Commit author has no email or id, invite flow is broken.`)\n      );\n      return;\n    }\n\n    openInviteMembersModal({\n      initialData: [\n        {\n          emails: new Set([commit.author.email]),\n        },\n      ],\n      source: 'suspect_commit',\n    });\n  }, [commit.author]);\n\n  return (\n    <PanelItem key={commit.id} className={className} data-test-id=\"commit-row\">\n      {customAvatar ? (\n        customAvatar\n      ) : commit.author && commit.author.id === undefined ? (\n        <AvatarWrapper>\n          <Hovercard\n            body={\n              <EmailWarning>\n                {tct(\n                  'The email [actorEmail] is not a member of your organization. [inviteUser:Invite] them or link additional emails in [accountSettings:account settings].',\n                  {\n                    actorEmail: <strong>{commit.author.email}</strong>,\n                    accountSettings: <StyledLink to=\"/settings/account/emails/\" />,\n                    inviteUser: <StyledLink to=\"\" onClick={handleInviteClick} />,\n                  }\n                )}\n              </EmailWarning>\n            }\n          >\n            <UserAvatar size={36} user={commit.author} />\n            <EmailWarningIcon data-test-id=\"email-warning\">\n              <IconWarning size=\"xs\" />\n            </EmailWarningIcon>\n          </Hovercard>\n        </AvatarWrapper>\n      ) : (\n        <AvatarWrapper>\n          <UserAvatar size={36} user={commit.author} />\n        </AvatarWrapper>\n      )}\n\n      <CommitMessage>\n        <Message>{formatCommitMessage(commit.message)}</Message>\n        <Meta>\n          {tct('[author] committed [timeago]', {\n            author: <strong>{commit.author?.name ?? t('Unknown author')}</strong>,\n            timeago: <TimeSince date={commit.dateCreated} />,\n          })}\n        </Meta>\n      </CommitMessage>\n\n      <div>\n        <CommitLink commitId={commit.id} repository={commit.repository} />\n      </div>\n    </PanelItem>\n  );\n}\n\nconst AvatarWrapper = styled('div')`\n  position: relative;\n  align-self: flex-start;\n  margin-right: ${space(2)};\n`;\n\nconst EmailWarning = styled('div')`\n  font-size: ${p => p.theme.fontSizeSmall};\n  line-height: 1.4;\n  margin: -4px;\n`;\n\nconst StyledLink = styled(Link)`\n  color: ${p => p.theme.textColor};\n  border-bottom: 1px dotted ${p => p.theme.textColor};\n\n  &:hover {\n    color: ${p => p.theme.textColor};\n  }\n`;\n\nconst EmailWarningIcon = styled('span')`\n  position: absolute;\n  bottom: -6px;\n  right: -7px;\n  line-height: 12px;\n  border-radius: 50%;\n  border: 1px solid ${p => p.theme.background};\n  background: ${p => p.theme.yellow200};\n  padding: 1px 2px 3px 2px;\n`;\n\nconst CommitMessage = styled('div')`\n  flex: 1;\n  flex-direction: column;\n  min-width: 0;\n  margin-right: ${space(2)};\n`;\n\nconst Message = styled(TextOverflow)`\n  font-size: 15px;\n  line-height: 1.1;\n  font-weight: bold;\n`;\n\nconst Meta = styled(TextOverflow)`\n  font-size: 13px;\n  line-height: 1.5;\n  margin: 0;\n  color: ${p => p.theme.subText};\n`;\n\nconst StyledCommitRow = styled(CommitRow)`\n  align-items: center;\n`;\n\nexport {StyledCommitRow as CommitRow};\n"],"names":["SUPPORTED_PROVIDERS","icon","size","providerIds","commitUrl","baseUrl","commitId","inline","repository","showIcon","t","shortId","getShortCommitHash","providerData","find","provider","includes","id","undefined","url","href","external","CommitRow","commit","customAvatar","className","handleInviteClick","useCallback","author","email","openInviteMembersModal","initialData","emails","Set","source","Sentry","Error","AvatarWrapper","body","EmailWarning","tct","actorEmail","accountSettings","StyledLink","to","inviteUser","onClick","user","EmailWarningIcon","CommitMessage","Message","message","split","Meta","name","timeago","date","dateCreated","space","p","theme","fontSizeSmall","Link","textColor","background","yellow200","TextOverflow","subText","StyledCommitRow"],"sourceRoot":""}