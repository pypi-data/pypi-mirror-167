{"version":3,"file":"chunks/app_views_organizationGroupDetails_groupEventAttachments_index_tsx.xxxxxxxxxxxxxxxxxxxx.js","mappings":"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","sources":["webpack:///./app/components/acl/role.tsx","webpack:///./app/components/events/eventAttachmentActions.tsx","webpack:///./app/utils/attachmentUrl.tsx","webpack:///./app/views/organizationGroupDetails/groupEventAttachments/groupEventAttachmentsFilter.tsx","webpack:///./app/views/organizationGroupDetails/groupEventAttachments/types.tsx","webpack:///./app/views/organizationGroupDetails/groupEventAttachments/groupEventAttachmentsTableRow.tsx","webpack:///./app/views/organizationGroupDetails/groupEventAttachments/groupEventAttachmentsTable.tsx","webpack:///./app/views/organizationGroupDetails/groupEventAttachments/groupEventAttachments.tsx","webpack:///./app/views/organizationGroupDetails/groupEventAttachments/index.tsx","webpack:///../node_modules/lodash/_baseDifference.js","webpack:///../node_modules/lodash/_baseXor.js","webpack:///../node_modules/lodash/xor.js"],"sourcesContent":["import {useMemo} from 'react';\n\nimport ConfigStore from 'sentry/stores/configStore';\nimport {Organization, User} from 'sentry/types';\nimport {isActiveSuperuser} from 'sentry/utils/isActiveSuperuser';\nimport {isRenderFunc} from 'sentry/utils/isRenderFunc';\nimport withOrganization from 'sentry/utils/withOrganization';\n\ntype RoleRenderProps = {\n  hasRole: boolean;\n};\n\ntype ChildrenRenderFn = (props: RoleRenderProps) => React.ReactElement | null;\n\nfunction checkUserRole(user: User, organization: Organization, role: RoleProps['role']) {\n  if (!user) {\n    return false;\n  }\n\n  if (isActiveSuperuser()) {\n    return true;\n  }\n\n  if (!Array.isArray(organization.orgRoleList)) {\n    return false;\n  }\n\n  const roleIds = organization.orgRoleList.map(r => r.id);\n\n  if (!roleIds.includes(role) || !roleIds.includes(organization.role ?? '')) {\n    return false;\n  }\n\n  const requiredIndex = roleIds.indexOf(role);\n  const currentIndex = roleIds.indexOf(organization.role ?? '');\n  return currentIndex >= requiredIndex;\n}\n\ninterface RoleProps {\n  /**\n   * If children is a function then will be treated as a render prop and\n   * passed RoleRenderProps.\n   *\n   * The other interface is more simple, only show `children` if user has\n   * the minimum required role.\n   */\n  children: React.ReactElement | ChildrenRenderFn;\n  /**\n   * Current Organization\n   */\n  organization: Organization;\n  /**\n   * Minimum required role\n   */\n  role: string;\n}\n\nfunction Role({role, organization, children}: RoleProps): React.ReactElement | null {\n  const user = ConfigStore.get('user');\n\n  const hasRole = useMemo(\n    () => checkUserRole(user, organization, role),\n    // It seems that this returns a stable reference, but\n    [organization, role, user]\n  );\n\n  if (isRenderFunc<ChildrenRenderFn>(children)) {\n    return children({hasRole});\n  }\n\n  return hasRole ? children : null;\n}\n\nconst withOrganizationRole = withOrganization(Role);\n\nexport {withOrganizationRole as Role};\n","import {Component} from 'react';\nimport styled from '@emotion/styled';\n\nimport {Client} from 'sentry/api';\nimport Button from 'sentry/components/button';\nimport ButtonBar from 'sentry/components/buttonBar';\nimport Confirm from 'sentry/components/confirm';\nimport {IconDelete, IconDownload, IconShow} from 'sentry/icons';\nimport {t} from 'sentry/locale';\nimport space from 'sentry/styles/space';\nimport withApi from 'sentry/utils/withApi';\n\ntype Props = {\n  api: Client;\n  attachmentId: string;\n  onDelete: (attachmentId: string) => void;\n  url: string | null;\n  hasPreview?: boolean;\n  onPreview?: (attachmentId: string) => void;\n  previewIsOpen?: boolean;\n  withPreviewButton?: boolean;\n};\n\nclass EventAttachmentActions extends Component<Props> {\n  handlePreview() {\n    const {onPreview, attachmentId} = this.props;\n    if (onPreview) {\n      onPreview(attachmentId);\n    }\n  }\n\n  render() {\n    const {url, withPreviewButton, hasPreview, previewIsOpen, onDelete, attachmentId} =\n      this.props;\n\n    return (\n      <ButtonBar gap={1}>\n        <Confirm\n          confirmText={t('Delete')}\n          message={t('Are you sure you wish to delete this file?')}\n          priority=\"danger\"\n          onConfirm={() => onDelete(attachmentId)}\n          disabled={!url}\n        >\n          <Button\n            size=\"xs\"\n            icon={<IconDelete size=\"xs\" />}\n            aria-label={t('Delete')}\n            disabled={!url}\n            title={!url ? t('Insufficient permissions to delete attachments') : undefined}\n          />\n        </Confirm>\n\n        <DownloadButton\n          size=\"xs\"\n          icon={<IconDownload size=\"xs\" />}\n          href={url ? `${url}?download=1` : ''}\n          disabled={!url}\n          title={!url ? t('Insufficient permissions to download attachments') : undefined}\n          aria-label={t('Download')}\n        />\n\n        {withPreviewButton && (\n          <DownloadButton\n            size=\"xs\"\n            disabled={!url || !hasPreview}\n            priority={previewIsOpen ? 'primary' : 'default'}\n            icon={<IconShow size=\"xs\" />}\n            onClick={() => this.handlePreview()}\n            title={\n              !url\n                ? t('Insufficient permissions to preview attachments')\n                : !hasPreview\n                ? t('This attachment cannot be previewed')\n                : undefined\n            }\n          >\n            {t('Preview')}\n          </DownloadButton>\n        )}\n      </ButtonBar>\n    );\n  }\n}\n\nconst DownloadButton = styled(Button)`\n  margin-right: ${space(0.5)};\n`;\n\nexport default withApi(EventAttachmentActions);\n","import {memo} from 'react';\n\nimport {Role} from 'sentry/components/acl/role';\nimport {IssueAttachment, Organization} from 'sentry/types';\nimport withOrganization from 'sentry/utils/withOrganization';\n\ntype Props = {\n  attachment: IssueAttachment;\n  children: (downloadUrl: string | null) => React.ReactElement | null;\n  eventId: string;\n  organization: Organization;\n  projectId: string;\n};\n\nfunction AttachmentUrl({attachment, organization, eventId, projectId, children}: Props) {\n  function getDownloadUrl() {\n    return `/api/0/projects/${organization.slug}/${projectId}/events/${eventId}/attachments/${attachment.id}/`;\n  }\n\n  return (\n    <Role role={organization.attachmentsRole}>\n      {({hasRole}) => children(hasRole ? getDownloadUrl() : null)}\n    </Role>\n  );\n}\n\nexport default withOrganization(memo(AttachmentUrl));\n","// eslint-disable-next-line no-restricted-imports\nimport {withRouter, WithRouterProps} from 'react-router';\nimport styled from '@emotion/styled';\nimport omit from 'lodash/omit';\nimport xor from 'lodash/xor';\n\nimport Button from 'sentry/components/button';\nimport ButtonBar from 'sentry/components/buttonBar';\nimport {t} from 'sentry/locale';\nimport space from 'sentry/styles/space';\n\nconst crashReportTypes = ['event.minidump', 'event.applecrashreport'];\n\nconst GroupEventAttachmentsFilter = (props: WithRouterProps) => {\n  const {query, pathname} = props.location;\n  const {types} = query;\n  const allAttachmentsQuery = omit(query, 'types');\n  const onlyCrashReportsQuery = {\n    ...query,\n    types: crashReportTypes,\n  };\n\n  let activeButton = '';\n\n  if (types === undefined) {\n    activeButton = 'all';\n  } else if (xor(crashReportTypes, types).length === 0) {\n    activeButton = 'onlyCrash';\n  }\n\n  return (\n    <FilterWrapper>\n      <ButtonBar merged active={activeButton}>\n        <Button barId=\"all\" size=\"sm\" to={{pathname, query: allAttachmentsQuery}}>\n          {t('All Attachments')}\n        </Button>\n        <Button barId=\"onlyCrash\" size=\"sm\" to={{pathname, query: onlyCrashReportsQuery}}>\n          {t('Only Crash Reports')}\n        </Button>\n      </ButtonBar>\n    </FilterWrapper>\n  );\n};\n\nconst FilterWrapper = styled('div')`\n  display: flex;\n  justify-content: flex-end;\n  margin-bottom: ${space(3)};\n`;\n\nexport {crashReportTypes};\nexport default withRouter(GroupEventAttachmentsFilter);\n","import {t} from 'sentry/locale';\n\nexport const types = {\n  'event.minidump': t('Minidump'),\n  'event.applecrashreport': t('Apple Crash Report'),\n  'event.attachment': t('Other'),\n};\n","import styled from '@emotion/styled';\n\nimport DateTime from 'sentry/components/dateTime';\nimport EventAttachmentActions from 'sentry/components/events/eventAttachmentActions';\nimport FileSize from 'sentry/components/fileSize';\nimport Link from 'sentry/components/links/link';\nimport {t} from 'sentry/locale';\nimport {IssueAttachment} from 'sentry/types';\nimport AttachmentUrl from 'sentry/utils/attachmentUrl';\nimport {types} from 'sentry/views/organizationGroupDetails/groupEventAttachments/types';\n\ntype Props = {\n  attachment: IssueAttachment;\n  groupId: string;\n  isDeleted: boolean;\n  onDelete: (attachmentId: string) => void;\n  orgId: string;\n  projectId: string;\n};\n\nconst GroupEventAttachmentsTableRow = ({\n  attachment,\n  projectId,\n  onDelete,\n  isDeleted,\n  orgId,\n  groupId,\n}: Props) => (\n  <TableRow isDeleted={isDeleted}>\n    <td>\n      <h5>\n        {attachment.name}\n        <br />\n        <small>\n          <DateTime date={attachment.dateCreated} /> &middot;{' '}\n          <Link\n            to={`/organizations/${orgId}/issues/${groupId}/events/${attachment.event_id}/`}\n          >\n            {attachment.event_id}\n          </Link>\n        </small>\n      </h5>\n    </td>\n\n    <td>{types[attachment.type] || t('Other')}</td>\n\n    <td>\n      <FileSize bytes={attachment.size} />\n    </td>\n\n    <td>\n      <ActionsWrapper>\n        <AttachmentUrl\n          projectId={projectId}\n          eventId={attachment.event_id}\n          attachment={attachment}\n        >\n          {url =>\n            !isDeleted ? (\n              <EventAttachmentActions\n                url={url}\n                onDelete={onDelete}\n                attachmentId={attachment.id}\n              />\n            ) : null\n          }\n        </AttachmentUrl>\n      </ActionsWrapper>\n    </td>\n  </TableRow>\n);\n\nconst TableRow = styled('tr')<{isDeleted: boolean}>`\n  opacity: ${p => (p.isDeleted ? 0.3 : 1)};\n  td {\n    text-decoration: ${p => (p.isDeleted ? 'line-through' : 'normal')};\n  }\n`;\n\nconst ActionsWrapper = styled('div')`\n  display: inline-block;\n`;\n\nexport default GroupEventAttachmentsTableRow;\n","import {t} from 'sentry/locale';\nimport {IssueAttachment} from 'sentry/types';\nimport GroupEventAttachmentsTableRow from 'sentry/views/organizationGroupDetails/groupEventAttachments/groupEventAttachmentsTableRow';\n\ntype Props = {\n  attachments: IssueAttachment[];\n  deletedAttachments: string[];\n  groupId: string;\n  onDelete: (attachmentId: string) => void;\n  orgId: string;\n  projectId: string;\n};\n\nconst GroupEventAttachmentsTable = ({\n  attachments,\n  orgId,\n  projectId,\n  groupId,\n  onDelete,\n  deletedAttachments,\n}: Props) => {\n  const tableRowNames = [t('Name'), t('Type'), t('Size'), t('Actions')];\n\n  return (\n    <table className=\"table events-table\">\n      <thead>\n        <tr>\n          {tableRowNames.map(name => (\n            <th key={name}>{name}</th>\n          ))}\n        </tr>\n      </thead>\n      <tbody>\n        {attachments.map(attachment => (\n          <GroupEventAttachmentsTableRow\n            key={attachment.id}\n            attachment={attachment}\n            orgId={orgId}\n            projectId={projectId}\n            groupId={groupId}\n            onDelete={onDelete}\n            isDeleted={deletedAttachments.some(id => attachment.id === id)}\n          />\n        ))}\n      </tbody>\n    </table>\n  );\n};\n\nexport default GroupEventAttachmentsTable;\n","// eslint-disable-next-line no-restricted-imports\nimport {withRouter, WithRouterProps} from 'react-router';\nimport pick from 'lodash/pick';\n\nimport {addErrorMessage} from 'sentry/actionCreators/indicator';\nimport AsyncComponent from 'sentry/components/asyncComponent';\nimport EmptyStateWarning from 'sentry/components/emptyStateWarning';\nimport * as Layout from 'sentry/components/layouts/thirds';\nimport LoadingIndicator from 'sentry/components/loadingIndicator';\nimport Pagination from 'sentry/components/pagination';\nimport {Panel, PanelBody} from 'sentry/components/panels';\nimport {t} from 'sentry/locale';\nimport {IssueAttachment} from 'sentry/types';\n\nimport GroupEventAttachmentsFilter from './groupEventAttachmentsFilter';\nimport GroupEventAttachmentsTable from './groupEventAttachmentsTable';\n\ntype Props = {\n  projectSlug: string;\n} & WithRouterProps<{groupId: string; orgId: string}> &\n  AsyncComponent['props'];\n\ntype State = {\n  deletedAttachments: string[];\n  eventAttachments?: IssueAttachment[];\n} & AsyncComponent['state'];\n\nclass GroupEventAttachments extends AsyncComponent<Props, State> {\n  getDefaultState() {\n    return {\n      ...super.getDefaultState(),\n      deletedAttachments: [],\n    };\n  }\n\n  getEndpoints(): ReturnType<AsyncComponent['getEndpoints']> {\n    const {params, location} = this.props;\n\n    return [\n      [\n        'eventAttachments',\n        `/issues/${params.groupId}/attachments/`,\n        {\n          query: {\n            ...pick(location.query, ['cursor', 'environment', 'types']),\n            limit: 50,\n          },\n        },\n      ],\n    ];\n  }\n\n  handleDelete = async (deletedAttachmentId: string) => {\n    const {params, projectSlug} = this.props;\n    const attachment = this.state?.eventAttachments?.find(\n      item => item.id === deletedAttachmentId\n    );\n    if (!attachment) {\n      return;\n    }\n\n    this.setState(prevState => ({\n      deletedAttachments: [...prevState.deletedAttachments, deletedAttachmentId],\n    }));\n\n    try {\n      await this.api.requestPromise(\n        `/projects/${params.orgId}/${projectSlug}/events/${attachment.event_id}/attachments/${attachment.id}/`,\n        {\n          method: 'DELETE',\n        }\n      );\n    } catch (error) {\n      addErrorMessage('An error occurred while deleteting the attachment');\n    }\n  };\n\n  renderNoQueryResults() {\n    return (\n      <EmptyStateWarning>\n        <p>{t('No crash reports found')}</p>\n      </EmptyStateWarning>\n    );\n  }\n\n  renderEmpty() {\n    return (\n      <EmptyStateWarning>\n        <p>{t('No attachments found')}</p>\n      </EmptyStateWarning>\n    );\n  }\n\n  renderLoading() {\n    return this.renderBody();\n  }\n\n  renderInnerBody() {\n    const {projectSlug, params, location} = this.props;\n    const {loading, eventAttachments, deletedAttachments} = this.state;\n\n    if (loading) {\n      return <LoadingIndicator />;\n    }\n\n    if (eventAttachments && eventAttachments.length > 0) {\n      return (\n        <GroupEventAttachmentsTable\n          attachments={eventAttachments}\n          orgId={params.orgId}\n          projectId={projectSlug}\n          groupId={params.groupId}\n          onDelete={this.handleDelete}\n          deletedAttachments={deletedAttachments}\n        />\n      );\n    }\n\n    if (location.query.types) {\n      return this.renderNoQueryResults();\n    }\n\n    return this.renderEmpty();\n  }\n\n  renderBody() {\n    return (\n      <Layout.Body>\n        <Layout.Main fullWidth>\n          <GroupEventAttachmentsFilter />\n          <Panel className=\"event-list\">\n            <PanelBody>{this.renderInnerBody()}</PanelBody>\n          </Panel>\n          <Pagination pageLinks={this.state.eventAttachmentsPageLinks} />\n        </Layout.Main>\n      </Layout.Body>\n    );\n  }\n}\n\nexport default withRouter(GroupEventAttachments);\n","import {RouteComponentProps} from 'react-router';\n\nimport Feature from 'sentry/components/acl/feature';\nimport FeatureDisabled from 'sentry/components/acl/featureDisabled';\nimport {t} from 'sentry/locale';\nimport {Group, Organization} from 'sentry/types';\nimport withOrganization from 'sentry/utils/withOrganization';\n\nimport GroupEventAttachments from './groupEventAttachments';\n\ntype Props = RouteComponentProps<{groupId: string; orgId: string}, {}> & {\n  group: Group;\n  organization: Organization;\n};\n\nconst GroupEventAttachmentsContainer = ({organization, group}: Props) => (\n  <Feature\n    features={['event-attachments']}\n    organization={organization}\n    renderDisabled={props => (\n      <FeatureDisabled {...props} featureName={t('Event Attachments')} />\n    )}\n  >\n    <GroupEventAttachments projectSlug={group.project.slug} />\n  </Feature>\n);\n\nexport default withOrganization(GroupEventAttachmentsContainer);\n","var SetCache = require('./_SetCache'),\n    arrayIncludes = require('./_arrayIncludes'),\n    arrayIncludesWith = require('./_arrayIncludesWith'),\n    arrayMap = require('./_arrayMap'),\n    baseUnary = require('./_baseUnary'),\n    cacheHas = require('./_cacheHas');\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * The base implementation of methods like `_.difference` without support\n * for excluding multiple arrays or iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Array} values The values to exclude.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new array of filtered values.\n */\nfunction baseDifference(array, values, iteratee, comparator) {\n  var index = -1,\n      includes = arrayIncludes,\n      isCommon = true,\n      length = array.length,\n      result = [],\n      valuesLength = values.length;\n\n  if (!length) {\n    return result;\n  }\n  if (iteratee) {\n    values = arrayMap(values, baseUnary(iteratee));\n  }\n  if (comparator) {\n    includes = arrayIncludesWith;\n    isCommon = false;\n  }\n  else if (values.length >= LARGE_ARRAY_SIZE) {\n    includes = cacheHas;\n    isCommon = false;\n    values = new SetCache(values);\n  }\n  outer:\n  while (++index < length) {\n    var value = array[index],\n        computed = iteratee == null ? value : iteratee(value);\n\n    value = (comparator || value !== 0) ? value : 0;\n    if (isCommon && computed === computed) {\n      var valuesIndex = valuesLength;\n      while (valuesIndex--) {\n        if (values[valuesIndex] === computed) {\n          continue outer;\n        }\n      }\n      result.push(value);\n    }\n    else if (!includes(values, computed, comparator)) {\n      result.push(value);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseDifference;\n","var baseDifference = require('./_baseDifference'),\n    baseFlatten = require('./_baseFlatten'),\n    baseUniq = require('./_baseUniq');\n\n/**\n * The base implementation of methods like `_.xor`, without support for\n * iteratee shorthands, that accepts an array of arrays to inspect.\n *\n * @private\n * @param {Array} arrays The arrays to inspect.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new array of values.\n */\nfunction baseXor(arrays, iteratee, comparator) {\n  var length = arrays.length;\n  if (length < 2) {\n    return length ? baseUniq(arrays[0]) : [];\n  }\n  var index = -1,\n      result = Array(length);\n\n  while (++index < length) {\n    var array = arrays[index],\n        othIndex = -1;\n\n    while (++othIndex < length) {\n      if (othIndex != index) {\n        result[index] = baseDifference(result[index] || array, arrays[othIndex], iteratee, comparator);\n      }\n    }\n  }\n  return baseUniq(baseFlatten(result, 1), iteratee, comparator);\n}\n\nmodule.exports = baseXor;\n","var arrayFilter = require('./_arrayFilter'),\n    baseRest = require('./_baseRest'),\n    baseXor = require('./_baseXor'),\n    isArrayLikeObject = require('./isArrayLikeObject');\n\n/**\n * Creates an array of unique values that is the\n * [symmetric difference](https://en.wikipedia.org/wiki/Symmetric_difference)\n * of the given arrays. The order of result values is determined by the order\n * they occur in the arrays.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Array\n * @param {...Array} [arrays] The arrays to inspect.\n * @returns {Array} Returns the new array of filtered values.\n * @see _.difference, _.without\n * @example\n *\n * _.xor([2, 1], [2, 3]);\n * // => [1, 3]\n */\nvar xor = baseRest(function(arrays) {\n  return baseXor(arrayFilter(arrays, isArrayLikeObject));\n});\n\nmodule.exports = xor;\n"],"names":["withOrganizationRole","withOrganization","role","organization","children","user","ConfigStore","hasRole","useMemo","isActiveSuperuser","Array","isArray","orgRoleList","roleIds","map","r","id","includes","requiredIndex","indexOf","checkUserRole","isRenderFunc","EventAttachmentActions","Component","handlePreview","onPreview","attachmentId","this","props","render","url","withPreviewButton","hasPreview","previewIsOpen","onDelete","gap","confirmText","t","message","priority","onConfirm","disabled","size","icon","title","undefined","DownloadButton","href","onClick","Button","space","withApi","AttachmentUrl","attachment","eventId","projectId","attachmentsRole","slug","memo","crashReportTypes","GroupEventAttachmentsFilter","query","pathname","location","types","allAttachmentsQuery","omit","onlyCrashReportsQuery","activeButton","xor","length","FilterWrapper","merged","active","barId","to","withRouter","GroupEventAttachmentsTableRow","isDeleted","orgId","groupId","TableRow","name","date","dateCreated","event_id","type","bytes","ActionsWrapper","p","GroupEventAttachmentsTable","attachments","deletedAttachments","tableRowNames","className","some","GroupEventAttachments","AsyncComponent","async","params","projectSlug","state","eventAttachments","find","item","deletedAttachmentId","setState","prevState","api","requestPromise","method","error","addErrorMessage","getDefaultState","super","getEndpoints","pick","limit","renderNoQueryResults","renderEmpty","renderLoading","renderBody","renderInnerBody","loading","handleDelete","fullWidth","pageLinks","eventAttachmentsPageLinks","GroupEventAttachmentsContainer","group","features","renderDisabled","featureName","project","SetCache","arrayIncludes","arrayIncludesWith","arrayMap","baseUnary","cacheHas","module","exports","array","values","iteratee","comparator","index","isCommon","result","valuesLength","outer","value","computed","valuesIndex","push","baseDifference","baseFlatten","baseUniq","arrays","othIndex","arrayFilter","baseRest","baseXor","isArrayLikeObject"],"sourceRoot":""}