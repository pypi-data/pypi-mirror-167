import{d as C,u as A,M as d,c,r as x,f as e,o as r,e as p,w as m,j as D,aA as w,aB as F,aC as I,aD as P,aE as $,g as k,ax as N,aF as R,au as U,a0 as f,s as V}from"./index.ac74b82c.js";import{u as j}from"./useRouteParam.fc30bbeb.js";import{u as y}from"./useSubscriptionWithDependencies.2c2d7828.js";const q=C({__name:"BlocksCatalogCreate",setup(E){const i=A(),l=d({}),u=d(""),b=j("blockTypeSlug"),_=c(()=>b.value?[b.value]:null),v=y(N.getBlockTypeBySlug,_),a=c(()=>v.response),S=c(()=>a.value?[{blockSchemas:{blockTypeId:{any_:[a.value.id]}}}]:null),h=y(R.getBlockSchemas,S),t=c(()=>{var o;return(o=h.response)==null?void 0:o[0]});function g(){!t.value||!a.value||U.createBlockDocument({name:u.value,data:l.value,blockSchemaId:t.value.id,blockTypeId:a.value.id}).then(({id:o})=>{f("Block created successfully","success"),i.push(V.block(o))}).catch(o=>{f("Failed to create block","error"),console.error(o)})}function T(){i.back()}return(o,s)=>{const B=x("p-layout-default");return e(a)?(r(),p(B,{key:0,class:"blocks-catalog-create"},{header:m(()=>[D(e(w),{"block-type":e(a)},null,8,["block-type"])]),default:m(()=>[e(a)?(r(),p(e(F),{key:0,"block-type":e(a)},{default:m(()=>[e(t)?(r(),p(e(I),P({key:0,data:l.value,"onUpdate:data":s[0]||(s[0]=n=>l.value=n),name:u.value,"onUpdate:name":s[1]||(s[1]=n=>u.value=n),"block-schema":e(t)},$({submit:g,cancel:T})),null,16,["data","name","block-schema"])):k("",!0)]),_:1},8,["block-type"])):k("",!0)]),_:1})):k("",!0)}}});export{q as default};
