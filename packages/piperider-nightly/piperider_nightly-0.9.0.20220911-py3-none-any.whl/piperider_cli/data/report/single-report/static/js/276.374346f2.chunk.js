"use strict";(self.webpackChunkpiperider_report=self.webpackChunkpiperider_report||[]).push([[276],{5484:function(e,n,s){s.d(n,{s:function(){return r}});var i=s(8735),t=s(184);function r(e){switch(e.status){case"passed":return(0,t.jsx)(i.xv,{as:"span",role:"img",children:"\u2705"});case"failed":return(0,t.jsx)(i.xv,{as:"span",role:"img",children:"\u274c"});default:return(0,t.jsx)(i.xv,{as:"span",role:"img",children:"-"})}}},6646:function(e,n,s){s.d(n,{S:function(){return c}});var i=s(5987),t=s(7231),r=s(8735),l=s(9113),a=s(3853),d=s(184),o=["children","startingHeight","collapseable","onVisible"];function c(e){var n=e.children,s=e.startingHeight,c=void 0===s?250:s,u=e.collapseable,x=void 0===u||u,h=e.onVisible,v=(0,i.Z)(e,o);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(t.UO,{startingHeight:c,in:v.in,children:n}),x&&(0,d.jsxs)(r.kC,{as:"button",justifyContent:"center",alignItems:"center",color:"piperider.500",mt:4,height:8,onClick:function(){h()},children:[(0,d.jsx)(r.xv,{as:"span",children:v.in?"Less":"More"}),(0,d.jsx)(l.JO,{as:a.rH8,boxSize:6,transform:v.in?"rotate(0deg)":"rotate(180deg)",transition:"transform 0.2s ease-in"})]})]})}},4673:function(e,n,s){s.d(n,{m:function(){return d}});var i=s(8735),t=s(9113),r=s(3853),l=s(6523),a=s(184);function d(e){var n=e.baseTable,s=e.targetTable;(0,l.h5)(l.vT.safeParse(n)),(0,l.h5)(l.vT.safeParse(s));var d=n||s;return(0,a.jsxs)(i.kC,{gap:1,direction:"column",mb:8,children:[(0,a.jsx)(i.xv,{color:"gray.500",children:"Table"}),(0,a.jsx)(i.X6,{fontSize:24,children:(0,a.jsxs)(i.kC,{alignItems:"center",children:[(0,a.jsx)(t.JO,{as:r.aCJ,mr:1}),null===d||void 0===d?void 0:d.name]})}),(0,a.jsx)(i.xv,{fontSize:"sm",children:null===d||void 0===d?void 0:d.description})]})}},9276:function(e,n,s){s.r(n),s.d(n,{default:function(){return F}});var i=s(1413),t=s(2982),r=s(885),l=s(5223),a=s(8735),d=s(8625),o=s(2791),c=s(8062),u=s(6157),x=s(2483),h=s(5987),v=s(8540),j=s(2504),m=s(7005),p=s(5558),f=s(5484),b=s(184);function g(e){var n,s,i,t,r,l,a=e.data;return(0,b.jsx)(m.xJ,{children:(0,b.jsxs)(m.iA,{variant:"simple",children:[(0,b.jsx)(m.hr,{children:(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Th,{}),(0,b.jsx)(m.Th,{children:"Status"}),(0,b.jsx)(m.Th,{children:"Message"})]})}),(0,b.jsxs)(m.p3,{children:[(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Td,{fontWeight:700,children:"Base"}),(0,b.jsx)(m.Td,{children:(0,b.jsx)(f.s,{status:null===a||void 0===a||null===(n=a.base)||void 0===n?void 0:n.status})}),(0,b.jsx)(m.Td,{children:null!==(s=null===a||void 0===a||null===(i=a.base)||void 0===i?void 0:i.message)&&void 0!==s?s:p.Nj})]}),(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Td,{fontWeight:700,children:"Target"}),(0,b.jsx)(m.Td,{children:(0,b.jsx)(f.s,{status:null===a||void 0===a||null===(t=a.target)||void 0===t?void 0:t.status})}),(0,b.jsx)(m.Td,{children:null!==(r=null===a||void 0===a||null===(l=a.base)||void 0===l?void 0:l.message)&&void 0!==r?r:p.Nj})]})]})]})})}var T=s(709);function C(e){var n,s,i,t,r,l,a=e.data;return(0,b.jsx)(m.xJ,{children:(0,b.jsxs)(m.iA,{variant:"simple",children:[(0,b.jsx)(m.hr,{children:(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Th,{}),(0,b.jsx)(m.Th,{children:"Status"}),(0,b.jsx)(m.Th,{children:"Expected"}),(0,b.jsx)(m.Th,{children:"Actual"})]})}),(0,b.jsxs)(m.p3,{children:[(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Td,{fontWeight:700,children:"Base"}),(0,b.jsx)(m.Td,{children:(0,b.jsx)(f.s,{status:null===a||void 0===a||null===(n=a.base)||void 0===n?void 0:n.status})}),(0,b.jsx)(m.Td,{children:(0,T.sG)(null===a||void 0===a||null===(s=a.base)||void 0===s?void 0:s.expected)}),(0,b.jsx)(m.Td,{children:(0,T.sG)(null===a||void 0===a||null===(i=a.base)||void 0===i?void 0:i.actual)})]}),(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Td,{fontWeight:700,children:"Target"}),(0,b.jsx)(m.Td,{children:(0,b.jsx)(f.s,{status:null===a||void 0===a||null===(t=a.target)||void 0===t?void 0:t.status})}),(0,b.jsx)(m.Td,{children:(0,T.sG)(null===a||void 0===a||null===(r=a.target)||void 0===r?void 0:r.expected)}),(0,b.jsx)(m.Td,{children:(0,T.sG)(null===a||void 0===a||null===(l=a.target)||void 0===l?void 0:l.actual)})]})]})]})})}var Z=["data","type","isOpen","onClose"];function S(e){var n=e.data,s=e.type,t=void 0===s?"piperider":s,r=e.isOpen,l=e.onClose,d=(0,h.Z)(e,Z);return(0,b.jsxs)(v.u_,(0,i.Z)((0,i.Z)({},d),{},{isOpen:r,size:"2xl",onClose:function(){l()},children:[(0,b.jsx)(v.ZA,{}),(0,b.jsxs)(v.hz,{children:[(0,b.jsx)(v.xB,{children:(0,b.jsx)(a.xv,{title:null===n||void 0===n?void 0:n.name,noOfLines:1,maxWidth:"calc(100% - 50px)",children:null===n||void 0===n?void 0:n.name})}),(0,b.jsx)(v.ol,{}),(0,b.jsx)(v.fe,{children:"piperider"===t?(0,b.jsx)(C,{data:n}):(0,b.jsx)(g,{data:n})}),(0,b.jsx)(v.mz,{children:(0,b.jsx)(j.zx,{onClick:l,children:"Close"})})]})]}))}var k=s(6523),y=s(1241),N=s(429),w=s(3811),O=s(2915),A=s(2740),P=s(5676),D=s(2917),z=function(e){var n,s,i,t,r=e.baseColumn,l=e.targetColumn,d=e.singleOnly,o=e.onSelect,c=r||l,u=(0,N.JH)(r);return(0,k.h5)(k.a$.safeParse(r)),(0,k.h5)(k.a$.safeParse(l)),(0,b.jsxs)(a.kC,{direction:"column",minH:"250px",border:"1px solid darkgray",rounded:"2xl",children:[c&&(0,b.jsx)(O.u,{columnDatum:c,bg:"blue.800",color:"white"}),(0,b.jsxs)(a.xu,{m:4,children:[!d&&(0,b.jsx)(A.$,{name:"",firstSlot:"Base",secondSlot:"Target",width:"100%",fontWeight:"bold",mb:3}),(0,b.jsx)(a.xu,{mb:3,children:(0,b.jsx)(P.P,{baseColumnDatum:r,targetColumnDatum:l,singleOnly:d})}),(0,b.jsx)(a.xu,{mb:3,children:(0,b.jsx)(D.Y,{baseColumnDatum:r,targetColumnDatum:l,singleOnly:d})}),u&&(0,b.jsx)(a.xu,{children:(0,b.jsx)(A.$,{name:"Most Common",metakey:"topk",width:"100%",firstSlot:null!==(n=null===r||void 0===r||null===(s=r.topk)||void 0===s?void 0:s.values[0])&&void 0!==n?n:p.Nj,secondSlot:null!==(i=null===l||void 0===l||null===(t=l.topk)||void 0===t?void 0:t.values[0])&&void 0!==i?i:p.Nj})})]}),c&&(0,b.jsx)(a.kC,{justifyContent:"center",p:3,h:"100%",alignItems:"end",cursor:"pointer",onClick:function(){return o({columnName:c.name})},children:(0,b.jsx)(a.xv,{as:"a",color:"blue.400",children:"Details"})})]})};function H(e){var n=e.baseTable,s=e.targetTable,i=e.onSelect;(0,k.h5)(k.vT.safeParse(n)),(0,k.h5)(k.vT.safeParse(s));var t=(0,N.WN)(null===n||void 0===n?void 0:n.columns,null===s||void 0===s?void 0:s.columns),l=(null===n||void 0===n?void 0:n.name)||(null===s||void 0===s?void 0:s.name);return(0,b.jsx)(b.Fragment,{children:Object.entries(t).map((function(e){var n=(0,r.Z)(e,2),s=n[0],t=n[1],d=t.base,o=t.target;return(0,b.jsx)(a.kC,{direction:"column",children:(0,b.jsxs)(a.rj,{my:8,templateColumns:"1fr 2fr",gap:12,overflowX:"hidden",children:[(0,b.jsx)(z,{baseColumn:d,targetColumn:o,onSelect:function(e){var n=e.columnName;return i({columnName:n,tableName:l})}}),(0,b.jsxs)(a.kC,{my:4,alignItems:"center",children:[(0,b.jsx)(w.B,{height:350,children:(0,y.S)(d)}),(0,b.jsx)(w.B,{height:350,children:(0,y.S)(o,d)})]})]})},s)}))})}var _=s(4673),J=s(6646),R=s(8444),W=s.n(R),B=s(5984),I=["assertions"];function V(e){return Object.values(e).map((function(e){var n={name:e[0].name};return e.forEach((function(e){"base"===e.from?n.base=e:n.target=e})),n}))}function G(e){var n=e.assertions,s=(0,h.Z)(e,I),i=n.piperider,r=n.dbt,l=W()(i,(function(e){return"".concat(e.level,"_").concat(e.column,"_").concat(e.name)})),d=W()(r,(function(e){return"".concat(e.level,"_").concat(e.column,"_").concat(e.name)})),o=V(l),c=V(d),u=function(e,n){var s=e.reduce((function(e,n){return M("PipeRider",n,e)}),{passed:[],failed:[]}),i=s.passed,r=s.failed,l=n.reduce((function(e,n){return M("dbt",n,e)}),{passed:[],failed:[]}),a=l.passed,d=l.failed;return{passedAssertionRows:[].concat((0,t.Z)(i),(0,t.Z)(a)),failedAssertionRows:[].concat((0,t.Z)(r),(0,t.Z)(d))}}(o,c),x=u.passedAssertionRows,v=u.failedAssertionRows;return 0===o.length&&0===c.length?(0,b.jsx)(a.kC,{direction:"column",justifyContent:"center",alignItems:"center",children:(0,b.jsx)(a.xv,{textAlign:"center",children:"No tests available"})}):(0,b.jsx)(m.xJ,{children:(0,b.jsxs)(m.iA,{variant:"simple",children:[(0,b.jsx)(m.hr,{children:(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Th,{children:"Assertion"}),(0,b.jsx)(m.Th,{children:"Base Status"}),(0,b.jsx)(m.Th,{children:"Target Status"}),(0,b.jsx)(m.Th,{children:"Source"}),(0,b.jsx)(m.Th,{})]})}),(0,b.jsxs)(m.p3,{children:[v.map((function(e){var n,i;return(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Td,{children:e.name}),(0,b.jsx)(m.Td,{children:(0,b.jsx)(f.s,{status:null===(n=e.base)||void 0===n?void 0:n.status})}),(0,b.jsx)(m.Td,{children:(0,b.jsx)(f.s,{status:null===(i=e.target)||void 0===i?void 0:i.status})}),(0,b.jsx)(m.Td,{children:e.source}),(0,b.jsx)(m.Td,{onClick:function(){s.onDetailVisible({type:"piperider",data:e})},children:(0,b.jsx)(a.xv,{as:"span",cursor:"pointer",children:"\ud83d\udd0d"})})]},(0,B.x0)())})),x.map((function(e){var n,i;return(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Td,{children:e.name}),(0,b.jsx)(m.Td,{children:(0,b.jsx)(f.s,{status:null===(n=e.base)||void 0===n?void 0:n.status})}),(0,b.jsx)(m.Td,{children:(0,b.jsx)(f.s,{status:null===(i=e.target)||void 0===i?void 0:i.status})}),(0,b.jsx)(m.Td,{children:e.source}),(0,b.jsx)(m.Td,{onClick:function(){s.onDetailVisible({type:"piperider",data:e})},children:(0,b.jsx)(a.xv,{as:"span",cursor:"pointer",children:"\ud83d\udd0d"})})]},(0,B.x0)())}))]})]})})}function M(e,n,s){var t,r;n&&("failed"===(null===(t=n.base)||void 0===t?void 0:t.status)||"failed"===(null===(r=n.target)||void 0===r?void 0:r.status)?s.failed.push((0,i.Z)((0,i.Z)({},n),{},{source:e})):s.passed.push((0,i.Z)((0,i.Z)({},n),{},{source:e})));return s}var X=s(4002),$=s(5761),E=s(6499);function F(e){var n=e.data,s=e.tableName,h=(0,o.useState)(null),v=(0,r.Z)(h,2),j=v[0],m=v[1],p=(0,l.qY)(),f=(0,o.useState)(!1),g=(0,r.Z)(f,2),C=g[0],Z=g[1],y=(0,o.useState)(!1),N=(0,r.Z)(y,2),w=N[0],O=N[1],A=(0,d.TH)(),P=(0,r.Z)(A,2)[1];if((0,x.j)(s),!n||!s)return(0,b.jsx)(c.o,{isSingleReport:!0,time:"-",children:(0,b.jsx)(E.J,{text:"No profile data found."})});var D=n.base,z=n.input;(0,k.h5)((0,k.C6)(!0).safeParse(n));var R=D.tables[s],W=z.tables[s];(0,k.h5)(k.vT.safeParse(R)),(0,k.h5)(k.vT.safeParse(W));var B=(0,u.Ix)({data:n,tableName:s,type:"piperider"}),I=(0,r.Z)(B,2),V=I[0],M=I[1],F=(0,u.Ix)({data:n,tableName:s,type:"dbt"}),L=(0,r.Z)(F,2),Y=L[0],q=L[1],Q=[].concat((0,t.Z)((null===V||void 0===V?void 0:V.tests)||[]),(0,t.Z)((null===M||void 0===M?void 0:M.tests)||[])),U=[].concat((0,t.Z)((null===Y||void 0===Y?void 0:Y.tests)||[]),(0,t.Z)((null===q||void 0===q?void 0:q.tests)||[])),K=0===Q.length&&0===U.length;return(0,b.jsxs)(c.o,{isSingleReport:!1,time:"".concat((0,T.D8)(D.created_at)," -> ").concat((0,T.D8)(z.created_at)),children:[(0,b.jsxs)(a.kC,{direction:"column",width:"inherit",children:[(0,b.jsx)(X.Q,{routePathToMatch:$.W}),(0,b.jsxs)(a.kC,{border:"1px solid",borderColor:"gray.300",bg:"white",borderRadius:"md",p:6,mt:3,mx:"5%",direction:"column",children:[(0,b.jsx)(_.m,{baseTable:R,targetTable:W}),(0,b.jsx)(a.X6,{size:"md",children:"Assertions"}),(0,b.jsx)(J.S,{in:C,startingHeight:K?50:250,collapseable:!K,onVisible:function(){return Z((function(e){return!e}))},children:(0,b.jsx)(G,{assertions:{piperider:Q,dbt:U},onDetailVisible:function(e){var n=e.data,s=e.type;m({type:s,data:n}),p.onOpen()}})}),(0,b.jsx)(a.X6,{size:"md",mt:4,children:"Columns"}),(0,b.jsx)(J.S,{in:w,startingHeight:void 0===R&&void 0===W?50:350,collapseable:void 0!==R||void 0!==W,onVisible:function(){return O((function(e){return!e}))},children:(0,b.jsx)(H,{baseTable:R,targetTable:W,onSelect:function(e){var n=e.tableName,s=e.columnName;return P("/tables/".concat(n,"/columns/").concat(s))}})})]})]}),(0,b.jsx)(S,(0,i.Z)((0,i.Z)({},p),{},{type:null===j||void 0===j?void 0:j.type,data:null===j||void 0===j?void 0:j.data,onClose:function(){p.onClose(),m(null)}}))]})}}}]);
//# sourceMappingURL=276.374346f2.chunk.js.map